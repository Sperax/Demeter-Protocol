<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title></title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="book.css">

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item "><a href="index.html">Home</a></li><li class="chapter-item affix "><li class="part-title">contracts</li><li class="chapter-item "><a href="contracts/e20-farms/index.html">❱ e20-farms</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/e20-farms/balancerV2/index.html">❱ balancerV2</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/e20-farms/balancerV2/interfaces/index.html">❱ interfaces</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/e20-farms/balancerV2/interfaces/IBalancerV2Vault.sol/interface.IBalancerV2Vault.html">IBalancerV2Vault</a></li></ol></li><li class="chapter-item "><a href="contracts/e20-farms/balancerV2/BalancerV2Farm.sol/contract.BalancerV2Farm.html">BalancerV2Farm</a></li><li class="chapter-item "><a href="contracts/e20-farms/balancerV2/BalancerV2FarmDeployer.sol/contract.BalancerV2FarmDeployer.html">BalancerV2FarmDeployer</a></li></ol></li><li class="chapter-item "><a href="contracts/e20-farms/uniswapV2/index.html">❱ uniswapV2</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/e20-farms/uniswapV2/interfaces/index.html">❱ interfaces</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/e20-farms/uniswapV2/interfaces/IUniswapV2Factory.sol/interface.IUniswapV2Factory.html">IUniswapV2Factory</a></li></ol></li><li class="chapter-item "><a href="contracts/e20-farms/uniswapV2/UniV2Farm.sol/contract.UniV2Farm.html">UniV2Farm</a></li><li class="chapter-item "><a href="contracts/e20-farms/uniswapV2/UniV2FarmDeployer.sol/contract.UniV2FarmDeployer.html">UniV2FarmDeployer</a></li></ol></li><li class="chapter-item "><a href="contracts/e20-farms/E20Farm.sol/abstract.E20Farm.html">E20Farm</a></li></ol></li><li class="chapter-item "><a href="contracts/e721-farms/index.html">❱ e721-farms</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/e721-farms/camelotV2/index.html">❱ camelotV2</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/e721-farms/camelotV2/interfaces/index.html">❱ interfaces</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/e721-farms/camelotV2/interfaces/ICamelotV2.sol/interface.INFTPoolFactory.html">INFTPoolFactory</a></li><li class="chapter-item "><a href="contracts/e721-farms/camelotV2/interfaces/ICamelotV2.sol/interface.IPair.html">IPair</a></li><li class="chapter-item "><a href="contracts/e721-farms/camelotV2/interfaces/ICamelotV2.sol/interface.INFTPool.html">INFTPool</a></li><li class="chapter-item "><a href="contracts/e721-farms/camelotV2/interfaces/ICamelotV2.sol/interface.ICamelotV2Factory.html">ICamelotV2Factory</a></li><li class="chapter-item "><a href="contracts/e721-farms/camelotV2/interfaces/ICamelotV2.sol/interface.INFTHandler.html">INFTHandler</a></li><li class="chapter-item "><a href="contracts/e721-farms/camelotV2/interfaces/ICamelotV2.sol/interface.IPositionHelper.html">IPositionHelper</a></li><li class="chapter-item "><a href="contracts/e721-farms/camelotV2/interfaces/ICamelotV2.sol/interface.IRouter.html">IRouter</a></li></ol></li><li class="chapter-item "><a href="contracts/e721-farms/camelotV2/CamelotV2Farm.sol/contract.CamelotV2Farm.html">CamelotV2Farm</a></li><li class="chapter-item "><a href="contracts/e721-farms/camelotV2/CamelotV2FarmDeployer.sol/contract.CamelotV2FarmDeployer.html">CamelotV2FarmDeployer</a></li></ol></li><li class="chapter-item "><a href="contracts/e721-farms/camelotV3/index.html">❱ camelotV3</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/e721-farms/camelotV3/interfaces/index.html">❱ interfaces</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/e721-farms/camelotV3/interfaces/ICamelotV3.sol/interface.INFPM.html">INFPM</a></li><li class="chapter-item "><a href="contracts/e721-farms/camelotV3/interfaces/ICamelotV3.sol/interface.ICamelotV3Factory.html">ICamelotV3Factory</a></li><li class="chapter-item "><a href="contracts/e721-farms/camelotV3/interfaces/ICamelotV3.sol/interface.ICamelotV3TickSpacing.html">ICamelotV3TickSpacing</a></li><li class="chapter-item "><a href="contracts/e721-farms/camelotV3/interfaces/ICamelotV3.sol/interface.ICamelotV3PoolState.html">ICamelotV3PoolState</a></li><li class="chapter-item "><a href="contracts/e721-farms/camelotV3/interfaces/ICamelotV3NonfungiblePositionManagerUtils.sol/struct.Position.html">Position</a></li><li class="chapter-item "><a href="contracts/e721-farms/camelotV3/interfaces/ICamelotV3NonfungiblePositionManagerUtils.sol/interface.ICamelotV3NFPMUtils.html">ICamelotV3NFPMUtils</a></li><li class="chapter-item "><a href="contracts/e721-farms/camelotV3/interfaces/ICamelotV3Utils.sol/interface.ICamelotV3Utils.html">ICamelotV3Utils</a></li></ol></li><li class="chapter-item "><a href="contracts/e721-farms/camelotV3/CamelotV3Farm.sol/struct.CamelotPoolData.html">CamelotPoolData</a></li><li class="chapter-item "><a href="contracts/e721-farms/camelotV3/CamelotV3Farm.sol/struct.InitializeInput.html">InitializeInput</a></li><li class="chapter-item "><a href="contracts/e721-farms/camelotV3/CamelotV3Farm.sol/contract.CamelotV3Farm.html">CamelotV3Farm</a></li><li class="chapter-item "><a href="contracts/e721-farms/camelotV3/CamelotV3FarmDeployer.sol/contract.CamelotV3FarmDeployer.html">CamelotV3FarmDeployer</a></li></ol></li><li class="chapter-item "><a href="contracts/e721-farms/uniswapV3/index.html">❱ uniswapV3</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/e721-farms/uniswapV3/interfaces/index.html">❱ interfaces</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/e721-farms/uniswapV3/interfaces/INonfungiblePositionManagerUtils.sol/struct.Position.html">Position</a></li><li class="chapter-item "><a href="contracts/e721-farms/uniswapV3/interfaces/INonfungiblePositionManagerUtils.sol/interface.INFPMUtils.html">INFPMUtils</a></li><li class="chapter-item "><a href="contracts/e721-farms/uniswapV3/interfaces/IUniswapV3.sol/interface.IPoolInitializer.html">IPoolInitializer</a></li><li class="chapter-item "><a href="contracts/e721-farms/uniswapV3/interfaces/IUniswapV3.sol/interface.INFPM.html">INFPM</a></li><li class="chapter-item "><a href="contracts/e721-farms/uniswapV3/interfaces/IUniswapV3.sol/interface.IUniswapV3Factory.html">IUniswapV3Factory</a></li><li class="chapter-item "><a href="contracts/e721-farms/uniswapV3/interfaces/IUniswapV3.sol/interface.IUniswapV3TickSpacing.html">IUniswapV3TickSpacing</a></li><li class="chapter-item "><a href="contracts/e721-farms/uniswapV3/interfaces/IUniswapV3.sol/interface.IUniswapV3PoolDerivedState.html">IUniswapV3PoolDerivedState</a></li><li class="chapter-item "><a href="contracts/e721-farms/uniswapV3/interfaces/IUniswapV3.sol/interface.IUniswapV3PoolState.html">IUniswapV3PoolState</a></li><li class="chapter-item "><a href="contracts/e721-farms/uniswapV3/interfaces/IUniswapV3Utils.sol/interface.IUniswapV3Utils.html">IUniswapV3Utils</a></li></ol></li><li class="chapter-item "><a href="contracts/e721-farms/uniswapV3/tests/index.html">❱ tests</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/e721-farms/uniswapV3/tests/ISwapRouter.sol/interface.ISwapRouter.html">ISwapRouter</a></li><li class="chapter-item "><a href="contracts/e721-farms/uniswapV3/tests/UniswapV3Test.sol/contract.UniswapV3Test.html">UniswapV3Test</a></li></ol></li><li class="chapter-item "><a href="contracts/e721-farms/uniswapV3/UniV3ActiveLiquidityDeployer.sol/contract.UniV3ActiveLiquidityDeployer.html">UniV3ActiveLiquidityDeployer</a></li><li class="chapter-item "><a href="contracts/e721-farms/uniswapV3/UniV3ActiveLiquidityFarm.sol/contract.UniV3ActiveLiquidityFarm.html">UniV3ActiveLiquidityFarm</a></li><li class="chapter-item "><a href="contracts/e721-farms/uniswapV3/UniV3Farm.sol/struct.UniswapPoolData.html">UniswapPoolData</a></li><li class="chapter-item "><a href="contracts/e721-farms/uniswapV3/UniV3Farm.sol/struct.InitializeInput.html">InitializeInput</a></li><li class="chapter-item "><a href="contracts/e721-farms/uniswapV3/UniV3Farm.sol/contract.UniV3Farm.html">UniV3Farm</a></li><li class="chapter-item "><a href="contracts/e721-farms/uniswapV3/UniV3FarmDeployer.sol/contract.UniV3FarmDeployer.html">UniV3FarmDeployer</a></li></ol></li><li class="chapter-item "><a href="contracts/e721-farms/E721Farm.sol/abstract.E721Farm.html">E721Farm</a></li></ol></li><li class="chapter-item "><a href="contracts/features/index.html">❱ features</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/features/ClaimableFee.sol/abstract.ClaimableFee.html">ClaimableFee</a></li><li class="chapter-item "><a href="contracts/features/ExpirableFarm.sol/abstract.ExpirableFarm.html">ExpirableFarm</a></li><li class="chapter-item "><a href="contracts/features/OperableDeposit.sol/abstract.OperableDeposit.html">OperableDeposit</a></li></ol></li><li class="chapter-item "><a href="contracts/interfaces/index.html">❱ interfaces</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/interfaces/DataTypes.sol/struct.RewardTokenData.html">RewardTokenData</a></li><li class="chapter-item "><a href="contracts/interfaces/DataTypes.sol/struct.RewardFund.html">RewardFund</a></li><li class="chapter-item "><a href="contracts/interfaces/DataTypes.sol/struct.Subscription.html">Subscription</a></li><li class="chapter-item "><a href="contracts/interfaces/DataTypes.sol/struct.Deposit.html">Deposit</a></li><li class="chapter-item "><a href="contracts/interfaces/DataTypes.sol/struct.RewardData.html">RewardData</a></li><li class="chapter-item "><a href="contracts/interfaces/IFarm.sol/interface.IFarm.html">IFarm</a></li><li class="chapter-item "><a href="contracts/interfaces/IFarmRegistry.sol/interface.IFarmRegistry.html">IFarmRegistry</a></li><li class="chapter-item "><a href="contracts/interfaces/IOracle.sol/interface.IOracle.html">IOracle</a></li><li class="chapter-item "><a href="contracts/interfaces/IRewarder.sol/interface.IRewarder.html">IRewarder</a></li><li class="chapter-item "><a href="contracts/interfaces/IRewarderFactory.sol/interface.IRewarderFactory.html">IRewarderFactory</a></li></ol></li><li class="chapter-item "><a href="contracts/rewarder/index.html">❱ rewarder</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/rewarder/Rewarder.sol/contract.Rewarder.html">Rewarder</a></li><li class="chapter-item "><a href="contracts/rewarder/RewarderFactory.sol/contract.RewarderFactory.html">RewarderFactory</a></li></ol></li><li class="chapter-item "><a href="contracts/utils/index.html">❱ utils</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/utils/TokenUtils.sol/library.TokenUtils.html">TokenUtils</a></li></ol></li><li class="chapter-item "><a href="contracts/Farm.sol/abstract.Farm.html">Farm</a></li><li class="chapter-item "><a href="contracts/FarmDeployer.sol/abstract.FarmDeployer.html">FarmDeployer</a></li><li class="chapter-item "><a href="contracts/FarmRegistry.sol/contract.FarmRegistry.html">FarmRegistry</a></li><li class="chapter-item "><a href="contracts/FarmStorage.sol/abstract.FarmStorage.html">FarmStorage</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/Sperax/Demeter-Protocol" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="demeter-protocol"><a class="header" href="#demeter-protocol"><a href="https://demeter.sperax.io/">Demeter-Protocol</a></a></h1>
<p><img src="https://sperax.io/assets/working.88f515ef.png" alt="plot" /></p>
<p>Works on Arbitrum Uniswap V3 and Camelot V2 <br />
Demeter protocol is a protocol for DAOs to launch and manage decentralized exchange liquidity - without needing to know how to code. Demeter gives users the power to launch incentivized liquidity pools on Uniswap V3 and Camelot V2. Future versions will support custom liquidity shapes on major DEXs such as Balancer, Saddle, Sushiswap or anything veSPA holders prefer. Demeter is launched on Arbitrum and will be expanded to Optimism, Polygon and Ethereum soon. Additional blockchains will be added in future versions.</p>
<h2 id="contributing"><a class="header" href="#contributing">Contributing</a></h2>
<p>Demeter is now open source and we are looking forward for your contributions!</p>
<p>If you’re interested in contributing please see our <a href="./CONTRIBUTING.html">contribution guidelines</a>.</p>
<h2 id="about-demeter"><a class="header" href="#about-demeter">About Demeter</a></h2>
<p>Demeter automates the fundamental aspects of launching and managing decentralized exchange liquidity for the DAOs native token:</p>
<ul>
<li><strong>Engineering support to launch and manage the farm</strong> - The Audited Demeter Farm Factory contract will generate the pool and farm contracts for the Demeter user.</li>
<li><strong>Marketing support to make the community aware of the new farm</strong> - Protocols that launch their farm through Demeter benefit from being whitelisted on the Demeter active farms dashboard. This exclusive list features all of the farms that are actively distributing rewards that were deployed with Demeter. Farmers will regularly look to this dashboard for new projects and become users of these protocols.</li>
</ul>
<h3 id="launching-demeter-farm"><a class="header" href="#launching-demeter-farm">Launching Demeter Farm</a></h3>
<ol>
<li>Approve fee token to spend</li>
<li>Input pool parameters and farm parameters and execute a transaction to create farm and pay the farm creation fee
<ol>
<li>If pool does not exist then the transaction reverts.</li>
<li>If the user does not have enough fee tokens for fee payment then the transaction reverts. The fee is 100 USDs on Arbitrum.</li>
</ol>
</li>
<li>After creation of the farm contract, reward token managers can update reward related parameters.</li>
<li>After creation of the farm contract, the farm admin can manage some attributes of the farm like start date, cooldown period, close/pause farm etc.</li>
</ol>
<h3 id="farm-parameters"><a class="header" href="#farm-parameters">Farm Parameters</a></h3>
<ol>
<li>Farm admin: It is the address that will have admin control on the farm. It can be the same as the deployer’s address or any other desired address which will be used to manage the farm.</li>
<li>Price range for the LP</li>
<li>Reward tokens
<ul>
<li>Token addresses</li>
<li>Token address managers; Each token will have its own token manager</li>
<li>Reward tokens have to be added at the time of farm creation and cant be added after the farm is created. Maximum 4 reward tokens are possible for a farm. SPA is added as a default reward token for       farms on Arbitrum and Ethereum networks. So for these networks, 3 additional reward tokens can be added by the farm creator.</li>
</ul>
</li>
<li>Cooldown Period for Locked Liquidity - It is the number of days users have to wait after initiating cooldown before they can unstake from a locked position. Only whole numbers are allowed for this       parameter.
<ul>
<li>If Cooldown Period = 0, then the farm only allows creation of unlocked positions. Unlocked positions can be unstaked anytime.</li>
<li>If Cooldown Period &gt; =1, the farm will allow creation of both locked and unlocked positions. For unstaking a locked position, users have to initiate cooldown and wait for cooldown period before
unstaking. Farm</li>
</ul>
</li>
<li>Start date time stamp - Reward emission starts from this date. This date can be changed by the farm admin using admin functions. However date change is not allowed after the farm starts.
The farms start accepting liquidity immediately after the creation of the farm contract. However, the reward accrual starts from the farm start date time stamp.</li>
</ol>
<h3 id="fee"><a class="header" href="#fee">Fee</a></h3>
<p>Demeter will charge a flat $100 fee to launch the farm. The fee collected belongs to the SPA stakers and can be transferred directly to the wallet address where all Sperax protocol fees are collected. Fees have to be paid in USDs on Arbitrum in the beginning, more payment methods can be added in future. Fee amount and fee token can be changed in future through governance.</p>
<h3 id="farm-management"><a class="header" href="#farm-management">Farm Management</a></h3>
<p>No one can make changes to the farm contract once deployed. Farm admins can do the following:</p>
<ol>
<li>Transfer farm ownership to another address</li>
<li>Change start date of the farm - Farm will emit rewards from this date. The date can be changed after farm creation. However date change is not allowed after the farm starts.</li>
<li>Update cooldown period of the locked positions</li>
<li>Pause or Unpause the farm
<ul>
<li><strong>Pause the farm</strong> - All reward distributions are paused, LPs do not earn any rewards during this period. Withdrawals are allowed (including lockup LPs) and users can also claim previously accrued rewards. Admin/managers can make changes to the distribution rates and the other parameters when the farm is paused.</li>
<li><strong>Unpause the farm</strong> - Resume the reward distribution. The reward distribution rate remains the same as set by the reward managers.</li>
</ul>
</li>
<li>Close the farm - Once the farm is closed, all liquidity providers including lockup users can now unstake their liquidity pool tokens and claim the accrued rewards from the farm</li>
</ol>
<h3 id="reward-management"><a class="header" href="#reward-management">Reward Management</a></h3>
<p>Each reward token will be assigned a reward token manager. Farm admin cannot update the reward token manager once the farms are deployed. Reward token managers can do the following:</p>
<ol>
<li>Add reward token balance</li>
<li>Update reward distribution rate per second for each token. Only future distribution rates can be affected through this. Reward distribution can be paused by setting the rate to 0. These actions can be done: For all liquidity providers For lockup liquidity providers (If cooldown period is greater than 0)</li>
<li>Withdraw reward tokens (Any rewards already accrued to LPs cannot be removed)</li>
<li>Transfer reward token management to another address</li>
</ol>
<h3 id="notes"><a class="header" href="#notes">Notes</a></h3>
<ul>
<li>Protocols can call functions through non-EOA addresses and manage the farm. This is for multi-sigs or DAO’s to manage the pool and farm.</li>
<li>SPA is added as a default reward token and protocols do not have the power to add or update the token reward manager for the SPA token. And the <a href="https://app-v2.sperax.io/gauge">Sperax-Gauge</a> acts as the default token manager for SPA.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents"><a class="header" href="#contents">Contents</a></h1>
<ul>
<li><a href="contracts/e20-farms//contracts/e20-farms/balancerV2">balancerV2</a></li>
<li><a href="contracts/e20-farms//contracts/e20-farms/uniswapV2">uniswapV2</a></li>
<li><a href="contracts/e20-farms/E20Farm.sol/abstract.E20Farm.html">E20Farm</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-1"><a class="header" href="#contents-1">Contents</a></h1>
<ul>
<li><a href="contracts/e20-farms/balancerV2//contracts/e20-farms/balancerV2/interfaces">interfaces</a></li>
<li><a href="contracts/e20-farms/balancerV2/BalancerV2Farm.sol/contract.BalancerV2Farm.html">BalancerV2Farm</a></li>
<li><a href="contracts/e20-farms/balancerV2/BalancerV2FarmDeployer.sol/contract.BalancerV2FarmDeployer.html">BalancerV2FarmDeployer</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-2"><a class="header" href="#contents-2">Contents</a></h1>
<ul>
<li><a href="contracts/e20-farms/balancerV2/interfaces/IBalancerV2Vault.sol/interface.IBalancerV2Vault.html">IBalancerV2Vault</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ibalancerv2vault"><a class="header" href="#ibalancerv2vault">IBalancerV2Vault</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e20-farms/balancerV2/interfaces/IBalancerV2Vault.sol">Git Source</a></p>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<h3 id="getpool"><a class="header" href="#getpool">getPool</a></h3>
<pre><code class="language-solidity">function getPool(bytes32 poolId) external view returns (address, PoolSpecialization);
</code></pre>
<h3 id="getpooltokens"><a class="header" href="#getpooltokens">getPoolTokens</a></h3>
<pre><code class="language-solidity">function getPoolTokens(bytes32 poolId)
    external
    view
    returns (IERC20[] memory tokens, uint256[] memory balances, uint256 lastChangeBlock);
</code></pre>
<h2 id="enums"><a class="header" href="#enums">Enums</a></h2>
<h3 id="poolspecialization"><a class="header" href="#poolspecialization">PoolSpecialization</a></h3>
<pre><code class="language-solidity">enum PoolSpecialization {
    GENERAL,
    MINIMAL_SWAP_INFO,
    TWO_TOKEN
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="balancerv2farm"><a class="header" href="#balancerv2farm">BalancerV2Farm</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e20-farms/balancerV2/BalancerV2Farm.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/e20-farms/balancerV2/BalancerV2Farm.sol//contracts/e20-farms/E20Farm.sol/abstract.E20Farm.html">E20Farm</a>, <a href="contracts/e20-farms/balancerV2/BalancerV2Farm.sol//contracts/features/ExpirableFarm.sol/abstract.ExpirableFarm.html">ExpirableFarm</a></p>
<p><strong>Author:</strong>
Sperax Foundation.</p>
<p>This contract is the implementation of the Balancer V2 farm.</p>
<h2 id="functions-1"><a class="header" href="#functions-1">Functions</a></h2>
<h3 id="initialize"><a class="header" href="#initialize">initialize</a></h3>
<p>Constructor.</p>
<p><em>_cooldownPeriod = 0 Disables lockup functionality for the farm.</em></p>
<pre><code class="language-solidity">function initialize(
    string calldata _farmId,
    uint256 _farmStartTime,
    uint256 _cooldownPeriod,
    address _farmRegistry,
    address _farmToken,
    RewardTokenData[] memory _rwdTokenData
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farmId</code></td><td><code>string</code></td><td>- ID of the farm.</td></tr>
<tr><td><code>_farmStartTime</code></td><td><code>uint256</code></td><td>- Farm start time.</td></tr>
<tr><td><code>_cooldownPeriod</code></td><td><code>uint256</code></td><td>- Cooldown period for locked deposits in days.</td></tr>
<tr><td><code>_farmRegistry</code></td><td><code>address</code></td><td>- Address of the Demeter Farm Registry.</td></tr>
<tr><td><code>_farmToken</code></td><td><code>address</code></td><td>Address of the farm token.</td></tr>
<tr><td><code>_rwdTokenData</code></td><td><code>RewardTokenData[]</code></td><td>- Initialize data for reward tokens.</td></tr>
</tbody></table>
</div>
<h3 id="gettokenamounts"><a class="header" href="#gettokenamounts">getTokenAmounts</a></h3>
<p>Function to be called by Demeter Rewarder to get tokens and amounts associated with the farm's liquidity.</p>
<p><em>This function is not implemented in this contract.</em></p>
<pre><code class="language-solidity">function getTokenAmounts() external view virtual override returns (address[] memory, uint256[] memory);
</code></pre>
<h3 id="updatefarmstarttime"><a class="header" href="#updatefarmstarttime">updateFarmStartTime</a></h3>
<p>Update the farm start time.</p>
<p><em>Can be updated only before the farm start.
New start time should be in future.
Adjusts the farm end time accordingly.</em></p>
<pre><code class="language-solidity">function updateFarmStartTime(uint256 _newStartTime) public override(ExpirableFarm, Farm);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_newStartTime</code></td><td><code>uint256</code></td><td>The new farm start time.</td></tr>
</tbody></table>
</div>
<h3 id="isfarmopen"><a class="header" href="#isfarmopen">isFarmOpen</a></h3>
<p>Returns bool status if farm is open.
Farm is open if it is not closed and not expired.</p>
<pre><code class="language-solidity">function isFarmOpen() public view override(ExpirableFarm, Farm) returns (bool);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>bool True if farm is open.</td></tr>
</tbody></table>
</div>
<h3 id="_recovererc20"><a class="header" href="#_recovererc20">_recoverERC20</a></h3>
<p>Recover erc20 tokens other than the reward Tokens and farm token.</p>
<pre><code class="language-solidity">function _recoverERC20(address _token) internal override(E20Farm, Farm);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_token</code></td><td><code>address</code></td><td>Address of token to be recovered.</td></tr>
</tbody></table>
</div>
<h2 id="errors"><a class="header" href="#errors">Errors</a></h2>
<h3 id="notimplemented"><a class="header" href="#notimplemented">NotImplemented</a></h3>
<pre><code class="language-solidity">error NotImplemented();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="balancerv2farmdeployer"><a class="header" href="#balancerv2farmdeployer">BalancerV2FarmDeployer</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e20-farms/balancerV2/BalancerV2FarmDeployer.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/e20-farms/balancerV2/BalancerV2FarmDeployer.sol//contracts/FarmDeployer.sol/abstract.FarmDeployer.html">FarmDeployer</a></p>
<p><strong>Author:</strong>
Sperax Foundation.</p>
<p>This contract allows anyone to calculate fees, pay fees and create farms.</p>
<p><em>It consults Balancer V2 Vault to validate the pool.</em></p>
<h2 id="state-variables"><a class="header" href="#state-variables">State Variables</a></h2>
<h3 id="balancer_vault"><a class="header" href="#balancer_vault">BALANCER_VAULT</a></h3>
<pre><code class="language-solidity">address public immutable BALANCER_VAULT;
</code></pre>
<h2 id="functions-2"><a class="header" href="#functions-2">Functions</a></h2>
<h3 id="constructor"><a class="header" href="#constructor">constructor</a></h3>
<p>Constructor.</p>
<p><em>Deploys one farm so that it can be cloned later.</em></p>
<pre><code class="language-solidity">constructor(address _farmRegistry, string memory _farmId, address _balancerVault)
    FarmDeployer(_farmRegistry, _farmId);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farmRegistry</code></td><td><code>address</code></td><td>Address of the Demeter Farm Registry.</td></tr>
<tr><td><code>_farmId</code></td><td><code>string</code></td><td>Id of the farm.</td></tr>
<tr><td><code>_balancerVault</code></td><td><code>address</code></td><td>Address of Balancer's Vault.</td></tr>
</tbody></table>
</div>
<h3 id="createfarm"><a class="header" href="#createfarm">createFarm</a></h3>
<p>Deploys a new Balancer farm.</p>
<p><em>The caller of this function should approve feeAmount to this contract before calling this function.</em></p>
<pre><code class="language-solidity">function createFarm(FarmData memory _data) external nonReentrant returns (address);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_data</code></td><td><code>FarmData</code></td><td>Data for deployment.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td>Address of the deployed farm.</td></tr>
</tbody></table>
</div>
<h3 id="validatepool"><a class="header" href="#validatepool">validatePool</a></h3>
<p>Function to validate Balancer pool.</p>
<pre><code class="language-solidity">function validatePool(bytes32 _poolId) public view returns (address pool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_poolId</code></td><td><code>bytes32</code></td><td>bytes32 Id of the pool.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>pool</code></td><td><code>address</code></td><td>Pool address.</td></tr>
</tbody></table>
</div>
<h2 id="structs"><a class="header" href="#structs">Structs</a></h2>
<h3 id="farmdata"><a class="header" href="#farmdata">FarmData</a></h3>
<pre><code class="language-solidity">struct FarmData {
    address farmAdmin;
    uint256 farmStartTime;
    uint256 cooldownPeriod;
    bytes32 poolId;
    RewardTokenData[] rewardData;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-3"><a class="header" href="#contents-3">Contents</a></h1>
<ul>
<li><a href="contracts/e20-farms/uniswapV2//contracts/e20-farms/uniswapV2/interfaces">interfaces</a></li>
<li><a href="contracts/e20-farms/uniswapV2/UniV2Farm.sol/contract.UniV2Farm.html">UniV2Farm</a></li>
<li><a href="contracts/e20-farms/uniswapV2/UniV2FarmDeployer.sol/contract.UniV2FarmDeployer.html">UniV2FarmDeployer</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-4"><a class="header" href="#contents-4">Contents</a></h1>
<ul>
<li><a href="contracts/e20-farms/uniswapV2/interfaces/IUniswapV2Factory.sol/interface.IUniswapV2Factory.html">IUniswapV2Factory</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iuniswapv2factory"><a class="header" href="#iuniswapv2factory">IUniswapV2Factory</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e20-farms/uniswapV2/interfaces/IUniswapV2Factory.sol">Git Source</a></p>
<h2 id="functions-3"><a class="header" href="#functions-3">Functions</a></h2>
<h3 id="getpair"><a class="header" href="#getpair">getPair</a></h3>
<pre><code class="language-solidity">function getPair(address _tokenA, address _tokenB) external view returns (address);
</code></pre>
<h3 id="allpairs"><a class="header" href="#allpairs">allPairs</a></h3>
<pre><code class="language-solidity">function allPairs(uint256 _id) external view returns (address);
</code></pre>
<h3 id="allpairslength"><a class="header" href="#allpairslength">allPairsLength</a></h3>
<pre><code class="language-solidity">function allPairsLength() external view returns (uint256);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="univ2farm"><a class="header" href="#univ2farm">UniV2Farm</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e20-farms/uniswapV2/UniV2Farm.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/e20-farms/uniswapV2/UniV2Farm.sol//contracts/e20-farms/E20Farm.sol/abstract.E20Farm.html">E20Farm</a>, <a href="contracts/e20-farms/uniswapV2/UniV2Farm.sol//contracts/features/ExpirableFarm.sol/abstract.ExpirableFarm.html">ExpirableFarm</a></p>
<p><strong>Author:</strong>
Sperax Foundation.</p>
<p>This contract is the implementation of the Uniswap V2 farm.</p>
<h2 id="functions-4"><a class="header" href="#functions-4">Functions</a></h2>
<h3 id="initialize-1"><a class="header" href="#initialize-1">initialize</a></h3>
<p>Constructor.</p>
<p><em>_cooldownPeriod = 0 Disables lockup functionality for the farm.</em></p>
<pre><code class="language-solidity">function initialize(
    string calldata _farmId,
    uint256 _farmStartTime,
    uint256 _cooldownPeriod,
    address _farmRegistry,
    address _farmToken,
    RewardTokenData[] memory _rwdTokenData
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farmId</code></td><td><code>string</code></td><td>- ID of the farm.</td></tr>
<tr><td><code>_farmStartTime</code></td><td><code>uint256</code></td><td>- Farm start time.</td></tr>
<tr><td><code>_cooldownPeriod</code></td><td><code>uint256</code></td><td>- Cooldown period for locked deposits in days.</td></tr>
<tr><td><code>_farmRegistry</code></td><td><code>address</code></td><td>- Address of the Demeter Farm Registry.</td></tr>
<tr><td><code>_farmToken</code></td><td><code>address</code></td><td>Address of the farm token.</td></tr>
<tr><td><code>_rwdTokenData</code></td><td><code>RewardTokenData[]</code></td><td>- Initialize data for reward tokens.</td></tr>
</tbody></table>
</div>
<h3 id="gettokenamounts-1"><a class="header" href="#gettokenamounts-1">getTokenAmounts</a></h3>
<p>Function to be called by Demeter Rewarder to get tokens and amounts associated with the farm's liquidity.</p>
<pre><code class="language-solidity">function getTokenAmounts() external view override returns (address[] memory tokens, uint256[] memory amounts);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>tokens</code></td><td><code>address[]</code></td><td>An array of token addresses.</td></tr>
<tr><td><code>amounts</code></td><td><code>uint256[]</code></td><td>An array of token amounts.</td></tr>
</tbody></table>
</div>
<h3 id="updatefarmstarttime-1"><a class="header" href="#updatefarmstarttime-1">updateFarmStartTime</a></h3>
<p>Update the farm start time.</p>
<p><em>Can be updated only before the farm start.
New start time should be in future.
Adjusts the farm end time accordingly.</em></p>
<pre><code class="language-solidity">function updateFarmStartTime(uint256 _newStartTime) public override(ExpirableFarm, Farm);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_newStartTime</code></td><td><code>uint256</code></td><td>The new farm start time.</td></tr>
</tbody></table>
</div>
<h3 id="isfarmopen-1"><a class="header" href="#isfarmopen-1">isFarmOpen</a></h3>
<p>Returns bool status if farm is open.
Farm is open if it is not closed and not expired.</p>
<pre><code class="language-solidity">function isFarmOpen() public view override(ExpirableFarm, Farm) returns (bool);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>bool True if farm is open.</td></tr>
</tbody></table>
</div>
<h3 id="_recovererc20-1"><a class="header" href="#_recovererc20-1">_recoverERC20</a></h3>
<p>Recover erc20 tokens other than the reward Tokens and farm token.</p>
<pre><code class="language-solidity">function _recoverERC20(address _token) internal override(E20Farm, Farm);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_token</code></td><td><code>address</code></td><td>Address of token to be recovered.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="univ2farmdeployer"><a class="header" href="#univ2farmdeployer">UniV2FarmDeployer</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e20-farms/uniswapV2/UniV2FarmDeployer.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/e20-farms/uniswapV2/UniV2FarmDeployer.sol//contracts/FarmDeployer.sol/abstract.FarmDeployer.html">FarmDeployer</a></p>
<p><strong>Author:</strong>
Sperax Foundation.</p>
<p>This contract allows anyone to calculate fees, pay fees and create farms.</p>
<p><em>It consults Uniswap V2 Factory to validate the pool.</em></p>
<h2 id="state-variables-1"><a class="header" href="#state-variables-1">State Variables</a></h2>
<h3 id="protocol_factory"><a class="header" href="#protocol_factory">PROTOCOL_FACTORY</a></h3>
<pre><code class="language-solidity">address public immutable PROTOCOL_FACTORY;
</code></pre>
<h2 id="functions-5"><a class="header" href="#functions-5">Functions</a></h2>
<h3 id="constructor-1"><a class="header" href="#constructor-1">constructor</a></h3>
<p>Constructor of the contract.</p>
<pre><code class="language-solidity">constructor(address _farmRegistry, string memory _farmId, address _protocolFactory)
    FarmDeployer(_farmRegistry, _farmId);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farmRegistry</code></td><td><code>address</code></td><td>Address of the Demeter Farm Registry.</td></tr>
<tr><td><code>_farmId</code></td><td><code>string</code></td><td>Id of the farm.</td></tr>
<tr><td><code>_protocolFactory</code></td><td><code>address</code></td><td>Address of UniswapV2 factory.</td></tr>
</tbody></table>
</div>
<h3 id="createfarm-1"><a class="header" href="#createfarm-1">createFarm</a></h3>
<p>Deploys a new UniswapV3 farm.</p>
<p><em>The caller of this function should approve feeAmount to this contract before calling this function.</em></p>
<pre><code class="language-solidity">function createFarm(FarmData memory _data) external nonReentrant returns (address);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_data</code></td><td><code>FarmData</code></td><td>data for deployment.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td>address of the deployed farm.</td></tr>
</tbody></table>
</div>
<h3 id="validatepool-1"><a class="header" href="#validatepool-1">validatePool</a></h3>
<p>Validates the pool.</p>
<pre><code class="language-solidity">function validatePool(address _tokenA, address _tokenB) public view returns (address pool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_tokenA</code></td><td><code>address</code></td><td>Address of token A.</td></tr>
<tr><td><code>_tokenB</code></td><td><code>address</code></td><td>Address of token B.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>pool</code></td><td><code>address</code></td><td>Pool address.</td></tr>
</tbody></table>
</div>
<h2 id="structs-1"><a class="header" href="#structs-1">Structs</a></h2>
<h3 id="pooldata"><a class="header" href="#pooldata">PoolData</a></h3>
<pre><code class="language-solidity">struct PoolData {
    address tokenA;
    address tokenB;
}
</code></pre>
<h3 id="farmdata-1"><a class="header" href="#farmdata-1">FarmData</a></h3>
<pre><code class="language-solidity">struct FarmData {
    address farmAdmin;
    uint256 farmStartTime;
    uint256 cooldownPeriod;
    PoolData camelotPoolData;
    RewardTokenData[] rewardData;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="e20farm"><a class="header" href="#e20farm">E20Farm</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e20-farms/E20Farm.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/e20-farms/E20Farm.sol//contracts/features/OperableDeposit.sol/abstract.OperableDeposit.html">OperableDeposit</a></p>
<p><strong>Author:</strong>
Sperax Foundation.</p>
<p>This contract contains the core logic for E20 farms.</p>
<h2 id="state-variables-2"><a class="header" href="#state-variables-2">State Variables</a></h2>
<h3 id="farmtoken"><a class="header" href="#farmtoken">farmToken</a></h3>
<pre><code class="language-solidity">address public farmToken;
</code></pre>
<h2 id="functions-6"><a class="header" href="#functions-6">Functions</a></h2>
<h3 id="deposit"><a class="header" href="#deposit">deposit</a></h3>
<p>Function to deposit farm tokens into the farm.</p>
<pre><code class="language-solidity">function deposit(uint256 _amount, bool _lockup) external nonReentrant;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>Amount of farmToken to be deposited.</td></tr>
<tr><td><code>_lockup</code></td><td><code>bool</code></td><td>The lockup flag (bool).</td></tr>
</tbody></table>
</div>
<h3 id="increasedeposit"><a class="header" href="#increasedeposit">increaseDeposit</a></h3>
<p>Allow user to increase liquidity for a deposit.</p>
<p><em>User cannot increase liquidity for a deposit in cooldown.</em></p>
<pre><code class="language-solidity">function increaseDeposit(uint256 _depositId, uint256 _amount) external nonReentrant;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>Deposit index for the user.</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>Desired amount.</td></tr>
</tbody></table>
</div>
<h3 id="decreasedeposit"><a class="header" href="#decreasedeposit">decreaseDeposit</a></h3>
<p>Withdraw liquidity partially from an existing deposit.</p>
<p><em>Function is not available for locked deposits.</em></p>
<pre><code class="language-solidity">function decreaseDeposit(uint256 _depositId, uint256 _amount) external nonReentrant;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>Deposit index for the user.</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>Amount to be withdrawn.</td></tr>
</tbody></table>
</div>
<h3 id="withdraw"><a class="header" href="#withdraw">withdraw</a></h3>
<p>Function to withdraw a deposit from the farm.</p>
<pre><code class="language-solidity">function withdraw(uint256 _depositId) external override nonReentrant;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>The id of the deposit to be withdrawn.</td></tr>
</tbody></table>
</div>
<h3 id="_initialize"><a class="header" href="#_initialize">_initialize</a></h3>
<p>Constructor.</p>
<p><em>_cooldownPeriod = 0 Disables lockup functionality for the farm.</em></p>
<pre><code class="language-solidity">function _initialize(
    string calldata _farmId,
    uint256 _farmStartTime,
    uint256 _cooldownPeriod,
    address _farmToken,
    RewardTokenData[] memory _rwdTokenData
) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farmId</code></td><td><code>string</code></td><td></td></tr>
<tr><td><code>_farmStartTime</code></td><td><code>uint256</code></td><td>- Farm start time.</td></tr>
<tr><td><code>_cooldownPeriod</code></td><td><code>uint256</code></td><td>- Cooldown period for locked deposits in days.</td></tr>
<tr><td><code>_farmToken</code></td><td><code>address</code></td><td>Address of the farm token.</td></tr>
<tr><td><code>_rwdTokenData</code></td><td><code>RewardTokenData[]</code></td><td>- Initialize data for reward tokens.</td></tr>
</tbody></table>
</div>
<h3 id="_recovererc20-2"><a class="header" href="#_recovererc20-2">_recoverERC20</a></h3>
<p>Recover erc20 tokens other than the reward Tokens and farm token.</p>
<pre><code class="language-solidity">function _recoverERC20(address _token) internal virtual override;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_token</code></td><td><code>address</code></td><td>Address of token to be recovered.</td></tr>
</tbody></table>
</div>
<h2 id="events"><a class="header" href="#events">Events</a></h2>
<h3 id="poolfeecollected"><a class="header" href="#poolfeecollected">PoolFeeCollected</a></h3>
<pre><code class="language-solidity">event PoolFeeCollected(address indexed recipient, uint256 amt0Recv, uint256 amt1Recv);
</code></pre>
<h2 id="errors-1"><a class="header" href="#errors-1">Errors</a></h2>
<h3 id="invalidamount"><a class="header" href="#invalidamount">InvalidAmount</a></h3>
<pre><code class="language-solidity">error InvalidAmount();
</code></pre>
<h3 id="cannotwithdrawfarmtoken"><a class="header" href="#cannotwithdrawfarmtoken">CannotWithdrawFarmToken</a></h3>
<pre><code class="language-solidity">error CannotWithdrawFarmToken();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-5"><a class="header" href="#contents-5">Contents</a></h1>
<ul>
<li><a href="contracts/e721-farms//contracts/e721-farms/camelotV2">camelotV2</a></li>
<li><a href="contracts/e721-farms//contracts/e721-farms/camelotV3">camelotV3</a></li>
<li><a href="contracts/e721-farms//contracts/e721-farms/uniswapV3">uniswapV3</a></li>
<li><a href="contracts/e721-farms/E721Farm.sol/abstract.E721Farm.html">E721Farm</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-6"><a class="header" href="#contents-6">Contents</a></h1>
<ul>
<li><a href="contracts/e721-farms/camelotV2//contracts/e721-farms/camelotV2/interfaces">interfaces</a></li>
<li><a href="contracts/e721-farms/camelotV2/CamelotV2Farm.sol/contract.CamelotV2Farm.html">CamelotV2Farm</a></li>
<li><a href="contracts/e721-farms/camelotV2/CamelotV2FarmDeployer.sol/contract.CamelotV2FarmDeployer.html">CamelotV2FarmDeployer</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-7"><a class="header" href="#contents-7">Contents</a></h1>
<ul>
<li><a href="contracts/e721-farms/camelotV2/interfaces/ICamelotV2.sol/interface.INFTPoolFactory.html">INFTPoolFactory</a></li>
<li><a href="contracts/e721-farms/camelotV2/interfaces/ICamelotV2.sol/interface.IPair.html">IPair</a></li>
<li><a href="contracts/e721-farms/camelotV2/interfaces/ICamelotV2.sol/interface.INFTPool.html">INFTPool</a></li>
<li><a href="contracts/e721-farms/camelotV2/interfaces/ICamelotV2.sol/interface.ICamelotV2Factory.html">ICamelotV2Factory</a></li>
<li><a href="contracts/e721-farms/camelotV2/interfaces/ICamelotV2.sol/interface.INFTHandler.html">INFTHandler</a></li>
<li><a href="contracts/e721-farms/camelotV2/interfaces/ICamelotV2.sol/interface.IPositionHelper.html">IPositionHelper</a></li>
<li><a href="contracts/e721-farms/camelotV2/interfaces/ICamelotV2.sol/interface.IRouter.html">IRouter</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="inftpoolfactory"><a class="header" href="#inftpoolfactory">INFTPoolFactory</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/camelotV2/interfaces/ICamelotV2.sol">Git Source</a></p>
<h2 id="functions-7"><a class="header" href="#functions-7">Functions</a></h2>
<h3 id="getpool-1"><a class="header" href="#getpool-1">getPool</a></h3>
<pre><code class="language-solidity">function getPool(address _lpTokenAddr) external view returns (address);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ipair"><a class="header" href="#ipair">IPair</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/camelotV2/interfaces/ICamelotV2.sol">Git Source</a></p>
<h2 id="functions-8"><a class="header" href="#functions-8">Functions</a></h2>
<h3 id="getreserves"><a class="header" href="#getreserves">getReserves</a></h3>
<pre><code class="language-solidity">function getReserves()
    external
    view
    returns (uint112 _reserve0, uint112 _reserve1, uint16 _token0FeePercent, uint16 _token1FeePercent);
</code></pre>
<h3 id="token0"><a class="header" href="#token0">token0</a></h3>
<pre><code class="language-solidity">function token0() external view returns (address);
</code></pre>
<h3 id="token1"><a class="header" href="#token1">token1</a></h3>
<pre><code class="language-solidity">function token1() external view returns (address);
</code></pre>
<h3 id="totalsupply"><a class="header" href="#totalsupply">totalSupply</a></h3>
<pre><code class="language-solidity">function totalSupply() external view returns (uint256);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="inftpool"><a class="header" href="#inftpool">INFTPool</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/camelotV2/interfaces/ICamelotV2.sol">Git Source</a></p>
<h2 id="functions-9"><a class="header" href="#functions-9">Functions</a></h2>
<h3 id="addtoposition"><a class="header" href="#addtoposition">addToPosition</a></h3>
<pre><code class="language-solidity">function addToPosition(uint256 tokenId, uint256 amountToAdd) external;
</code></pre>
<h3 id="withdrawfromposition"><a class="header" href="#withdrawfromposition">withdrawFromPosition</a></h3>
<p><em>Withdraw from a staking position
Can only be called by spNFT's owner or approved address</em></p>
<pre><code class="language-solidity">function withdrawFromPosition(uint256 tokenId, uint256 amountToWithdraw) external;
</code></pre>
<h3 id="updatepool"><a class="header" href="#updatepool">updatePool</a></h3>
<pre><code class="language-solidity">function updatePool() external;
</code></pre>
<h3 id="harvestpositionto"><a class="header" href="#harvestpositionto">harvestPositionTo</a></h3>
<p><em>Harvest from a staking position to "to" address
Can only be called by spNFT's owner or approved address
spNFT's owner must be a contract</em></p>
<pre><code class="language-solidity">function harvestPositionTo(uint256 tokenId, address to) external;
</code></pre>
<h3 id="safetransferfrom"><a class="header" href="#safetransferfrom">safeTransferFrom</a></h3>
<pre><code class="language-solidity">function safeTransferFrom(address from, address to, uint256 tokenId) external;
</code></pre>
<h3 id="safetransferfrom-1"><a class="header" href="#safetransferfrom-1">safeTransferFrom</a></h3>
<pre><code class="language-solidity">function safeTransferFrom(address from, address to, uint256 tokenId, bytes calldata data) external;
</code></pre>
<h3 id="lasttokenid"><a class="header" href="#lasttokenid">lastTokenId</a></h3>
<pre><code class="language-solidity">function lastTokenId() external view returns (uint256);
</code></pre>
<h3 id="tokenofownerbyindex"><a class="header" href="#tokenofownerbyindex">tokenOfOwnerByIndex</a></h3>
<pre><code class="language-solidity">function tokenOfOwnerByIndex(address owner, uint256 index) external view returns (uint256);
</code></pre>
<h3 id="getstakingposition"><a class="header" href="#getstakingposition">getStakingPosition</a></h3>
<pre><code class="language-solidity">function getStakingPosition(uint256 tokenId)
    external
    view
    returns (
        uint256 amount,
        uint256 amountWithMultiplier,
        uint256 startLockTime,
        uint256 lockDuration,
        uint256 lockMultiplier,
        uint256 rewardDebt,
        uint256 boostPoints,
        uint256 totalMultiplier
    );
</code></pre>
<h3 id="getpoolinfo"><a class="header" href="#getpoolinfo">getPoolInfo</a></h3>
<pre><code class="language-solidity">function getPoolInfo()
    external
    view
    returns (
        address lpToken,
        address grailToken,
        address xGrailToken,
        uint256 lastRewardTime,
        uint256 accRewardsPerShare,
        uint256 lpSupply,
        uint256 lpSupplyWithMultiplier,
        uint256 allocPoint
    );
</code></pre>
<h3 id="pendingrewards"><a class="header" href="#pendingrewards">pendingRewards</a></h3>
<pre><code class="language-solidity">function pendingRewards(uint256 tokenId) external view returns (uint256);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="icamelotv2factory"><a class="header" href="#icamelotv2factory">ICamelotV2Factory</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/camelotV2/interfaces/ICamelotV2.sol">Git Source</a></p>
<h2 id="functions-10"><a class="header" href="#functions-10">Functions</a></h2>
<h3 id="getpair-1"><a class="header" href="#getpair-1">getPair</a></h3>
<pre><code class="language-solidity">function getPair(address _tokenA, address _tokenB) external view returns (address);
</code></pre>
<h3 id="allpairs-1"><a class="header" href="#allpairs-1">allPairs</a></h3>
<pre><code class="language-solidity">function allPairs(uint256 _id) external view returns (address);
</code></pre>
<h3 id="allpairslength-1"><a class="header" href="#allpairslength-1">allPairsLength</a></h3>
<pre><code class="language-solidity">function allPairsLength() external view returns (uint256);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="infthandler"><a class="header" href="#infthandler">INFTHandler</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/camelotV2/interfaces/ICamelotV2.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
IERC721Receiver</p>
<h2 id="functions-11"><a class="header" href="#functions-11">Functions</a></h2>
<h3 id="onnftharvest"><a class="header" href="#onnftharvest">onNFTHarvest</a></h3>
<pre><code class="language-solidity">function onNFTHarvest(address operator, address to, uint256 tokenId, uint256 grailAmount, uint256 xGrailAmount)
    external
    returns (bool);
</code></pre>
<h3 id="onnftaddtoposition"><a class="header" href="#onnftaddtoposition">onNFTAddToPosition</a></h3>
<pre><code class="language-solidity">function onNFTAddToPosition(address operator, uint256 tokenId, uint256 lpAmount) external returns (bool);
</code></pre>
<h3 id="onnftwithdraw"><a class="header" href="#onnftwithdraw">onNFTWithdraw</a></h3>
<pre><code class="language-solidity">function onNFTWithdraw(address operator, uint256 tokenId, uint256 lpAmount) external returns (bool);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ipositionhelper"><a class="header" href="#ipositionhelper">IPositionHelper</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/camelotV2/interfaces/ICamelotV2.sol">Git Source</a></p>
<h2 id="functions-12"><a class="header" href="#functions-12">Functions</a></h2>
<h3 id="addliquidityandcreateposition"><a class="header" href="#addliquidityandcreateposition">addLiquidityAndCreatePosition</a></h3>
<pre><code class="language-solidity">function addLiquidityAndCreatePosition(
    address tokenA,
    address tokenB,
    uint256 amountADesired,
    uint256 amountBDesired,
    uint256 amountAMin,
    uint256 amountBMin,
    uint256 deadline,
    address to,
    INFTPool nftPool,
    uint256 lockDuration
) external;
</code></pre>
<h3 id="addliquidityethandcreateposition"><a class="header" href="#addliquidityethandcreateposition">addLiquidityETHAndCreatePosition</a></h3>
<pre><code class="language-solidity">function addLiquidityETHAndCreatePosition(
    address token,
    uint256 amountTokenDesired,
    uint256 amountTokenMin,
    uint256 amountETHMin,
    uint256 deadline,
    address to,
    INFTPool nftPool,
    uint256 lockDuration
) external payable;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="irouter"><a class="header" href="#irouter">IRouter</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/camelotV2/interfaces/ICamelotV2.sol">Git Source</a></p>
<h2 id="functions-13"><a class="header" href="#functions-13">Functions</a></h2>
<h3 id="addliquidity"><a class="header" href="#addliquidity">addLiquidity</a></h3>
<pre><code class="language-solidity">function addLiquidity(
    address tokenA,
    address tokenB,
    uint256 amountADesired,
    uint256 amountBDesired,
    uint256 amountAMin,
    uint256 amountBMin,
    address to,
    uint256 deadline
) external returns (uint256 amountA, uint256 amountB, uint256 liquidity);
</code></pre>
<h3 id="removeliquidity"><a class="header" href="#removeliquidity">removeLiquidity</a></h3>
<pre><code class="language-solidity">function removeLiquidity(
    address tokenA,
    address tokenB,
    uint256 liquidity,
    uint256 amountAMin,
    uint256 amountBMin,
    address to,
    uint256 deadline
) external returns (uint256 amountA, uint256 amountB);
</code></pre>
<h3 id="quote"><a class="header" href="#quote">quote</a></h3>
<pre><code class="language-solidity">function quote(uint256 amountA, uint256 reserveA, uint256 reserveB) external pure returns (uint256 amountB);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="camelotv2farm"><a class="header" href="#camelotv2farm">CamelotV2Farm</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/camelotV2/CamelotV2Farm.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/e721-farms/camelotV2/CamelotV2Farm.sol//contracts/e721-farms/E721Farm.sol/abstract.E721Farm.html">E721Farm</a>, <a href="contracts/e721-farms/camelotV2/CamelotV2Farm.sol//contracts/e721-farms/camelotV2/interfaces/ICamelotV2.sol/interface.INFTHandler.html">INFTHandler</a>, <a href="contracts/e721-farms/camelotV2/CamelotV2Farm.sol//contracts/features/OperableDeposit.sol/abstract.OperableDeposit.html">OperableDeposit</a>, <a href="contracts/e721-farms/camelotV2/CamelotV2Farm.sol//contracts/features/ExpirableFarm.sol/abstract.ExpirableFarm.html">ExpirableFarm</a></p>
<p><strong>Author:</strong>
Sperax Foundation.</p>
<p>This contract is the implementation of the Camelot V2 farm.</p>
<h2 id="state-variables-3"><a class="header" href="#state-variables-3">State Variables</a></h2>
<h3 id="router"><a class="header" href="#router">router</a></h3>
<pre><code class="language-solidity">address public router;
</code></pre>
<h3 id="poollptoken"><a class="header" href="#poollptoken">poolLpToken</a></h3>
<pre><code class="language-solidity">address internal poolLpToken;
</code></pre>
<h3 id="pooltoken0"><a class="header" href="#pooltoken0">poolToken0</a></h3>
<pre><code class="language-solidity">address internal poolToken0;
</code></pre>
<h3 id="pooltoken1"><a class="header" href="#pooltoken1">poolToken1</a></h3>
<pre><code class="language-solidity">address internal poolToken1;
</code></pre>
<h2 id="functions-14"><a class="header" href="#functions-14">Functions</a></h2>
<h3 id="initialize-2"><a class="header" href="#initialize-2">initialize</a></h3>
<p>constructor.</p>
<p><em>_cooldownPeriod = 0 Disables lockup functionality for the farm.</em></p>
<pre><code class="language-solidity">function initialize(
    string calldata _farmId,
    uint256 _farmStartTime,
    uint256 _cooldownPeriod,
    address _farmRegistry,
    address _camelotPairPool,
    RewardTokenData[] memory _rwdTokenData,
    address _router,
    address _nftPoolFactory
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farmId</code></td><td><code>string</code></td><td>ID of the farm. E.g: <code>Demeter_Camelot_V2</code>.</td></tr>
<tr><td><code>_farmStartTime</code></td><td><code>uint256</code></td><td>- farm start time.</td></tr>
<tr><td><code>_cooldownPeriod</code></td><td><code>uint256</code></td><td>- Cooldown period for locked deposits in days.</td></tr>
<tr><td><code>_farmRegistry</code></td><td><code>address</code></td><td>- Address of the Demeter Farm Registry.</td></tr>
<tr><td><code>_camelotPairPool</code></td><td><code>address</code></td><td>- Camelot lp pool address.</td></tr>
<tr><td><code>_rwdTokenData</code></td><td><code>RewardTokenData[]</code></td><td>- Initialize data for reward tokens.</td></tr>
<tr><td><code>_router</code></td><td><code>address</code></td><td>Camelot Router's address.</td></tr>
<tr><td><code>_nftPoolFactory</code></td><td><code>address</code></td><td>Non fungible position manager contract for Camelot V2.</td></tr>
</tbody></table>
</div>
<h3 id="increasedeposit-1"><a class="header" href="#increasedeposit-1">increaseDeposit</a></h3>
<p>Allow user to increase liquidity for a deposit.</p>
<pre><code class="language-solidity">function increaseDeposit(uint256 _depositId, uint256[2] calldata _amounts, uint256[2] calldata _minAmounts)
    external
    nonReentrant;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>The id of the deposit to be increased.</td></tr>
<tr><td><code>_amounts</code></td><td><code>uint256[2]</code></td><td>Desired amount of tokens to be increased.</td></tr>
<tr><td><code>_minAmounts</code></td><td><code>uint256[2]</code></td><td>Minimum amount of tokens to be added as liquidity.</td></tr>
</tbody></table>
</div>
<h3 id="decreasedeposit-1"><a class="header" href="#decreasedeposit-1">decreaseDeposit</a></h3>
<p>Withdraw liquidity partially from an existing deposit.</p>
<pre><code class="language-solidity">function decreaseDeposit(uint256 _depositId, uint256 _liquidityToWithdraw, uint256[2] calldata _minAmounts)
    external
    nonReentrant;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>Deposit index for the user.</td></tr>
<tr><td><code>_liquidityToWithdraw</code></td><td><code>uint256</code></td><td>Amount to be withdrawn.</td></tr>
<tr><td><code>_minAmounts</code></td><td><code>uint256[2]</code></td><td>Minimum amount of tokens to be received.</td></tr>
</tbody></table>
</div>
<h3 id="claimpoolrewards"><a class="header" href="#claimpoolrewards">claimPoolRewards</a></h3>
<p>Claim uniswap pool fee for a deposit.</p>
<p><em>Only the deposit owner can claim the fee.</em></p>
<pre><code class="language-solidity">function claimPoolRewards(uint256 _depositId) external nonReentrant;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>Id of the deposit.</td></tr>
</tbody></table>
</div>
<h3 id="onnftharvest-1"><a class="header" href="#onnftharvest-1">onNFTHarvest</a></h3>
<p>callback function for harvestPosition().</p>
<pre><code class="language-solidity">function onNFTHarvest(address, address _to, uint256 _tokenId, uint256 _grailAmount, uint256 _xGrailAmount)
    external
    override
    returns (bool);
</code></pre>
<h3 id="computepoolrewards"><a class="header" href="#computepoolrewards">computePoolRewards</a></h3>
<p>Get the accrued camelot fee for a deposit.</p>
<pre><code class="language-solidity">function computePoolRewards(uint256 _tokenId) external view returns (uint256 amount);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_tokenId</code></td><td><code>uint256</code></td><td>The tokenId of the position.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>amount</code></td><td><code>uint256</code></td><td>Grail rewards.</td></tr>
</tbody></table>
</div>
<h3 id="onnftaddtoposition-1"><a class="header" href="#onnftaddtoposition-1">onNFTAddToPosition</a></h3>
<p>This function is called when liquidity is added to an existing position.</p>
<pre><code class="language-solidity">function onNFTAddToPosition(address operator, uint256, uint256) external view override returns (bool);
</code></pre>
<h3 id="onnftwithdraw-1"><a class="header" href="#onnftwithdraw-1">onNFTWithdraw</a></h3>
<p>This function is called when liquidity is withdrawn from an NFT position.</p>
<pre><code class="language-solidity">function onNFTWithdraw(address operator, uint256, uint256) external view override returns (bool);
</code></pre>
<h3 id="getdepositamounts"><a class="header" href="#getdepositamounts">getDepositAmounts</a></h3>
<p>This function can be called before allocating funds into the strategy.
it accepts desired amounts, checks pool condition and returns the amount.
which will be needed/ accepted by the strategy for a balanced allocation.</p>
<pre><code class="language-solidity">function getDepositAmounts(uint256 amountADesired, uint256 amountBDesired)
    external
    view
    returns (uint256 amountA, uint256 amountB);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>amountADesired</code></td><td><code>uint256</code></td><td>Amount of token A that is desired to be allocated.</td></tr>
<tr><td><code>amountBDesired</code></td><td><code>uint256</code></td><td>Amount of token B that is desired to be allocated.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>amountA</code></td><td><code>uint256</code></td><td>Amount A tokens which will be accepted in allocation.</td></tr>
<tr><td><code>amountB</code></td><td><code>uint256</code></td><td>Amount B tokens which will be accepted in allocation.</td></tr>
</tbody></table>
</div>
<h3 id="gettokenamounts-2"><a class="header" href="#gettokenamounts-2">getTokenAmounts</a></h3>
<p>Function to be called by Demeter Rewarder to get tokens and amounts associated with the farm's liquidity.</p>
<pre><code class="language-solidity">function getTokenAmounts() external view override returns (address[] memory tokens, uint256[] memory amounts);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>tokens</code></td><td><code>address[]</code></td><td>An array of token addresses.</td></tr>
<tr><td><code>amounts</code></td><td><code>uint256[]</code></td><td>An array of token amounts.</td></tr>
</tbody></table>
</div>
<h3 id="updatefarmstarttime-2"><a class="header" href="#updatefarmstarttime-2">updateFarmStartTime</a></h3>
<p>Update the farm start time.</p>
<p><em>Calls ExpirableFarm's updateFarmStartTime function.</em></p>
<pre><code class="language-solidity">function updateFarmStartTime(uint256 _newStartTime) public override(Farm, ExpirableFarm);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_newStartTime</code></td><td><code>uint256</code></td><td>The new farm start time.</td></tr>
</tbody></table>
</div>
<h3 id="isfarmopen-2"><a class="header" href="#isfarmopen-2">isFarmOpen</a></h3>
<p>Returns if farm is open.
Farm is open if it is not closed.</p>
<p><em>Calls ExpirableFarm's isOpenFarm function.</em></p>
<pre><code class="language-solidity">function isFarmOpen() public view override(Farm, ExpirableFarm) returns (bool);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>bool True if farm is open.</td></tr>
</tbody></table>
</div>
<h3 id="_getliquidity"><a class="header" href="#_getliquidity">_getLiquidity</a></h3>
<p>Validate the position for the pool and get Liquidity.</p>
<p><em>The position must adhere to the price ranges.</em></p>
<p><em>Only allow specific pool token to be staked.</em></p>
<pre><code class="language-solidity">function _getLiquidity(uint256 _tokenId) internal view override returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_tokenId</code></td><td><code>uint256</code></td><td>The tokenId of the position.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>liquidity The liquidity of the position.</td></tr>
</tbody></table>
</div>
<h2 id="events-1"><a class="header" href="#events-1">Events</a></h2>
<h3 id="poolrewardscollected"><a class="header" href="#poolrewardscollected">PoolRewardsCollected</a></h3>
<pre><code class="language-solidity">event PoolRewardsCollected(address indexed recipient, uint256 indexed tokenId, uint256 grailAmt, uint256 xGrailAmt);
</code></pre>
<h2 id="errors-2"><a class="header" href="#errors-2">Errors</a></h2>
<h3 id="invalidcamelotpoolconfig"><a class="header" href="#invalidcamelotpoolconfig">InvalidCamelotPoolConfig</a></h3>
<pre><code class="language-solidity">error InvalidCamelotPoolConfig();
</code></pre>
<h3 id="notallowed"><a class="header" href="#notallowed">NotAllowed</a></h3>
<pre><code class="language-solidity">error NotAllowed();
</code></pre>
<h3 id="invalidamount-1"><a class="header" href="#invalidamount-1">InvalidAmount</a></h3>
<pre><code class="language-solidity">error InvalidAmount();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="camelotv2farmdeployer"><a class="header" href="#camelotv2farmdeployer">CamelotV2FarmDeployer</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/camelotV2/CamelotV2FarmDeployer.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/e721-farms/camelotV2/CamelotV2FarmDeployer.sol//contracts/FarmDeployer.sol/abstract.FarmDeployer.html">FarmDeployer</a></p>
<p><strong>Author:</strong>
Sperax Foundation.</p>
<p>This contract allows anyone to calculate fees, pay fees and create farms.</p>
<p><em>It consults Camelot V2 factory to validate the pool.</em></p>
<h2 id="state-variables-4"><a class="header" href="#state-variables-4">State Variables</a></h2>
<h3 id="protocol_factory-1"><a class="header" href="#protocol_factory-1">PROTOCOL_FACTORY</a></h3>
<pre><code class="language-solidity">address public immutable PROTOCOL_FACTORY;
</code></pre>
<h3 id="router-1"><a class="header" href="#router-1">ROUTER</a></h3>
<pre><code class="language-solidity">address public immutable ROUTER;
</code></pre>
<h3 id="nft_pool_factory"><a class="header" href="#nft_pool_factory">NFT_POOL_FACTORY</a></h3>
<pre><code class="language-solidity">address public immutable NFT_POOL_FACTORY;
</code></pre>
<h2 id="functions-15"><a class="header" href="#functions-15">Functions</a></h2>
<h3 id="constructor-2"><a class="header" href="#constructor-2">constructor</a></h3>
<p>Constructor of the contract.</p>
<pre><code class="language-solidity">constructor(
    address _farmRegistry,
    string memory _farmId,
    address _protocolFactory,
    address _router,
    address _nftPoolFactory
) FarmDeployer(_farmRegistry, _farmId);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farmRegistry</code></td><td><code>address</code></td><td>Address of the Demeter Farm Registry.</td></tr>
<tr><td><code>_farmId</code></td><td><code>string</code></td><td>Id of the farm.</td></tr>
<tr><td><code>_protocolFactory</code></td><td><code>address</code></td><td>Address of Camelot factory.</td></tr>
<tr><td><code>_router</code></td><td><code>address</code></td><td>Address of Camelot router.</td></tr>
<tr><td><code>_nftPoolFactory</code></td><td><code>address</code></td><td>Address of Camelot NFT pool factory.</td></tr>
</tbody></table>
</div>
<h3 id="createfarm-2"><a class="header" href="#createfarm-2">createFarm</a></h3>
<p>Deploys a new UniswapV3 farm.</p>
<p><em>The caller of this function should approve feeAmount to this contract before calling this function.</em></p>
<pre><code class="language-solidity">function createFarm(FarmData memory _data) external nonReentrant returns (address);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_data</code></td><td><code>FarmData</code></td><td>data for deployment.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td>address of the deployed farm.</td></tr>
</tbody></table>
</div>
<h3 id="validatepool-2"><a class="header" href="#validatepool-2">validatePool</a></h3>
<p>Validates the pool.</p>
<pre><code class="language-solidity">function validatePool(address _tokenA, address _tokenB) public view returns (address pool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_tokenA</code></td><td><code>address</code></td><td>Address of token A.</td></tr>
<tr><td><code>_tokenB</code></td><td><code>address</code></td><td>Address of token B.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>pool</code></td><td><code>address</code></td><td>Pool address.</td></tr>
</tbody></table>
</div>
<h2 id="structs-2"><a class="header" href="#structs-2">Structs</a></h2>
<h3 id="camelotpooldata"><a class="header" href="#camelotpooldata">CamelotPoolData</a></h3>
<pre><code class="language-solidity">struct CamelotPoolData {
    address tokenA;
    address tokenB;
}
</code></pre>
<h3 id="farmdata-2"><a class="header" href="#farmdata-2">FarmData</a></h3>
<pre><code class="language-solidity">struct FarmData {
    address farmAdmin;
    uint256 farmStartTime;
    uint256 cooldownPeriod;
    CamelotPoolData camelotPoolData;
    RewardTokenData[] rewardData;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-8"><a class="header" href="#contents-8">Contents</a></h1>
<ul>
<li><a href="contracts/e721-farms/camelotV3//contracts/e721-farms/camelotV3/interfaces">interfaces</a></li>
<li><a href="contracts/e721-farms/camelotV3/CamelotV3Farm.sol/struct.CamelotPoolData.html">CamelotPoolData</a></li>
<li><a href="contracts/e721-farms/camelotV3/CamelotV3Farm.sol/struct.InitializeInput.html">InitializeInput</a></li>
<li><a href="contracts/e721-farms/camelotV3/CamelotV3Farm.sol/contract.CamelotV3Farm.html">CamelotV3Farm</a></li>
<li><a href="contracts/e721-farms/camelotV3/CamelotV3FarmDeployer.sol/contract.CamelotV3FarmDeployer.html">CamelotV3FarmDeployer</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-9"><a class="header" href="#contents-9">Contents</a></h1>
<ul>
<li><a href="contracts/e721-farms/camelotV3/interfaces/ICamelotV3.sol/interface.INFPM.html">INFPM</a></li>
<li><a href="contracts/e721-farms/camelotV3/interfaces/ICamelotV3.sol/interface.ICamelotV3Factory.html">ICamelotV3Factory</a></li>
<li><a href="contracts/e721-farms/camelotV3/interfaces/ICamelotV3.sol/interface.ICamelotV3TickSpacing.html">ICamelotV3TickSpacing</a></li>
<li><a href="contracts/e721-farms/camelotV3/interfaces/ICamelotV3.sol/interface.ICamelotV3PoolState.html">ICamelotV3PoolState</a></li>
<li><a href="contracts/e721-farms/camelotV3/interfaces/ICamelotV3NonfungiblePositionManagerUtils.sol/struct.Position.html">Position</a></li>
<li><a href="contracts/e721-farms/camelotV3/interfaces/ICamelotV3NonfungiblePositionManagerUtils.sol/interface.ICamelotV3NFPMUtils.html">ICamelotV3NFPMUtils</a></li>
<li><a href="contracts/e721-farms/camelotV3/interfaces/ICamelotV3Utils.sol/interface.ICamelotV3Utils.html">ICamelotV3Utils</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="infpm"><a class="header" href="#infpm">INFPM</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/camelotV3/interfaces/ICamelotV3.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
IERC721</p>
<p>Wraps Camelot V3 positions in a non-fungible token interface which allows for them to be transferred
and authorized.</p>
<h2 id="functions-16"><a class="header" href="#functions-16">Functions</a></h2>
<h3 id="mint"><a class="header" href="#mint">mint</a></h3>
<p>Creates a new position wrapped in a NFT</p>
<p><em>Call this when the pool does exist and is initialized. Note that if the pool is created but not initialized
a method does not exist, i.e. the pool is assumed to be initialized.</em></p>
<pre><code class="language-solidity">function mint(MintParams calldata params)
    external
    payable
    returns (uint256 tokenId, uint128 liquidity, uint256 amount0, uint256 amount1);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>params</code></td><td><code>MintParams</code></td><td>The params necessary to mint a position, encoded as <code>MintParams</code> in calldata</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>tokenId</code></td><td><code>uint256</code></td><td>The ID of the token that represents the minted position</td></tr>
<tr><td><code>liquidity</code></td><td><code>uint128</code></td><td>The amount of liquidity for this position</td></tr>
<tr><td><code>amount0</code></td><td><code>uint256</code></td><td>The amount of token0</td></tr>
<tr><td><code>amount1</code></td><td><code>uint256</code></td><td>The amount of token1</td></tr>
</tbody></table>
</div>
<h3 id="collect"><a class="header" href="#collect">collect</a></h3>
<p>Collects up to a maximum amount of fees owed to a specific position to the recipient</p>
<pre><code class="language-solidity">function collect(CollectParams calldata params) external payable returns (uint256 amount0, uint256 amount1);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>params</code></td><td><code>CollectParams</code></td><td>tokenId The ID of the NFT for which tokens are being collected, recipient The account that should receive the tokens, amount0Max The maximum amount of token0 to collect, amount1Max The maximum amount of token1 to collect</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>amount0</code></td><td><code>uint256</code></td><td>The amount of fees collected in token0</td></tr>
<tr><td><code>amount1</code></td><td><code>uint256</code></td><td>The amount of fees collected in token1</td></tr>
</tbody></table>
</div>
<h3 id="increaseliquidity"><a class="header" href="#increaseliquidity">increaseLiquidity</a></h3>
<p>Increases the amount of liquidity in a position, with tokens paid by the <code>msg.sender</code></p>
<pre><code class="language-solidity">function increaseLiquidity(IncreaseLiquidityParams calldata params)
    external
    payable
    returns (uint128 liquidity, uint256 amount0, uint256 amount1);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>params</code></td><td><code>IncreaseLiquidityParams</code></td><td>tokenId The ID of the token for which liquidity is being increased, amount0Desired The desired amount of token0 to be spent, amount1Desired The desired amount of token1 to be spent, amount0Min The minimum amount of token0 to spend, which serves as a slippage check, amount1Min The minimum amount of token1 to spend, which serves as a slippage check, deadline The time by which the transaction must be included to effect the change</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>liquidity</code></td><td><code>uint128</code></td><td>The new liquidity amount as a result of the increase</td></tr>
<tr><td><code>amount0</code></td><td><code>uint256</code></td><td>The amount of token0 to acheive resulting liquidity</td></tr>
<tr><td><code>amount1</code></td><td><code>uint256</code></td><td>The amount of token1 to acheive resulting liquidity</td></tr>
</tbody></table>
</div>
<h3 id="decreaseliquidity"><a class="header" href="#decreaseliquidity">decreaseLiquidity</a></h3>
<p>Decreases the amount of liquidity in a position and accounts it to the position</p>
<pre><code class="language-solidity">function decreaseLiquidity(DecreaseLiquidityParams calldata params)
    external
    payable
    returns (uint256 amount0, uint256 amount1);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>params</code></td><td><code>DecreaseLiquidityParams</code></td><td>tokenId The ID of the token for which liquidity is being decreased, amount The amount by which liquidity will be decreased, amount0Min The minimum amount of token0 that should be accounted for the burned liquidity, amount1Min The minimum amount of token1 that should be accounted for the burned liquidity, deadline The time by which the transaction must be included to effect the change</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>amount0</code></td><td><code>uint256</code></td><td>The amount of token0 accounted to the position's tokens owed</td></tr>
<tr><td><code>amount1</code></td><td><code>uint256</code></td><td>The amount of token1 accounted to the position's tokens owed</td></tr>
</tbody></table>
</div>
<h3 id="positions"><a class="header" href="#positions">positions</a></h3>
<p>Returns the position information associated with a given token ID.</p>
<p><em>Throws if the token ID is not valid.</em></p>
<pre><code class="language-solidity">function positions(uint256 tokenId)
    external
    view
    returns (
        uint96 nonce,
        address operator,
        address token0,
        address token1,
        int24 tickLower,
        int24 tickUpper,
        uint128 liquidity,
        uint256 feeGrowthInside0LastX128,
        uint256 feeGrowthInside1LastX128,
        uint128 tokensOwed0,
        uint128 tokensOwed1
    );
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>tokenId</code></td><td><code>uint256</code></td><td>The ID of the token that represents the position</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>nonce</code></td><td><code>uint96</code></td><td>The nonce for permits</td></tr>
<tr><td><code>operator</code></td><td><code>address</code></td><td>The address that is approved for spending</td></tr>
<tr><td><code>token0</code></td><td><code>address</code></td><td>The address of the token0 for a specific pool</td></tr>
<tr><td><code>token1</code></td><td><code>address</code></td><td>The address of the token1 for a specific pool</td></tr>
<tr><td><code>tickLower</code></td><td><code>int24</code></td><td>The lower end of the tick range for the position</td></tr>
<tr><td><code>tickUpper</code></td><td><code>int24</code></td><td>The higher end of the tick range for the position</td></tr>
<tr><td><code>liquidity</code></td><td><code>uint128</code></td><td>The liquidity of the position</td></tr>
<tr><td><code>feeGrowthInside0LastX128</code></td><td><code>uint256</code></td><td>The fee growth of token0 as of the last action on the individual position</td></tr>
<tr><td><code>feeGrowthInside1LastX128</code></td><td><code>uint256</code></td><td>The fee growth of token1 as of the last action on the individual position</td></tr>
<tr><td><code>tokensOwed0</code></td><td><code>uint128</code></td><td>The uncollected amount of token0 owed to the position as of the last computation</td></tr>
<tr><td><code>tokensOwed1</code></td><td><code>uint128</code></td><td>The uncollected amount of token1 owed to the position as of the last computation</td></tr>
</tbody></table>
</div>
<h3 id="factory"><a class="header" href="#factory">factory</a></h3>
<pre><code class="language-solidity">function factory() external view returns (address);
</code></pre>
<h2 id="structs-3"><a class="header" href="#structs-3">Structs</a></h2>
<h3 id="mintparams"><a class="header" href="#mintparams">MintParams</a></h3>
<pre><code class="language-solidity">struct MintParams {
    address token0;
    address token1;
    int24 tickLower;
    int24 tickUpper;
    uint256 amount0Desired;
    uint256 amount1Desired;
    uint256 amount0Min;
    uint256 amount1Min;
    address recipient;
    uint256 deadline;
}
</code></pre>
<h3 id="increaseliquidityparams"><a class="header" href="#increaseliquidityparams">IncreaseLiquidityParams</a></h3>
<pre><code class="language-solidity">struct IncreaseLiquidityParams {
    uint256 tokenId;
    uint256 amount0Desired;
    uint256 amount1Desired;
    uint256 amount0Min;
    uint256 amount1Min;
    uint256 deadline;
}
</code></pre>
<h3 id="decreaseliquidityparams"><a class="header" href="#decreaseliquidityparams">DecreaseLiquidityParams</a></h3>
<pre><code class="language-solidity">struct DecreaseLiquidityParams {
    uint256 tokenId;
    uint128 liquidity;
    uint256 amount0Min;
    uint256 amount1Min;
    uint256 deadline;
}
</code></pre>
<h3 id="collectparams"><a class="header" href="#collectparams">CollectParams</a></h3>
<pre><code class="language-solidity">struct CollectParams {
    uint256 tokenId;
    address recipient;
    uint128 amount0Max;
    uint128 amount1Max;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="icamelotv3factory"><a class="header" href="#icamelotv3factory">ICamelotV3Factory</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/camelotV3/interfaces/ICamelotV3.sol">Git Source</a></p>
<h2 id="functions-17"><a class="header" href="#functions-17">Functions</a></h2>
<h3 id="poolbypair"><a class="header" href="#poolbypair">poolByPair</a></h3>
<p>Returns the pool address for a given pair of tokens and a fee, or address 0 if it does not exist</p>
<p><em>tokenA and tokenB may be passed in either token0/token1 or token1/token0 order</em></p>
<pre><code class="language-solidity">function poolByPair(address tokenA, address tokenB) external view returns (address pool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>tokenA</code></td><td><code>address</code></td><td>The contract address of either token0 or token1</td></tr>
<tr><td><code>tokenB</code></td><td><code>address</code></td><td>The contract address of the other token</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>pool</code></td><td><code>address</code></td><td>The pool address</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="icamelotv3tickspacing"><a class="header" href="#icamelotv3tickspacing">ICamelotV3TickSpacing</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/camelotV3/interfaces/ICamelotV3.sol">Git Source</a></p>
<h2 id="functions-18"><a class="header" href="#functions-18">Functions</a></h2>
<h3 id="tickspacing"><a class="header" href="#tickspacing">tickSpacing</a></h3>
<pre><code class="language-solidity">function tickSpacing() external view returns (int24);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="icamelotv3poolstate"><a class="header" href="#icamelotv3poolstate">ICamelotV3PoolState</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/camelotV3/interfaces/ICamelotV3.sol">Git Source</a></p>
<p><em>Credit to Uniswap Labs under GPL-2.0-or-later license:
https://github.com/Uniswap/v3-core/tree/main/contracts/interfaces</em></p>
<h2 id="functions-19"><a class="header" href="#functions-19">Functions</a></h2>
<h3 id="globalstate"><a class="header" href="#globalstate">globalState</a></h3>
<p>The globalState structure in the pool stores many values but requires only one slot
and is exposed as a single method to save gas when accessed externally.</p>
<pre><code class="language-solidity">function globalState()
    external
    view
    returns (
        uint160 price,
        int24 tick,
        uint16 feeZto,
        uint16 feeOtz,
        uint16 timepointIndex,
        uint8 communityFeeToken0,
        uint8 communityFeeToken1,
        bool unlocked
    );
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>price</code></td><td><code>uint160</code></td><td>The current price of the pool as a sqrt(token1/token0) Q64.96 value; Returns tick The current tick of the pool, i.e. according to the last tick transition that was run; Returns This value may not always be equal to SqrtTickMath.getTickAtSqrtRatio(price) if the price is on a tick boundary; Returns feeZto The last pool fee value for ZtO swaps in hundredths of a bip, i.e. 1e-6; Returns feeOtz The last pool fee value for OtZ swaps in hundredths of a bip, i.e. 1e-6; Returns timepointIndex The index of the last written timepoint; Returns communityFeeToken0 The community fee percentage of the swap fee in thousandths (1e-3) for token0; Returns communityFeeToken1 The community fee percentage of the swap fee in thousandths (1e-3) for token1; Returns unlocked Whether the pool is currently locked to reentrancy;</td></tr>
<tr><td><code>tick</code></td><td><code>int24</code></td><td></td></tr>
<tr><td><code>feeZto</code></td><td><code>uint16</code></td><td></td></tr>
<tr><td><code>feeOtz</code></td><td><code>uint16</code></td><td></td></tr>
<tr><td><code>timepointIndex</code></td><td><code>uint16</code></td><td></td></tr>
<tr><td><code>communityFeeToken0</code></td><td><code>uint8</code></td><td></td></tr>
<tr><td><code>communityFeeToken1</code></td><td><code>uint8</code></td><td></td></tr>
<tr><td><code>unlocked</code></td><td><code>bool</code></td><td></td></tr>
</tbody></table>
</div>
<h3 id="token0-1"><a class="header" href="#token0-1">token0</a></h3>
<pre><code class="language-solidity">function token0() external view returns (address);
</code></pre>
<h3 id="token1-1"><a class="header" href="#token1-1">token1</a></h3>
<pre><code class="language-solidity">function token1() external view returns (address);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="position"><a class="header" href="#position">Position</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/camelotV3/interfaces/ICamelotV3NonfungiblePositionManagerUtils.sol">Git Source</a></p>
<pre><code class="language-solidity">struct Position {
    uint96 nonce;
    address operator;
    address token0;
    address token1;
    int24 tickLower;
    int24 tickUpper;
    uint128 liquidity;
    uint256 feeGrowthInside0LastX128;
    uint256 feeGrowthInside1LastX128;
    uint128 tokensOwed0;
    uint128 tokensOwed1;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="icamelotv3nfpmutils"><a class="header" href="#icamelotv3nfpmutils">ICamelotV3NFPMUtils</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/camelotV3/interfaces/ICamelotV3NonfungiblePositionManagerUtils.sol">Git Source</a></p>
<h2 id="functions-20"><a class="header" href="#functions-20">Functions</a></h2>
<h3 id="positions-1"><a class="header" href="#positions-1">positions</a></h3>
<pre><code class="language-solidity">function positions(address positionManager, uint256 tokenId) external view returns (Position memory position);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="icamelotv3utils"><a class="header" href="#icamelotv3utils">ICamelotV3Utils</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/camelotV3/interfaces/ICamelotV3Utils.sol">Git Source</a></p>
<h2 id="functions-21"><a class="header" href="#functions-21">Functions</a></h2>
<h3 id="getamountsforliquidity"><a class="header" href="#getamountsforliquidity">getAmountsForLiquidity</a></h3>
<pre><code class="language-solidity">function getAmountsForLiquidity(uint160 sqrtRatioX96, int24 _tickLower, int24 _tickUpper, uint128 _liquidity)
    external
    pure
    returns (uint256 amount0, uint256 amount1);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="camelotpooldata-1"><a class="header" href="#camelotpooldata-1">CamelotPoolData</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/camelotV3/CamelotV3Farm.sol">Git Source</a></p>
<pre><code class="language-solidity">struct CamelotPoolData {
    address tokenA;
    address tokenB;
    int24 tickLowerAllowed;
    int24 tickUpperAllowed;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="initializeinput"><a class="header" href="#initializeinput">InitializeInput</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/camelotV3/CamelotV3Farm.sol">Git Source</a></p>
<pre><code class="language-solidity">struct InitializeInput {
    string farmId;
    uint256 farmStartTime;
    uint256 cooldownPeriod;
    address farmRegistry;
    CamelotPoolData camelotPoolData;
    RewardTokenData[] rwdTokenData;
    address camelotV3Factory;
    address nftContract;
    address camelotUtils;
    address nfpmUtils;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="camelotv3farm"><a class="header" href="#camelotv3farm">CamelotV3Farm</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/camelotV3/CamelotV3Farm.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/e721-farms/camelotV3/CamelotV3Farm.sol//contracts/e721-farms/E721Farm.sol/abstract.E721Farm.html">E721Farm</a>, <a href="contracts/e721-farms/camelotV3/CamelotV3Farm.sol//contracts/features/OperableDeposit.sol/abstract.OperableDeposit.html">OperableDeposit</a>, <a href="contracts/e721-farms/camelotV3/CamelotV3Farm.sol//contracts/features/ClaimableFee.sol/abstract.ClaimableFee.html">ClaimableFee</a></p>
<p><strong>Author:</strong>
Sperax Foundation.</p>
<p>This contract is the implementation of the Camelot V3 farm.</p>
<h2 id="state-variables-5"><a class="header" href="#state-variables-5">State Variables</a></h2>
<h3 id="ticklowerallowed"><a class="header" href="#ticklowerallowed">tickLowerAllowed</a></h3>
<pre><code class="language-solidity">int24 public tickLowerAllowed;
</code></pre>
<h3 id="tickupperallowed"><a class="header" href="#tickupperallowed">tickUpperAllowed</a></h3>
<pre><code class="language-solidity">int24 public tickUpperAllowed;
</code></pre>
<h3 id="camelotpool"><a class="header" href="#camelotpool">camelotPool</a></h3>
<pre><code class="language-solidity">address public camelotPool;
</code></pre>
<h3 id="camelotv3factory"><a class="header" href="#camelotv3factory">camelotV3Factory</a></h3>
<pre><code class="language-solidity">address public camelotV3Factory;
</code></pre>
<h3 id="camelotutils"><a class="header" href="#camelotutils">camelotUtils</a></h3>
<pre><code class="language-solidity">address public camelotUtils;
</code></pre>
<h3 id="nfpmutils"><a class="header" href="#nfpmutils">nfpmUtils</a></h3>
<pre><code class="language-solidity">address public nfpmUtils;
</code></pre>
<h3 id="min_tick"><a class="header" href="#min_tick">MIN_TICK</a></h3>
<pre><code class="language-solidity">int256 internal constant MIN_TICK = -887272;
</code></pre>
<h3 id="max_tick"><a class="header" href="#max_tick">MAX_TICK</a></h3>
<pre><code class="language-solidity">int256 internal constant MAX_TICK = 887272;
</code></pre>
<h2 id="functions-22"><a class="header" href="#functions-22">Functions</a></h2>
<h3 id="initialize-3"><a class="header" href="#initialize-3">initialize</a></h3>
<p>Initializer function of this farm.</p>
<pre><code class="language-solidity">function initialize(InitializeInput calldata _input) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_input</code></td><td><code>InitializeInput</code></td><td>A struct having all the input params.</td></tr>
</tbody></table>
</div>
<h3 id="increasedeposit-2"><a class="header" href="#increasedeposit-2">increaseDeposit</a></h3>
<p>Allow user to increase liquidity for a deposit.</p>
<pre><code class="language-solidity">function increaseDeposit(uint256 _depositId, uint256[2] calldata _amounts, uint256[2] calldata _minAmounts)
    external
    nonReentrant;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>The id of the deposit to be increased.</td></tr>
<tr><td><code>_amounts</code></td><td><code>uint256[2]</code></td><td>Desired amount of tokens to be increased.</td></tr>
<tr><td><code>_minAmounts</code></td><td><code>uint256[2]</code></td><td>Minimum amount of tokens to be added as liquidity.</td></tr>
</tbody></table>
</div>
<h3 id="decreasedeposit-2"><a class="header" href="#decreasedeposit-2">decreaseDeposit</a></h3>
<p>Withdraw liquidity partially from an existing deposit.</p>
<pre><code class="language-solidity">function decreaseDeposit(uint256 _depositId, uint128 _liquidityToWithdraw, uint256[2] calldata _minAmounts)
    external
    nonReentrant;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>Deposit index for the user.</td></tr>
<tr><td><code>_liquidityToWithdraw</code></td><td><code>uint128</code></td><td>Amount to be withdrawn.</td></tr>
<tr><td><code>_minAmounts</code></td><td><code>uint256[2]</code></td><td>Minimum amount of tokens to be received.</td></tr>
</tbody></table>
</div>
<h3 id="gettokenamounts-3"><a class="header" href="#gettokenamounts-3">getTokenAmounts</a></h3>
<p>Function to be called by Demeter Rewarder to get tokens and amounts associated with the farm's liquidity.</p>
<pre><code class="language-solidity">function getTokenAmounts() external view override returns (address[] memory, uint256[] memory);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address[]</code></td><td>tokens An array of token addresses.</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256[]</code></td><td>amounts An array of token amounts.</td></tr>
</tbody></table>
</div>
<h3 id="_claimpoolfee"><a class="header" href="#_claimpoolfee">_claimPoolFee</a></h3>
<p>Claim pool fee implementation from <code>ClaimableFee</code> feature.</p>
<pre><code class="language-solidity">function _claimPoolFee(uint256 _depositId)
    internal
    override
    returns (uint256 tokenId, uint256 amt0Recv, uint256 amt1Recv);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>Deposit ID of the deposit in the farm.</td></tr>
</tbody></table>
</div>
<h3 id="_getliquidity-1"><a class="header" href="#_getliquidity-1">_getLiquidity</a></h3>
<p>Validate the position for the pool and get Liquidity.</p>
<p><em>The position must adhere to the price ranges.</em></p>
<p><em>Only allow specific pool token to be staked.</em></p>
<pre><code class="language-solidity">function _getLiquidity(uint256 _tokenId) internal view override returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_tokenId</code></td><td><code>uint256</code></td><td>The tokenId of the position.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The liquidity of the position.</td></tr>
</tbody></table>
</div>
<h3 id="_validatetickrange"><a class="header" href="#_validatetickrange">_validateTickRange</a></h3>
<p>Validate the ticks (upper and lower).</p>
<p><em>Get the info of the required token.</em></p>
<p><em>Check if the token belongs to correct pool.</em></p>
<p><em>Check if the token adheres to the tick range.</em></p>
<p><em>The ticks must be within the max range and must be multiple of tickSpacing.</em></p>
<pre><code class="language-solidity">function _validateTickRange(int24 _tickLower, int24 _tickUpper) private view;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_tickLower</code></td><td><code>int24</code></td><td>The lower tick of the range.</td></tr>
<tr><td><code>_tickUpper</code></td><td><code>int24</code></td><td>The upper tick of the range.</td></tr>
</tbody></table>
</div>
<h2 id="errors-3"><a class="header" href="#errors-3">Errors</a></h2>
<h3 id="invalidcamelotpoolconfig-1"><a class="header" href="#invalidcamelotpoolconfig-1">InvalidCamelotPoolConfig</a></h3>
<pre><code class="language-solidity">error InvalidCamelotPoolConfig();
</code></pre>
<h3 id="incorrectpooltoken"><a class="header" href="#incorrectpooltoken">IncorrectPoolToken</a></h3>
<pre><code class="language-solidity">error IncorrectPoolToken();
</code></pre>
<h3 id="incorrecttickrange"><a class="header" href="#incorrecttickrange">IncorrectTickRange</a></h3>
<pre><code class="language-solidity">error IncorrectTickRange();
</code></pre>
<h3 id="invalidtickrange"><a class="header" href="#invalidtickrange">InvalidTickRange</a></h3>
<pre><code class="language-solidity">error InvalidTickRange();
</code></pre>
<h3 id="invalidamount-2"><a class="header" href="#invalidamount-2">InvalidAmount</a></h3>
<pre><code class="language-solidity">error InvalidAmount();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="camelotv3farmdeployer"><a class="header" href="#camelotv3farmdeployer">CamelotV3FarmDeployer</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/camelotV3/CamelotV3FarmDeployer.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/e721-farms/camelotV3/CamelotV3FarmDeployer.sol//contracts/FarmDeployer.sol/abstract.FarmDeployer.html">FarmDeployer</a></p>
<p><strong>Author:</strong>
Sperax Foundation.</p>
<p>This contract allows anyone to calculate fees, pay fees and create farms.</p>
<h2 id="state-variables-6"><a class="header" href="#state-variables-6">State Variables</a></h2>
<h3 id="camelot_v3_factory"><a class="header" href="#camelot_v3_factory">CAMELOT_V3_FACTORY</a></h3>
<pre><code class="language-solidity">address public immutable CAMELOT_V3_FACTORY;
</code></pre>
<h3 id="nfpm"><a class="header" href="#nfpm">NFPM</a></h3>
<pre><code class="language-solidity">address public immutable NFPM;
</code></pre>
<h3 id="camelot_utils"><a class="header" href="#camelot_utils">CAMELOT_UTILS</a></h3>
<pre><code class="language-solidity">address public immutable CAMELOT_UTILS;
</code></pre>
<h3 id="camelot_nfpm_utils"><a class="header" href="#camelot_nfpm_utils">CAMELOT_NFPM_UTILS</a></h3>
<pre><code class="language-solidity">address public immutable CAMELOT_NFPM_UTILS;
</code></pre>
<h2 id="functions-23"><a class="header" href="#functions-23">Functions</a></h2>
<h3 id="constructor-3"><a class="header" href="#constructor-3">constructor</a></h3>
<p>Constructor of the contract.</p>
<pre><code class="language-solidity">constructor(
    address _farmRegistry,
    string memory _farmId,
    address _camelotV3Factory,
    address _nfpm,
    address _camelotUtils,
    address _nfpmUtils
) FarmDeployer(_farmRegistry, _farmId);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farmRegistry</code></td><td><code>address</code></td><td>Address of the Demeter Farm Registry.</td></tr>
<tr><td><code>_farmId</code></td><td><code>string</code></td><td>Id of the farm.</td></tr>
<tr><td><code>_camelotV3Factory</code></td><td><code>address</code></td><td>Address of CamelotV3 factory.</td></tr>
<tr><td><code>_nfpm</code></td><td><code>address</code></td><td>Address of Camelot NonfungiblePositionManager contract.</td></tr>
<tr><td><code>_camelotUtils</code></td><td><code>address</code></td><td>Address of CamelotUtils (Camelot helper) contract.</td></tr>
<tr><td><code>_nfpmUtils</code></td><td><code>address</code></td><td>Address of Camelot INonfungiblePositionManagerUtils (NonfungiblePositionManager helper) contract.</td></tr>
</tbody></table>
</div>
<h3 id="createfarm-3"><a class="header" href="#createfarm-3">createFarm</a></h3>
<p>Deploys a new CamelotV3 farm.</p>
<p><em>The caller of this function should approve feeAmount to this contract before calling this function.</em></p>
<pre><code class="language-solidity">function createFarm(FarmData memory _data) external nonReentrant returns (address);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_data</code></td><td><code>FarmData</code></td><td>Data for deployment.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td>Address of the deployed farm.</td></tr>
</tbody></table>
</div>
<h2 id="structs-4"><a class="header" href="#structs-4">Structs</a></h2>
<h3 id="farmdata-3"><a class="header" href="#farmdata-3">FarmData</a></h3>
<pre><code class="language-solidity">struct FarmData {
    address farmAdmin;
    uint256 farmStartTime;
    uint256 cooldownPeriod;
    CamelotPoolData camelotPoolData;
    RewardTokenData[] rewardData;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-10"><a class="header" href="#contents-10">Contents</a></h1>
<ul>
<li><a href="contracts/e721-farms/uniswapV3//contracts/e721-farms/uniswapV3/interfaces">interfaces</a></li>
<li><a href="contracts/e721-farms/uniswapV3//contracts/e721-farms/uniswapV3/tests">tests</a></li>
<li><a href="contracts/e721-farms/uniswapV3/UniV3ActiveLiquidityDeployer.sol/contract.UniV3ActiveLiquidityDeployer.html">UniV3ActiveLiquidityDeployer</a></li>
<li><a href="contracts/e721-farms/uniswapV3/UniV3ActiveLiquidityFarm.sol/contract.UniV3ActiveLiquidityFarm.html">UniV3ActiveLiquidityFarm</a></li>
<li><a href="contracts/e721-farms/uniswapV3/UniV3Farm.sol/struct.UniswapPoolData.html">UniswapPoolData</a></li>
<li><a href="contracts/e721-farms/uniswapV3/UniV3Farm.sol/struct.InitializeInput.html">InitializeInput</a></li>
<li><a href="contracts/e721-farms/uniswapV3/UniV3Farm.sol/contract.UniV3Farm.html">UniV3Farm</a></li>
<li><a href="contracts/e721-farms/uniswapV3/UniV3FarmDeployer.sol/contract.UniV3FarmDeployer.html">UniV3FarmDeployer</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-11"><a class="header" href="#contents-11">Contents</a></h1>
<ul>
<li><a href="contracts/e721-farms/uniswapV3/interfaces/INonfungiblePositionManagerUtils.sol/struct.Position.html">Position</a></li>
<li><a href="contracts/e721-farms/uniswapV3/interfaces/INonfungiblePositionManagerUtils.sol/interface.INFPMUtils.html">INFPMUtils</a></li>
<li><a href="contracts/e721-farms/uniswapV3/interfaces/IUniswapV3.sol/interface.IPoolInitializer.html">IPoolInitializer</a></li>
<li><a href="contracts/e721-farms/uniswapV3/interfaces/IUniswapV3.sol/interface.INFPM.html">INFPM</a></li>
<li><a href="contracts/e721-farms/uniswapV3/interfaces/IUniswapV3.sol/interface.IUniswapV3Factory.html">IUniswapV3Factory</a></li>
<li><a href="contracts/e721-farms/uniswapV3/interfaces/IUniswapV3.sol/interface.IUniswapV3TickSpacing.html">IUniswapV3TickSpacing</a></li>
<li><a href="contracts/e721-farms/uniswapV3/interfaces/IUniswapV3.sol/interface.IUniswapV3PoolDerivedState.html">IUniswapV3PoolDerivedState</a></li>
<li><a href="contracts/e721-farms/uniswapV3/interfaces/IUniswapV3.sol/interface.IUniswapV3PoolState.html">IUniswapV3PoolState</a></li>
<li><a href="contracts/e721-farms/uniswapV3/interfaces/IUniswapV3Utils.sol/interface.IUniswapV3Utils.html">IUniswapV3Utils</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="position-1"><a class="header" href="#position-1">Position</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/uniswapV3/interfaces/INonfungiblePositionManagerUtils.sol">Git Source</a></p>
<pre><code class="language-solidity">struct Position {
    uint96 nonce;
    address operator;
    address token0;
    address token1;
    uint24 fee;
    int24 tickLower;
    int24 tickUpper;
    uint128 liquidity;
    uint256 feeGrowthInside0LastX128;
    uint256 feeGrowthInside1LastX128;
    uint128 tokensOwed0;
    uint128 tokensOwed1;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="infpmutils"><a class="header" href="#infpmutils">INFPMUtils</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/uniswapV3/interfaces/INonfungiblePositionManagerUtils.sol">Git Source</a></p>
<h2 id="functions-24"><a class="header" href="#functions-24">Functions</a></h2>
<h3 id="positions-2"><a class="header" href="#positions-2">positions</a></h3>
<pre><code class="language-solidity">function positions(address positionManager, uint256 tokenId) external view returns (Position memory position);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ipoolinitializer"><a class="header" href="#ipoolinitializer">IPoolInitializer</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/uniswapV3/interfaces/IUniswapV3.sol">Git Source</a></p>
<p>Wraps Uniswap V3 positions in a non-fungible token interface which allows for them to be transferred
and authorized.</p>
<h2 id="functions-25"><a class="header" href="#functions-25">Functions</a></h2>
<h3 id="createandinitializepoolifnecessary"><a class="header" href="#createandinitializepoolifnecessary">createAndInitializePoolIfNecessary</a></h3>
<p>Creates a new pool if it does not exist, then initializes if not initialized</p>
<p><em>This method can be bundled with others via IMulticall for the first action (e.g. mint) performed against a pool</em></p>
<pre><code class="language-solidity">function createAndInitializePoolIfNecessary(address token0, address token1, uint24 fee, uint160 sqrtPriceX96)
    external
    payable
    returns (address pool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>token0</code></td><td><code>address</code></td><td>The contract address of token0 of the pool</td></tr>
<tr><td><code>token1</code></td><td><code>address</code></td><td>The contract address of token1 of the pool</td></tr>
<tr><td><code>fee</code></td><td><code>uint24</code></td><td>The fee amount of the v3 pool for the specified token pair</td></tr>
<tr><td><code>sqrtPriceX96</code></td><td><code>uint160</code></td><td>The initial square root price of the pool as a Q64.96 value</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>pool</code></td><td><code>address</code></td><td>Returns the pool address based on the pair of tokens and fee, will return the newly created pool address if necessary</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="infpm-1"><a class="header" href="#infpm-1">INFPM</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/uniswapV3/interfaces/IUniswapV3.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/e721-farms/uniswapV3/interfaces/IUniswapV3.sol//contracts/e721-farms/uniswapV3/interfaces/IUniswapV3.sol/interface.IPoolInitializer.html">IPoolInitializer</a>, IERC721</p>
<h2 id="functions-26"><a class="header" href="#functions-26">Functions</a></h2>
<h3 id="mint-1"><a class="header" href="#mint-1">mint</a></h3>
<p>Creates a new position wrapped in a NFT</p>
<p><em>Call this when the pool does exist and is initialized. Note that if the pool is created but not initialized
a method does not exist, i.e. the pool is assumed to be initialized.</em></p>
<pre><code class="language-solidity">function mint(MintParams calldata params)
    external
    payable
    returns (uint256 tokenId, uint128 liquidity, uint256 amount0, uint256 amount1);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>params</code></td><td><code>MintParams</code></td><td>The params necessary to mint a position, encoded as <code>MintParams</code> in calldata</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>tokenId</code></td><td><code>uint256</code></td><td>The ID of the token that represents the minted position</td></tr>
<tr><td><code>liquidity</code></td><td><code>uint128</code></td><td>The amount of liquidity for this position</td></tr>
<tr><td><code>amount0</code></td><td><code>uint256</code></td><td>The amount of token0</td></tr>
<tr><td><code>amount1</code></td><td><code>uint256</code></td><td>The amount of token1</td></tr>
</tbody></table>
</div>
<h3 id="collect-1"><a class="header" href="#collect-1">collect</a></h3>
<p>Collects up to a maximum amount of fees owed to a specific position to the recipient</p>
<pre><code class="language-solidity">function collect(CollectParams calldata params) external payable returns (uint256 amount0, uint256 amount1);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>params</code></td><td><code>CollectParams</code></td><td>tokenId The ID of the NFT for which tokens are being collected, recipient The account that should receive the tokens, amount0Max The maximum amount of token0 to collect, amount1Max The maximum amount of token1 to collect</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>amount0</code></td><td><code>uint256</code></td><td>The amount of fees collected in token0</td></tr>
<tr><td><code>amount1</code></td><td><code>uint256</code></td><td>The amount of fees collected in token1</td></tr>
</tbody></table>
</div>
<h3 id="increaseliquidity-1"><a class="header" href="#increaseliquidity-1">increaseLiquidity</a></h3>
<p>Increases the amount of liquidity in a position, with tokens paid by the <code>msg.sender</code></p>
<pre><code class="language-solidity">function increaseLiquidity(IncreaseLiquidityParams calldata params)
    external
    payable
    returns (uint128 liquidity, uint256 amount0, uint256 amount1);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>params</code></td><td><code>IncreaseLiquidityParams</code></td><td>tokenId The ID of the token for which liquidity is being increased, amount0Desired The desired amount of token0 to be spent, amount1Desired The desired amount of token1 to be spent, amount0Min The minimum amount of token0 to spend, which serves as a slippage check, amount1Min The minimum amount of token1 to spend, which serves as a slippage check, deadline The time by which the transaction must be included to effect the change</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>liquidity</code></td><td><code>uint128</code></td><td>The new liquidity amount as a result of the increase</td></tr>
<tr><td><code>amount0</code></td><td><code>uint256</code></td><td>The amount of token0 to acheive resulting liquidity</td></tr>
<tr><td><code>amount1</code></td><td><code>uint256</code></td><td>The amount of token1 to acheive resulting liquidity</td></tr>
</tbody></table>
</div>
<h3 id="decreaseliquidity-1"><a class="header" href="#decreaseliquidity-1">decreaseLiquidity</a></h3>
<p>Decreases the amount of liquidity in a position and accounts it to the position</p>
<pre><code class="language-solidity">function decreaseLiquidity(DecreaseLiquidityParams calldata params)
    external
    payable
    returns (uint256 amount0, uint256 amount1);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>params</code></td><td><code>DecreaseLiquidityParams</code></td><td>tokenId The ID of the token for which liquidity is being decreased, amount The amount by which liquidity will be decreased, amount0Min The minimum amount of token0 that should be accounted for the burned liquidity, amount1Min The minimum amount of token1 that should be accounted for the burned liquidity, deadline The time by which the transaction must be included to effect the change</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>amount0</code></td><td><code>uint256</code></td><td>The amount of token0 accounted to the position's tokens owed</td></tr>
<tr><td><code>amount1</code></td><td><code>uint256</code></td><td>The amount of token1 accounted to the position's tokens owed</td></tr>
</tbody></table>
</div>
<h3 id="positions-3"><a class="header" href="#positions-3">positions</a></h3>
<p>Returns the position information associated with a given token ID.</p>
<p><em>Throws if the token ID is not valid.</em></p>
<pre><code class="language-solidity">function positions(uint256 tokenId)
    external
    view
    returns (
        uint96 nonce,
        address operator,
        address token0,
        address token1,
        uint24 fee,
        int24 tickLower,
        int24 tickUpper,
        uint128 liquidity,
        uint256 feeGrowthInside0LastX128,
        uint256 feeGrowthInside1LastX128,
        uint128 tokensOwed0,
        uint128 tokensOwed1
    );
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>tokenId</code></td><td><code>uint256</code></td><td>The ID of the token that represents the position</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>nonce</code></td><td><code>uint96</code></td><td>The nonce for permits</td></tr>
<tr><td><code>operator</code></td><td><code>address</code></td><td>The address that is approved for spending</td></tr>
<tr><td><code>token0</code></td><td><code>address</code></td><td>The address of the token0 for a specific pool</td></tr>
<tr><td><code>token1</code></td><td><code>address</code></td><td>The address of the token1 for a specific pool</td></tr>
<tr><td><code>fee</code></td><td><code>uint24</code></td><td>The fee associated with the pool</td></tr>
<tr><td><code>tickLower</code></td><td><code>int24</code></td><td>The lower end of the tick range for the position</td></tr>
<tr><td><code>tickUpper</code></td><td><code>int24</code></td><td>The higher end of the tick range for the position</td></tr>
<tr><td><code>liquidity</code></td><td><code>uint128</code></td><td>The liquidity of the position</td></tr>
<tr><td><code>feeGrowthInside0LastX128</code></td><td><code>uint256</code></td><td>The fee growth of token0 as of the last action on the individual position</td></tr>
<tr><td><code>feeGrowthInside1LastX128</code></td><td><code>uint256</code></td><td>The fee growth of token1 as of the last action on the individual position</td></tr>
<tr><td><code>tokensOwed0</code></td><td><code>uint128</code></td><td>The uncollected amount of token0 owed to the position as of the last computation</td></tr>
<tr><td><code>tokensOwed1</code></td><td><code>uint128</code></td><td>The uncollected amount of token1 owed to the position as of the last computation</td></tr>
</tbody></table>
</div>
<h3 id="factory-1"><a class="header" href="#factory-1">factory</a></h3>
<pre><code class="language-solidity">function factory() external view returns (address);
</code></pre>
<h2 id="structs-5"><a class="header" href="#structs-5">Structs</a></h2>
<h3 id="mintparams-1"><a class="header" href="#mintparams-1">MintParams</a></h3>
<pre><code class="language-solidity">struct MintParams {
    address token0;
    address token1;
    uint24 fee;
    int24 tickLower;
    int24 tickUpper;
    uint256 amount0Desired;
    uint256 amount1Desired;
    uint256 amount0Min;
    uint256 amount1Min;
    address recipient;
    uint256 deadline;
}
</code></pre>
<h3 id="increaseliquidityparams-1"><a class="header" href="#increaseliquidityparams-1">IncreaseLiquidityParams</a></h3>
<pre><code class="language-solidity">struct IncreaseLiquidityParams {
    uint256 tokenId;
    uint256 amount0Desired;
    uint256 amount1Desired;
    uint256 amount0Min;
    uint256 amount1Min;
    uint256 deadline;
}
</code></pre>
<h3 id="decreaseliquidityparams-1"><a class="header" href="#decreaseliquidityparams-1">DecreaseLiquidityParams</a></h3>
<pre><code class="language-solidity">struct DecreaseLiquidityParams {
    uint256 tokenId;
    uint128 liquidity;
    uint256 amount0Min;
    uint256 amount1Min;
    uint256 deadline;
}
</code></pre>
<h3 id="collectparams-1"><a class="header" href="#collectparams-1">CollectParams</a></h3>
<pre><code class="language-solidity">struct CollectParams {
    uint256 tokenId;
    address recipient;
    uint128 amount0Max;
    uint128 amount1Max;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iuniswapv3factory"><a class="header" href="#iuniswapv3factory">IUniswapV3Factory</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/uniswapV3/interfaces/IUniswapV3.sol">Git Source</a></p>
<h2 id="functions-27"><a class="header" href="#functions-27">Functions</a></h2>
<h3 id="getpool-2"><a class="header" href="#getpool-2">getPool</a></h3>
<p>Returns the pool address for a given pair of tokens and a fee, or address 0 if it does not exist</p>
<p><em>tokenA and tokenB may be passed in either token0/token1 or token1/token0 order</em></p>
<pre><code class="language-solidity">function getPool(address tokenA, address tokenB, uint24 fee) external view returns (address pool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>tokenA</code></td><td><code>address</code></td><td>The contract address of either token0 or token1</td></tr>
<tr><td><code>tokenB</code></td><td><code>address</code></td><td>The contract address of the other token</td></tr>
<tr><td><code>fee</code></td><td><code>uint24</code></td><td>The fee collected upon every swap in the pool, denominated in hundredths of a bip</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>pool</code></td><td><code>address</code></td><td>The pool address</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="iuniswapv3tickspacing"><a class="header" href="#iuniswapv3tickspacing">IUniswapV3TickSpacing</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/uniswapV3/interfaces/IUniswapV3.sol">Git Source</a></p>
<h2 id="functions-28"><a class="header" href="#functions-28">Functions</a></h2>
<h3 id="tickspacing-1"><a class="header" href="#tickspacing-1">tickSpacing</a></h3>
<pre><code class="language-solidity">function tickSpacing() external view returns (int24);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iuniswapv3poolderivedstate"><a class="header" href="#iuniswapv3poolderivedstate">IUniswapV3PoolDerivedState</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/uniswapV3/interfaces/IUniswapV3.sol">Git Source</a></p>
<p>Contains view functions to provide information about the pool that is computed rather than stored on the
blockchain. The functions here may have variable gas costs.</p>
<h2 id="functions-29"><a class="header" href="#functions-29">Functions</a></h2>
<h3 id="snapshotcumulativesinside"><a class="header" href="#snapshotcumulativesinside">snapshotCumulativesInside</a></h3>
<p>Returns a snapshot of the tick cumulative, seconds per liquidity and seconds inside a tick range</p>
<p><em>Snapshots must only be compared to other snapshots, taken over a period for which a position existed.
I.e., snapshots cannot be compared if a position is not held for the entire period between when the first
snapshot is taken and the second snapshot is taken.</em></p>
<pre><code class="language-solidity">function snapshotCumulativesInside(int24 tickLower, int24 tickUpper)
    external
    view
    returns (int56 tickCumulativeInside, uint160 secondsPerLiquidityInsideX128, uint32 secondsInside);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>tickLower</code></td><td><code>int24</code></td><td>The lower tick of the range</td></tr>
<tr><td><code>tickUpper</code></td><td><code>int24</code></td><td>The upper tick of the range</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>tickCumulativeInside</code></td><td><code>int56</code></td><td>The snapshot of the tick accumulator for the range</td></tr>
<tr><td><code>secondsPerLiquidityInsideX128</code></td><td><code>uint160</code></td><td>The snapshot of seconds per liquidity for the range</td></tr>
<tr><td><code>secondsInside</code></td><td><code>uint32</code></td><td>The snapshot of seconds per liquidity for the range</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="iuniswapv3poolstate"><a class="header" href="#iuniswapv3poolstate">IUniswapV3PoolState</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/uniswapV3/interfaces/IUniswapV3.sol">Git Source</a></p>
<p>These methods compose the pool's state, and can change with any frequency including multiple times
per transaction</p>
<h2 id="functions-30"><a class="header" href="#functions-30">Functions</a></h2>
<h3 id="slot0"><a class="header" href="#slot0">slot0</a></h3>
<p>The 0th storage slot in the pool stores many values, and is exposed as a single method to save gas
when accessed externally.</p>
<pre><code class="language-solidity">function slot0()
    external
    view
    returns (
        uint160 sqrtPriceX96,
        int24 tick,
        uint16 observationIndex,
        uint16 observationCardinality,
        uint16 observationCardinalityNext,
        uint8 feeProtocol,
        bool unlocked
    );
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>sqrtPriceX96</code></td><td><code>uint160</code></td><td>The current price of the pool as a sqrt(token1/token0) Q64.96 value tick The current tick of the pool, i.e. according to the last tick transition that was run. This value may not always be equal to SqrtTickMath.getTickAtSqrtRatio(sqrtPriceX96) if the price is on a tick boundary. observationIndex The index of the last oracle observation that was written, observationCardinality The current maximum number of observations stored in the pool, observationCardinalityNext The next maximum number of observations, to be updated when the observation. feeProtocol The protocol fee for both tokens of the pool. Encoded as two 4 bit values, where the protocol fee of token1 is shifted 4 bits and the protocol fee of token0 is the lower 4 bits. Used as the denominator of a fraction of the swap fee, e.g. 4 means 1/4th of the swap fee. unlocked Whether the pool is currently locked to reentrancy</td></tr>
<tr><td><code>tick</code></td><td><code>int24</code></td><td></td></tr>
<tr><td><code>observationIndex</code></td><td><code>uint16</code></td><td></td></tr>
<tr><td><code>observationCardinality</code></td><td><code>uint16</code></td><td></td></tr>
<tr><td><code>observationCardinalityNext</code></td><td><code>uint16</code></td><td></td></tr>
<tr><td><code>feeProtocol</code></td><td><code>uint8</code></td><td></td></tr>
<tr><td><code>unlocked</code></td><td><code>bool</code></td><td></td></tr>
</tbody></table>
</div>
<h3 id="token0-2"><a class="header" href="#token0-2">token0</a></h3>
<pre><code class="language-solidity">function token0() external view returns (address);
</code></pre>
<h3 id="token1-2"><a class="header" href="#token1-2">token1</a></h3>
<pre><code class="language-solidity">function token1() external view returns (address);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iuniswapv3utils"><a class="header" href="#iuniswapv3utils">IUniswapV3Utils</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/uniswapV3/interfaces/IUniswapV3Utils.sol">Git Source</a></p>
<h2 id="functions-31"><a class="header" href="#functions-31">Functions</a></h2>
<h3 id="fees"><a class="header" href="#fees">fees</a></h3>
<pre><code class="language-solidity">function fees(address positionManager, uint256 tokenId) external view returns (uint256 amount0, uint256 amount1);
</code></pre>
<h3 id="getoldestobservationsecondsago"><a class="header" href="#getoldestobservationsecondsago">getOldestObservationSecondsAgo</a></h3>
<pre><code class="language-solidity">function getOldestObservationSecondsAgo(address pool) external view returns (uint32 secondsAgo);
</code></pre>
<h3 id="consult"><a class="header" href="#consult">consult</a></h3>
<pre><code class="language-solidity">function consult(address pool, uint32 secondsAgo)
    external
    view
    returns (int24 arithmeticMeanTick, uint128 harmonicMeanLiquidity);
</code></pre>
<h3 id="getquoteattick"><a class="header" href="#getquoteattick">getQuoteAtTick</a></h3>
<pre><code class="language-solidity">function getQuoteAtTick(int24 tick, uint128 baseAmount, address baseToken, address quoteToken)
    external
    pure
    returns (uint256 quoteAmount);
</code></pre>
<h3 id="getamountsforliquidity-1"><a class="header" href="#getamountsforliquidity-1">getAmountsForLiquidity</a></h3>
<pre><code class="language-solidity">function getAmountsForLiquidity(uint160 sqrtRatioX96, int24 _tickLower, int24 _tickUpper, uint128 _liquidity)
    external
    pure
    returns (uint256 amount0, uint256 amount1);
</code></pre>
<h3 id="getsqrtratioattick"><a class="header" href="#getsqrtratioattick">getSqrtRatioAtTick</a></h3>
<pre><code class="language-solidity">function getSqrtRatioAtTick(int24 tick) external pure returns (uint160 sqrtRatioX96);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-12"><a class="header" href="#contents-12">Contents</a></h1>
<ul>
<li><a href="contracts/e721-farms/uniswapV3/tests/ISwapRouter.sol/interface.ISwapRouter.html">ISwapRouter</a></li>
<li><a href="contracts/e721-farms/uniswapV3/tests/UniswapV3Test.sol/contract.UniswapV3Test.html">UniswapV3Test</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iswaprouter"><a class="header" href="#iswaprouter">ISwapRouter</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/uniswapV3/tests/ISwapRouter.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
IUniswapV3SwapCallback</p>
<p>Functions for swapping tokens via Uniswap V3</p>
<h2 id="functions-32"><a class="header" href="#functions-32">Functions</a></h2>
<h3 id="exactinputsingle"><a class="header" href="#exactinputsingle">exactInputSingle</a></h3>
<p>Swaps <code>amountIn</code> of one token for as much as possible of another token</p>
<pre><code class="language-solidity">function exactInputSingle(ExactInputSingleParams calldata params) external payable returns (uint256 amountOut);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>params</code></td><td><code>ExactInputSingleParams</code></td><td>The parameters necessary for the swap, encoded as <code>ExactInputSingleParams</code> in calldata</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>amountOut</code></td><td><code>uint256</code></td><td>The amount of the received token</td></tr>
</tbody></table>
</div>
<h3 id="exactinput"><a class="header" href="#exactinput">exactInput</a></h3>
<p>Swaps <code>amountIn</code> of one token for as much as possible of another along the specified path</p>
<pre><code class="language-solidity">function exactInput(ExactInputParams calldata params) external payable returns (uint256 amountOut);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>params</code></td><td><code>ExactInputParams</code></td><td>The parameters necessary for the multi-hop swap, encoded as <code>ExactInputParams</code> in calldata</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>amountOut</code></td><td><code>uint256</code></td><td>The amount of the received token</td></tr>
</tbody></table>
</div>
<h3 id="exactoutputsingle"><a class="header" href="#exactoutputsingle">exactOutputSingle</a></h3>
<p>Swaps as little as possible of one token for <code>amountOut</code> of another token</p>
<pre><code class="language-solidity">function exactOutputSingle(ExactOutputSingleParams calldata params) external payable returns (uint256 amountIn);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>params</code></td><td><code>ExactOutputSingleParams</code></td><td>The parameters necessary for the swap, encoded as <code>ExactOutputSingleParams</code> in calldata</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>amountIn</code></td><td><code>uint256</code></td><td>The amount of the input token</td></tr>
</tbody></table>
</div>
<h3 id="exactoutput"><a class="header" href="#exactoutput">exactOutput</a></h3>
<p>Swaps as little as possible of one token for <code>amountOut</code> of another along the specified path (reversed)</p>
<pre><code class="language-solidity">function exactOutput(ExactOutputParams calldata params) external payable returns (uint256 amountIn);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>params</code></td><td><code>ExactOutputParams</code></td><td>The parameters necessary for the multi-hop swap, encoded as <code>ExactOutputParams</code> in calldata</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>amountIn</code></td><td><code>uint256</code></td><td>The amount of the input token</td></tr>
</tbody></table>
</div>
<h2 id="structs-6"><a class="header" href="#structs-6">Structs</a></h2>
<h3 id="exactinputsingleparams"><a class="header" href="#exactinputsingleparams">ExactInputSingleParams</a></h3>
<pre><code class="language-solidity">struct ExactInputSingleParams {
    address tokenIn;
    address tokenOut;
    uint24 fee;
    address recipient;
    uint256 amountIn;
    uint256 amountOutMinimum;
    uint160 sqrtPriceLimitX96;
}
</code></pre>
<h3 id="exactoutputsingleparams"><a class="header" href="#exactoutputsingleparams">ExactOutputSingleParams</a></h3>
<pre><code class="language-solidity">struct ExactOutputSingleParams {
    address tokenIn;
    address tokenOut;
    uint24 fee;
    address recipient;
    uint256 amountOut;
    uint256 amountInMaximum;
    uint160 sqrtPriceLimitX96;
}
</code></pre>
<h3 id="exactinputparams"><a class="header" href="#exactinputparams">ExactInputParams</a></h3>
<pre><code class="language-solidity">struct ExactInputParams {
    bytes path;
    address recipient;
    uint256 amountIn;
    uint256 amountOutMinimum;
}
</code></pre>
<h3 id="exactoutputparams"><a class="header" href="#exactoutputparams">ExactOutputParams</a></h3>
<pre><code class="language-solidity">struct ExactOutputParams {
    bytes path;
    address recipient;
    uint256 amountOut;
    uint256 amountInMaximum;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="uniswapv3test"><a class="header" href="#uniswapv3test">UniswapV3Test</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/uniswapV3/tests/UniswapV3Test.sol">Git Source</a></p>
<p><strong>Author:</strong>
Sperax Foundation</p>
<p><em>reference: https://docs.uniswap.org/protocol/guides/swaps/single-swaps</em></p>
<h2 id="state-variables-7"><a class="header" href="#state-variables-7">State Variables</a></h2>
<h3 id="nonfungiblepositionmanager"><a class="header" href="#nonfungiblepositionmanager">nonfungiblePositionManager</a></h3>
<pre><code class="language-solidity">INFPM public nonfungiblePositionManager;
</code></pre>
<h3 id="swap_router"><a class="header" href="#swap_router">SWAP_ROUTER</a></h3>
<pre><code class="language-solidity">ISwapRouter public immutable SWAP_ROUTER;
</code></pre>
<h2 id="functions-33"><a class="header" href="#functions-33">Functions</a></h2>
<h3 id="constructor-4"><a class="header" href="#constructor-4">constructor</a></h3>
<pre><code class="language-solidity">constructor(address _nfpm, address _swapRouter);
</code></pre>
<h3 id="swap"><a class="header" href="#swap">swap</a></h3>
<p>swaps a fixed amount of inputToken for a maximum possible amount of outputToken on Uniswap V3</p>
<pre><code class="language-solidity">function swap(address inputToken, address outputToken, uint24 poolFee, uint256 amountIn)
    external
    returns (uint256 amountOut);
</code></pre>
<h2 id="events-2"><a class="header" href="#events-2">Events</a></h2>
<h3 id="swaptest"><a class="header" href="#swaptest">SwapTest</a></h3>
<pre><code class="language-solidity">event SwapTest(address inputToken, address outputToken, uint256 amountIn, uint256 amountOut);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="univ3activeliquiditydeployer"><a class="header" href="#univ3activeliquiditydeployer">UniV3ActiveLiquidityDeployer</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/uniswapV3/UniV3ActiveLiquidityDeployer.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/e721-farms/uniswapV3/UniV3ActiveLiquidityDeployer.sol//contracts/FarmDeployer.sol/abstract.FarmDeployer.html">FarmDeployer</a></p>
<p><strong>Author:</strong>
Sperax Foundation.</p>
<p>This contract allows anyone to calculate fees, pay fees and create farms.</p>
<h2 id="state-variables-8"><a class="header" href="#state-variables-8">State Variables</a></h2>
<h3 id="uni_v3_factory"><a class="header" href="#uni_v3_factory">UNI_V3_FACTORY</a></h3>
<pre><code class="language-solidity">address public immutable UNI_V3_FACTORY;
</code></pre>
<h3 id="nfpm-1"><a class="header" href="#nfpm-1">NFPM</a></h3>
<pre><code class="language-solidity">address public immutable NFPM;
</code></pre>
<h3 id="uniswap_utils"><a class="header" href="#uniswap_utils">UNISWAP_UTILS</a></h3>
<pre><code class="language-solidity">address public immutable UNISWAP_UTILS;
</code></pre>
<h3 id="nfpm_utils"><a class="header" href="#nfpm_utils">NFPM_UTILS</a></h3>
<pre><code class="language-solidity">address public immutable NFPM_UTILS;
</code></pre>
<h2 id="functions-34"><a class="header" href="#functions-34">Functions</a></h2>
<h3 id="constructor-5"><a class="header" href="#constructor-5">constructor</a></h3>
<p>Constructor of the contract.</p>
<pre><code class="language-solidity">constructor(
    address _farmRegistry,
    string memory _farmId,
    address _uniV3Factory,
    address _nfpm,
    address _uniswapUtils,
    address _nfpmUtils
) FarmDeployer(_farmRegistry, _farmId);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farmRegistry</code></td><td><code>address</code></td><td>Address of the Demeter Farm Registry.</td></tr>
<tr><td><code>_farmId</code></td><td><code>string</code></td><td>Id of the farm.</td></tr>
<tr><td><code>_uniV3Factory</code></td><td><code>address</code></td><td>Address of UniswapV3 factory.</td></tr>
<tr><td><code>_nfpm</code></td><td><code>address</code></td><td>Address of Uniswap NonfungiblePositionManager contract.</td></tr>
<tr><td><code>_uniswapUtils</code></td><td><code>address</code></td><td>Address of UniswapUtils (Uniswap helper) contract.</td></tr>
<tr><td><code>_nfpmUtils</code></td><td><code>address</code></td><td>Address of Uniswap INonfungiblePositionManagerUtils (NonfungiblePositionManager helper) contract.</td></tr>
</tbody></table>
</div>
<h3 id="createfarm-4"><a class="header" href="#createfarm-4">createFarm</a></h3>
<p>Deploys a new UniswapV3 farm.</p>
<p><em>The caller of this function should approve feeAmount to this contract before calling this function.</em></p>
<pre><code class="language-solidity">function createFarm(FarmData memory _data) external nonReentrant returns (address);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_data</code></td><td><code>FarmData</code></td><td>Data for deployment.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td>Address of the deployed farm.</td></tr>
</tbody></table>
</div>
<h2 id="structs-7"><a class="header" href="#structs-7">Structs</a></h2>
<h3 id="farmdata-4"><a class="header" href="#farmdata-4">FarmData</a></h3>
<pre><code class="language-solidity">struct FarmData {
    address farmAdmin;
    uint256 farmStartTime;
    uint256 cooldownPeriod;
    UniswapPoolData uniswapPoolData;
    RewardTokenData[] rewardData;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="univ3activeliquidityfarm"><a class="header" href="#univ3activeliquidityfarm">UniV3ActiveLiquidityFarm</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/uniswapV3/UniV3ActiveLiquidityFarm.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/e721-farms/uniswapV3/UniV3ActiveLiquidityFarm.sol//contracts/e721-farms/uniswapV3/UniV3Farm.sol/contract.UniV3Farm.html">UniV3Farm</a></p>
<p><strong>Author:</strong>
Sperax Foundation.</p>
<p>This contract inherits the UniV3Farm contract and implements the reward distribution only for active liquidity.</p>
<h2 id="state-variables-9"><a class="header" href="#state-variables-9">State Variables</a></h2>
<h3 id="lastsecondsinside"><a class="header" href="#lastsecondsinside">lastSecondsInside</a></h3>
<pre><code class="language-solidity">uint32 public lastSecondsInside;
</code></pre>
<h2 id="functions-35"><a class="header" href="#functions-35">Functions</a></h2>
<h3 id="isfarmactive"><a class="header" href="#isfarmactive">isFarmActive</a></h3>
<p>Returns if farm is active.
Farm is active if it is not paused, not closed, and liquidity is active.</p>
<p><em>This function checks if current tick is within this farm's tick range.</em></p>
<pre><code class="language-solidity">function isFarmActive() public view override returns (bool);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>bool True if farm is active.</td></tr>
</tbody></table>
</div>
<h3 id="_updatelastrewardaccrualtime"><a class="header" href="#_updatelastrewardaccrualtime">_updateLastRewardAccrualTime</a></h3>
<p>Update the last reward accrual time.</p>
<p><em>This function is overridden from Farm to incorporate reward distribution only for active liquidity.</em></p>
<pre><code class="language-solidity">function _updateLastRewardAccrualTime() internal override;
</code></pre>
<h3 id="_getrewardaccrualtimeelapsed"><a class="header" href="#_getrewardaccrualtimeelapsed">_getRewardAccrualTimeElapsed</a></h3>
<p>Get the time elapsed since the last reward accrual.</p>
<p><em>This function is overridden from Farm to incorporate reward distribution only for active liquidity.</em></p>
<pre><code class="language-solidity">function _getRewardAccrualTimeElapsed() internal view override returns (uint256);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The time elapsed since the last reward accrual.</td></tr>
</tbody></table>
</div>
<h3 id="_isliquidityactive"><a class="header" href="#_isliquidityactive">_isLiquidityActive</a></h3>
<p>Function to check if the farm's liquidity is active.</p>
<pre><code class="language-solidity">function _isLiquidityActive() internal view returns (bool);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>Boolean True if liquidity is active otherwise False.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="uniswappooldata"><a class="header" href="#uniswappooldata">UniswapPoolData</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/uniswapV3/UniV3Farm.sol">Git Source</a></p>
<pre><code class="language-solidity">struct UniswapPoolData {
    address tokenA;
    address tokenB;
    uint24 feeTier;
    int24 tickLowerAllowed;
    int24 tickUpperAllowed;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="initializeinput-1"><a class="header" href="#initializeinput-1">InitializeInput</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/uniswapV3/UniV3Farm.sol">Git Source</a></p>
<pre><code class="language-solidity">struct InitializeInput {
    string farmId;
    uint256 farmStartTime;
    uint256 cooldownPeriod;
    address farmRegistry;
    UniswapPoolData uniswapPoolData;
    RewardTokenData[] rwdTokenData;
    address uniV3Factory;
    address nftContract;
    address uniswapUtils;
    address nfpmUtils;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="univ3farm"><a class="header" href="#univ3farm">UniV3Farm</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/uniswapV3/UniV3Farm.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/e721-farms/uniswapV3/UniV3Farm.sol//contracts/e721-farms/E721Farm.sol/abstract.E721Farm.html">E721Farm</a>, <a href="contracts/e721-farms/uniswapV3/UniV3Farm.sol//contracts/features/OperableDeposit.sol/abstract.OperableDeposit.html">OperableDeposit</a>, <a href="contracts/e721-farms/uniswapV3/UniV3Farm.sol//contracts/features/ExpirableFarm.sol/abstract.ExpirableFarm.html">ExpirableFarm</a>, <a href="contracts/e721-farms/uniswapV3/UniV3Farm.sol//contracts/features/ClaimableFee.sol/abstract.ClaimableFee.html">ClaimableFee</a></p>
<p><strong>Author:</strong>
Sperax Foundation.</p>
<p>This contract is the implementation of the Uniswap V3 farm.</p>
<h2 id="state-variables-10"><a class="header" href="#state-variables-10">State Variables</a></h2>
<h3 id="ticklowerallowed-1"><a class="header" href="#ticklowerallowed-1">tickLowerAllowed</a></h3>
<pre><code class="language-solidity">int24 public tickLowerAllowed;
</code></pre>
<h3 id="tickupperallowed-1"><a class="header" href="#tickupperallowed-1">tickUpperAllowed</a></h3>
<pre><code class="language-solidity">int24 public tickUpperAllowed;
</code></pre>
<h3 id="uniswappool"><a class="header" href="#uniswappool">uniswapPool</a></h3>
<pre><code class="language-solidity">address public uniswapPool;
</code></pre>
<h3 id="univ3factory"><a class="header" href="#univ3factory">uniV3Factory</a></h3>
<pre><code class="language-solidity">address public uniV3Factory;
</code></pre>
<h3 id="uniswaputils"><a class="header" href="#uniswaputils">uniswapUtils</a></h3>
<pre><code class="language-solidity">address public uniswapUtils;
</code></pre>
<h3 id="nfpmutils-1"><a class="header" href="#nfpmutils-1">nfpmUtils</a></h3>
<pre><code class="language-solidity">address public nfpmUtils;
</code></pre>
<h3 id="min_tick-1"><a class="header" href="#min_tick-1">MIN_TICK</a></h3>
<pre><code class="language-solidity">int256 internal constant MIN_TICK = -887272;
</code></pre>
<h3 id="max_tick-1"><a class="header" href="#max_tick-1">MAX_TICK</a></h3>
<pre><code class="language-solidity">int256 internal constant MAX_TICK = 887272;
</code></pre>
<h2 id="functions-36"><a class="header" href="#functions-36">Functions</a></h2>
<h3 id="initialize-4"><a class="header" href="#initialize-4">initialize</a></h3>
<p>Initializer function of this farm.</p>
<pre><code class="language-solidity">function initialize(InitializeInput calldata _input) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_input</code></td><td><code>InitializeInput</code></td><td>A struct having all the input params.</td></tr>
</tbody></table>
</div>
<h3 id="increasedeposit-3"><a class="header" href="#increasedeposit-3">increaseDeposit</a></h3>
<p>Allow user to increase liquidity for a deposit.</p>
<pre><code class="language-solidity">function increaseDeposit(uint256 _depositId, uint256[2] calldata _amounts, uint256[2] calldata _minAmounts)
    external
    nonReentrant;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>The id of the deposit to be increased.</td></tr>
<tr><td><code>_amounts</code></td><td><code>uint256[2]</code></td><td>Desired amount of tokens to be increased.</td></tr>
<tr><td><code>_minAmounts</code></td><td><code>uint256[2]</code></td><td>Minimum amount of tokens to be added as liquidity.</td></tr>
</tbody></table>
</div>
<h3 id="decreasedeposit-3"><a class="header" href="#decreasedeposit-3">decreaseDeposit</a></h3>
<p>Withdraw liquidity partially from an existing deposit.</p>
<pre><code class="language-solidity">function decreaseDeposit(uint256 _depositId, uint128 _liquidityToWithdraw, uint256[2] calldata _minAmounts)
    external
    nonReentrant;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>Deposit index for the user.</td></tr>
<tr><td><code>_liquidityToWithdraw</code></td><td><code>uint128</code></td><td>Amount to be withdrawn.</td></tr>
<tr><td><code>_minAmounts</code></td><td><code>uint256[2]</code></td><td>Minimum amount of tokens to be received.</td></tr>
</tbody></table>
</div>
<h3 id="gettokenamounts-4"><a class="header" href="#gettokenamounts-4">getTokenAmounts</a></h3>
<p>Function to be called by Demeter Rewarder to get tokens and amounts associated with the farm's liquidity.</p>
<pre><code class="language-solidity">function getTokenAmounts() external view override returns (address[] memory, uint256[] memory);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address[]</code></td><td>tokens An array of token addresses.</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256[]</code></td><td>amounts An array of token amounts.</td></tr>
</tbody></table>
</div>
<h3 id="updatefarmstarttime-3"><a class="header" href="#updatefarmstarttime-3">updateFarmStartTime</a></h3>
<p>Update the farm start time.</p>
<p><em>Calls ExpirableFarm's updateFarmStartTime function.</em></p>
<pre><code class="language-solidity">function updateFarmStartTime(uint256 _newStartTime) public override(Farm, ExpirableFarm);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_newStartTime</code></td><td><code>uint256</code></td><td>The new farm start time.</td></tr>
</tbody></table>
</div>
<h3 id="isfarmopen-3"><a class="header" href="#isfarmopen-3">isFarmOpen</a></h3>
<p>Returns if farm is open.
Farm is open if it is not closed.</p>
<p><em>Calls ExpirableFarm's isOpenFarm function.</em></p>
<pre><code class="language-solidity">function isFarmOpen() public view override(Farm, ExpirableFarm) returns (bool);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>bool True if farm is open.</td></tr>
</tbody></table>
</div>
<h3 id="_claimpoolfee-1"><a class="header" href="#_claimpoolfee-1">_claimPoolFee</a></h3>
<p>Claim pool fee implementation from <code>ClaimableFee</code> feature.</p>
<pre><code class="language-solidity">function _claimPoolFee(uint256 _depositId)
    internal
    override
    returns (uint256 tokenId, uint256 amt0Recv, uint256 amt1Recv);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>Deposit ID of the deposit in the farm.</td></tr>
</tbody></table>
</div>
<h3 id="_getliquidity-2"><a class="header" href="#_getliquidity-2">_getLiquidity</a></h3>
<p>Validate the position for the pool and get Liquidity.</p>
<p><em>The position must adhere to the price ranges.</em></p>
<p><em>Only allow specific pool token to be staked.</em></p>
<pre><code class="language-solidity">function _getLiquidity(uint256 _tokenId) internal view override returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_tokenId</code></td><td><code>uint256</code></td><td>The tokenId of the position.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>liquidity Liquidity in the position.</td></tr>
</tbody></table>
</div>
<h3 id="_validatetickrange-1"><a class="header" href="#_validatetickrange-1">_validateTickRange</a></h3>
<p>Validate the ticks (upper and lower).</p>
<p><em>Get the info of the required token</em></p>
<p><em>Check if the token belongs to correct pool.</em></p>
<p><em>Check if the token adheres to the tick range.</em></p>
<p><em>The ticks must be within the max range and must be multiple of tickSpacing.</em></p>
<pre><code class="language-solidity">function _validateTickRange(int24 _tickLower, int24 _tickUpper) private view;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_tickLower</code></td><td><code>int24</code></td><td>The lower tick of the range.</td></tr>
<tr><td><code>_tickUpper</code></td><td><code>int24</code></td><td>The upper tick of the range.</td></tr>
</tbody></table>
</div>
<h2 id="errors-4"><a class="header" href="#errors-4">Errors</a></h2>
<h3 id="invaliduniswappoolconfig"><a class="header" href="#invaliduniswappoolconfig">InvalidUniswapPoolConfig</a></h3>
<pre><code class="language-solidity">error InvalidUniswapPoolConfig();
</code></pre>
<h3 id="incorrectpooltoken-1"><a class="header" href="#incorrectpooltoken-1">IncorrectPoolToken</a></h3>
<pre><code class="language-solidity">error IncorrectPoolToken();
</code></pre>
<h3 id="incorrecttickrange-1"><a class="header" href="#incorrecttickrange-1">IncorrectTickRange</a></h3>
<pre><code class="language-solidity">error IncorrectTickRange();
</code></pre>
<h3 id="invalidtickrange-1"><a class="header" href="#invalidtickrange-1">InvalidTickRange</a></h3>
<pre><code class="language-solidity">error InvalidTickRange();
</code></pre>
<h3 id="invalidamount-3"><a class="header" href="#invalidamount-3">InvalidAmount</a></h3>
<pre><code class="language-solidity">error InvalidAmount();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="univ3farmdeployer"><a class="header" href="#univ3farmdeployer">UniV3FarmDeployer</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/uniswapV3/UniV3FarmDeployer.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/e721-farms/uniswapV3/UniV3FarmDeployer.sol//contracts/FarmDeployer.sol/abstract.FarmDeployer.html">FarmDeployer</a></p>
<p><strong>Author:</strong>
Sperax Foundation.</p>
<p>This contract allows anyone to calculate fees, pay fees and create farms.</p>
<h2 id="state-variables-11"><a class="header" href="#state-variables-11">State Variables</a></h2>
<h3 id="uni_v3_factory-1"><a class="header" href="#uni_v3_factory-1">UNI_V3_FACTORY</a></h3>
<pre><code class="language-solidity">address public immutable UNI_V3_FACTORY;
</code></pre>
<h3 id="nfpm-2"><a class="header" href="#nfpm-2">NFPM</a></h3>
<pre><code class="language-solidity">address public immutable NFPM;
</code></pre>
<h3 id="uniswap_utils-1"><a class="header" href="#uniswap_utils-1">UNISWAP_UTILS</a></h3>
<pre><code class="language-solidity">address public immutable UNISWAP_UTILS;
</code></pre>
<h3 id="nfpm_utils-1"><a class="header" href="#nfpm_utils-1">NFPM_UTILS</a></h3>
<pre><code class="language-solidity">address public immutable NFPM_UTILS;
</code></pre>
<h2 id="functions-37"><a class="header" href="#functions-37">Functions</a></h2>
<h3 id="constructor-6"><a class="header" href="#constructor-6">constructor</a></h3>
<p>Constructor of the contract.</p>
<pre><code class="language-solidity">constructor(
    address _farmRegistry,
    string memory _farmId,
    address _uniV3Factory,
    address _nfpm,
    address _uniswapUtils,
    address _nfpmUtils
) FarmDeployer(_farmRegistry, _farmId);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farmRegistry</code></td><td><code>address</code></td><td>Address of the Demeter Farm Registry.</td></tr>
<tr><td><code>_farmId</code></td><td><code>string</code></td><td>Id of the farm.</td></tr>
<tr><td><code>_uniV3Factory</code></td><td><code>address</code></td><td>Address of UniswapV3 factory.</td></tr>
<tr><td><code>_nfpm</code></td><td><code>address</code></td><td>Address of Uniswap NonfungiblePositionManager contract.</td></tr>
<tr><td><code>_uniswapUtils</code></td><td><code>address</code></td><td>Address of UniswapUtils (Uniswap helper) contract.</td></tr>
<tr><td><code>_nfpmUtils</code></td><td><code>address</code></td><td>Address of Uniswap INonfungiblePositionManagerUtils (NonfungiblePositionManager helper) contract.</td></tr>
</tbody></table>
</div>
<h3 id="createfarm-5"><a class="header" href="#createfarm-5">createFarm</a></h3>
<p>Deploys a new UniswapV3 farm.</p>
<p><em>The caller of this function should approve feeAmount to this contract before calling this function.</em></p>
<pre><code class="language-solidity">function createFarm(FarmData memory _data) external nonReentrant returns (address);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_data</code></td><td><code>FarmData</code></td><td>Data for deployment.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td>Address of the deployed farm.</td></tr>
</tbody></table>
</div>
<h2 id="structs-8"><a class="header" href="#structs-8">Structs</a></h2>
<h3 id="farmdata-5"><a class="header" href="#farmdata-5">FarmData</a></h3>
<pre><code class="language-solidity">struct FarmData {
    address farmAdmin;
    uint256 farmStartTime;
    uint256 cooldownPeriod;
    UniswapPoolData uniswapPoolData;
    RewardTokenData[] rewardData;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="e721farm"><a class="header" href="#e721farm">E721Farm</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/e721-farms/E721Farm.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/e721-farms/E721Farm.sol//contracts/Farm.sol/abstract.Farm.html">Farm</a>, IERC721Receiver</p>
<p><strong>Author:</strong>
Sperax Foundation.</p>
<p>This contract contains the core logic for E721 farms.</p>
<h2 id="state-variables-12"><a class="header" href="#state-variables-12">State Variables</a></h2>
<h3 id="nftcontract"><a class="header" href="#nftcontract">nftContract</a></h3>
<pre><code class="language-solidity">address public nftContract;
</code></pre>
<h3 id="deposittotokenid"><a class="header" href="#deposittotokenid">depositToTokenId</a></h3>
<pre><code class="language-solidity">mapping(uint256 =&gt; uint256) public depositToTokenId;
</code></pre>
<h2 id="functions-38"><a class="header" href="#functions-38">Functions</a></h2>
<h3 id="onerc721received"><a class="header" href="#onerc721received">onERC721Received</a></h3>
<p>Function is called when user transfers the NFT to this farm.</p>
<pre><code class="language-solidity">function onERC721Received(address, address _from, uint256 _tokenId, bytes calldata _data)
    external
    override
    returns (bytes4);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td></td></tr>
<tr><td><code>_from</code></td><td><code>address</code></td><td>The address of the owner.</td></tr>
<tr><td><code>_tokenId</code></td><td><code>uint256</code></td><td>NFT Id generated by other protocol (e.g. Camelot or Uniswap).</td></tr>
<tr><td><code>_data</code></td><td><code>bytes</code></td><td>The data should be the lockup flag (bool).</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes4</code></td><td>bytes4 The onERC721Received selector.</td></tr>
</tbody></table>
</div>
<h3 id="withdraw-1"><a class="header" href="#withdraw-1">withdraw</a></h3>
<p>Function to withdraw a deposit from the farm.</p>
<pre><code class="language-solidity">function withdraw(uint256 _depositId) external override nonReentrant;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>The id of the deposit to be withdrawn.</td></tr>
</tbody></table>
</div>
<h3 id="_getliquidity-3"><a class="header" href="#_getliquidity-3">_getLiquidity</a></h3>
<p>Function to get the liquidity. Must be defined by the farm.</p>
<p><em>This function should be overridden to add the respective logic.</em></p>
<pre><code class="language-solidity">function _getLiquidity(uint256 _tokenId) internal view virtual returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_tokenId</code></td><td><code>uint256</code></td><td>The nft tokenId.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The liquidity of the nft position.</td></tr>
</tbody></table>
</div>
<h2 id="errors-5"><a class="header" href="#errors-5">Errors</a></h2>
<h3 id="unauthorisednftcontract"><a class="header" href="#unauthorisednftcontract">UnauthorisedNFTContract</a></h3>
<pre><code class="language-solidity">error UnauthorisedNFTContract();
</code></pre>
<h3 id="nodata"><a class="header" href="#nodata">NoData</a></h3>
<pre><code class="language-solidity">error NoData();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-13"><a class="header" href="#contents-13">Contents</a></h1>
<ul>
<li><a href="contracts/features/ClaimableFee.sol/abstract.ClaimableFee.html">ClaimableFee</a></li>
<li><a href="contracts/features/ExpirableFarm.sol/abstract.ExpirableFarm.html">ExpirableFarm</a></li>
<li><a href="contracts/features/OperableDeposit.sol/abstract.OperableDeposit.html">OperableDeposit</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="claimablefee"><a class="header" href="#claimablefee">ClaimableFee</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/features/ClaimableFee.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/features/ClaimableFee.sol//contracts/Farm.sol/abstract.Farm.html">Farm</a></p>
<p><strong>Author:</strong>
Sperax Foundation.</p>
<p>Farms build for pairs/ pools in which fee can be claimed can extend and override _claimPoolFee function of this contract.</p>
<h2 id="functions-39"><a class="header" href="#functions-39">Functions</a></h2>
<h3 id="claimpoolfee"><a class="header" href="#claimpoolfee">claimPoolFee</a></h3>
<p>A function to claim the pool fee earned by lp.</p>
<p><em>Only the deposit owner can call this function.</em></p>
<pre><code class="language-solidity">function claimPoolFee(uint256 _depositId) external nonReentrant;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>ID of the deposit.</td></tr>
</tbody></table>
</div>
<h3 id="_claimpoolfee-2"><a class="header" href="#_claimpoolfee-2">_claimPoolFee</a></h3>
<p>Claim pool fee internal logic to be implemented by child farm contract.</p>
<p><em>Just override this function and write the logic to claim fee, validation and other checks are handled in <code>claimPoolFee</code>.</em></p>
<pre><code class="language-solidity">function _claimPoolFee(uint256 _depositId)
    internal
    virtual
    returns (uint256 tokenId, uint256 amt0Recv, uint256 amt1Recv);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>Deposit ID of the deposit in the farm.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>tokenId</code></td><td><code>uint256</code></td><td>Token ID of the deposit for E721 farms, for other farms return depositId.</td></tr>
<tr><td><code>amt0Recv</code></td><td><code>uint256</code></td><td>Amount 0 received as fee.</td></tr>
<tr><td><code>amt1Recv</code></td><td><code>uint256</code></td><td>Amount 1 received as fee.</td></tr>
</tbody></table>
</div>
<h2 id="events-3"><a class="header" href="#events-3">Events</a></h2>
<h3 id="poolfeecollected-1"><a class="header" href="#poolfeecollected-1">PoolFeeCollected</a></h3>
<pre><code class="language-solidity">event PoolFeeCollected(address indexed recipient, uint256 tokenId, uint256 amt0Recv, uint256 amt1Recv);
</code></pre>
<h2 id="errors-6"><a class="header" href="#errors-6">Errors</a></h2>
<h3 id="nofeetoclaim"><a class="header" href="#nofeetoclaim">NoFeeToClaim</a></h3>
<pre><code class="language-solidity">error NoFeeToClaim();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="expirablefarm"><a class="header" href="#expirablefarm">ExpirableFarm</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/features/ExpirableFarm.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/features/ExpirableFarm.sol//contracts/Farm.sol/abstract.Farm.html">Farm</a></p>
<p><strong>Author:</strong>
Sperax Foundation.</p>
<p>This contract helps in creating farms with expiry feature.</p>
<h2 id="state-variables-13"><a class="header" href="#state-variables-13">State Variables</a></h2>
<h3 id="min_extension"><a class="header" href="#min_extension">MIN_EXTENSION</a></h3>
<pre><code class="language-solidity">uint256 public constant MIN_EXTENSION = 100;
</code></pre>
<h3 id="max_extension"><a class="header" href="#max_extension">MAX_EXTENSION</a></h3>
<pre><code class="language-solidity">uint256 public constant MAX_EXTENSION = 300;
</code></pre>
<h3 id="farmendtime"><a class="header" href="#farmendtime">farmEndTime</a></h3>
<pre><code class="language-solidity">uint256 public farmEndTime;
</code></pre>
<h3 id="farmregistry"><a class="header" href="#farmregistry">farmRegistry</a></h3>
<pre><code class="language-solidity">address public farmRegistry;
</code></pre>
<h2 id="functions-40"><a class="header" href="#functions-40">Functions</a></h2>
<h3 id="extendfarmduration"><a class="header" href="#extendfarmduration">extendFarmDuration</a></h3>
<p>Update the farm end time.</p>
<p><em>Can be updated only before the farm expired or closed.
Extension should be incremented in multiples of 1 USDs/day with minimum of 100 days at a time and a maximum of 300 days.
Extension is possible only after farm started.</em></p>
<pre><code class="language-solidity">function extendFarmDuration(uint256 _extensionDays) external onlyOwner nonReentrant;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_extensionDays</code></td><td><code>uint256</code></td><td>The number of days to extend the farm. Example: 150 means 150 days.</td></tr>
</tbody></table>
</div>
<h3 id="updatefarmstarttime-4"><a class="header" href="#updatefarmstarttime-4">updateFarmStartTime</a></h3>
<p>Update the farm start time.</p>
<p><em>Can be updated only before the farm start.
New start time should be in future.
Adjusts the farm end time accordingly.</em></p>
<pre><code class="language-solidity">function updateFarmStartTime(uint256 _newStartTime) public virtual override;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_newStartTime</code></td><td><code>uint256</code></td><td>The new farm start time.</td></tr>
</tbody></table>
</div>
<h3 id="isfarmopen-4"><a class="header" href="#isfarmopen-4">isFarmOpen</a></h3>
<p>Returns bool status if farm is open.
Farm is open if it is not closed and not expired.</p>
<pre><code class="language-solidity">function isFarmOpen() public view virtual override returns (bool);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>bool True if farm is open.</td></tr>
</tbody></table>
</div>
<h3 id="_setupfarmexpiry"><a class="header" href="#_setupfarmexpiry">_setupFarmExpiry</a></h3>
<p>Setup the farm data for farm expiry.</p>
<pre><code class="language-solidity">function _setupFarmExpiry(uint256 _farmStartTime, address _farmRegistry) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farmStartTime</code></td><td><code>uint256</code></td><td>Start time of the farm.</td></tr>
<tr><td><code>_farmRegistry</code></td><td><code>address</code></td><td>Address of the farm registry.</td></tr>
</tbody></table>
</div>
<h3 id="_collectextensionfee"><a class="header" href="#_collectextensionfee">_collectExtensionFee</a></h3>
<p>Collects farm extension fee and transfers it to feeReceiver.</p>
<p><em>Function fetches all the fee params from farmRegistry.</em></p>
<pre><code class="language-solidity">function _collectExtensionFee(uint256 _extensionDays) private;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_extensionDays</code></td><td><code>uint256</code></td><td>The number of days to extend the farm. Example: 150 means 150 days.</td></tr>
</tbody></table>
</div>
<h2 id="events-4"><a class="header" href="#events-4">Events</a></h2>
<h3 id="farmendtimeupdated"><a class="header" href="#farmendtimeupdated">FarmEndTimeUpdated</a></h3>
<pre><code class="language-solidity">event FarmEndTimeUpdated(uint256 newEndTime);
</code></pre>
<h3 id="extensionfeecollected"><a class="header" href="#extensionfeecollected">ExtensionFeeCollected</a></h3>
<pre><code class="language-solidity">event ExtensionFeeCollected(address indexed token, uint256 extensionFee);
</code></pre>
<h2 id="errors-7"><a class="header" href="#errors-7">Errors</a></h2>
<h3 id="invalidextension"><a class="header" href="#invalidextension">InvalidExtension</a></h3>
<pre><code class="language-solidity">error InvalidExtension();
</code></pre>
<h3 id="durationexceeded"><a class="header" href="#durationexceeded">DurationExceeded</a></h3>
<pre><code class="language-solidity">error DurationExceeded();
</code></pre>
<h3 id="farmnotyetstarted"><a class="header" href="#farmnotyetstarted">FarmNotYetStarted</a></h3>
<pre><code class="language-solidity">error FarmNotYetStarted();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="operabledeposit"><a class="header" href="#operabledeposit">OperableDeposit</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/features/OperableDeposit.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/features/OperableDeposit.sol//contracts/Farm.sol/abstract.Farm.html">Farm</a></p>
<p><strong>Author:</strong>
Sperax Foundation.</p>
<p>This contract helps in creating farms with increase/decrease deposit functionality.</p>
<h2 id="functions-41"><a class="header" href="#functions-41">Functions</a></h2>
<h3 id="_updatesubscriptionforincrease"><a class="header" href="#_updatesubscriptionforincrease">_updateSubscriptionForIncrease</a></h3>
<p>Update subscription data of a deposit for increase in liquidity.</p>
<pre><code class="language-solidity">function _updateSubscriptionForIncrease(uint256 _depositId, uint256 _amount) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>Unique deposit id for the deposit.</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>_amount to be increased.</td></tr>
</tbody></table>
</div>
<h3 id="_updatesubscriptionfordecrease"><a class="header" href="#_updatesubscriptionfordecrease">_updateSubscriptionForDecrease</a></h3>
<p>Update subscription data of a deposit after decrease in liquidity.</p>
<pre><code class="language-solidity">function _updateSubscriptionForDecrease(uint256 _depositId, uint256 _amount) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>Unique deposit id for the deposit</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>_amount to be decreased.</td></tr>
</tbody></table>
</div>
<h3 id="_increasedeposit"><a class="header" href="#_increasedeposit">_increaseDeposit</a></h3>
<p>Common logic for increasing a deposit.</p>
<pre><code class="language-solidity">function _increaseDeposit(uint256 _depositId, uint256 _amount) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>Unique deposit id for the deposit</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>_amount to be decreased.</td></tr>
</tbody></table>
</div>
<h3 id="_decreasedeposit"><a class="header" href="#_decreasedeposit">_decreaseDeposit</a></h3>
<p>Common logic for decreasing a deposit.</p>
<pre><code class="language-solidity">function _decreaseDeposit(uint256 _depositId, uint256 _amount) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>Unique deposit id for the deposit</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>_amount to be decreased.</td></tr>
</tbody></table>
</div>
<h2 id="events-5"><a class="header" href="#events-5">Events</a></h2>
<h3 id="depositincreased"><a class="header" href="#depositincreased">DepositIncreased</a></h3>
<pre><code class="language-solidity">event DepositIncreased(uint256 indexed depositId, uint256 liquidity);
</code></pre>
<h3 id="depositdecreased"><a class="header" href="#depositdecreased">DepositDecreased</a></h3>
<pre><code class="language-solidity">event DepositDecreased(uint256 indexed depositId, uint256 liquidity);
</code></pre>
<h2 id="errors-8"><a class="header" href="#errors-8">Errors</a></h2>
<h3 id="decreasedepositnotpermitted"><a class="header" href="#decreasedepositnotpermitted">DecreaseDepositNotPermitted</a></h3>
<pre><code class="language-solidity">error DecreaseDepositNotPermitted();
</code></pre>
<h3 id="insufficientliquidity"><a class="header" href="#insufficientliquidity">InsufficientLiquidity</a></h3>
<pre><code class="language-solidity">error InsufficientLiquidity();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-14"><a class="header" href="#contents-14">Contents</a></h1>
<ul>
<li><a href="contracts/interfaces/DataTypes.sol/struct.RewardTokenData.html">RewardTokenData</a></li>
<li><a href="contracts/interfaces/DataTypes.sol/struct.RewardFund.html">RewardFund</a></li>
<li><a href="contracts/interfaces/DataTypes.sol/struct.Subscription.html">Subscription</a></li>
<li><a href="contracts/interfaces/DataTypes.sol/struct.Deposit.html">Deposit</a></li>
<li><a href="contracts/interfaces/DataTypes.sol/struct.RewardData.html">RewardData</a></li>
<li><a href="contracts/interfaces/IFarm.sol/interface.IFarm.html">IFarm</a></li>
<li><a href="contracts/interfaces/IFarmRegistry.sol/interface.IFarmRegistry.html">IFarmRegistry</a></li>
<li><a href="contracts/interfaces/IOracle.sol/interface.IOracle.html">IOracle</a></li>
<li><a href="contracts/interfaces/IRewarder.sol/interface.IRewarder.html">IRewarder</a></li>
<li><a href="contracts/interfaces/IRewarderFactory.sol/interface.IRewarderFactory.html">IRewarderFactory</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rewardtokendata"><a class="header" href="#rewardtokendata">RewardTokenData</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/interfaces/DataTypes.sol">Git Source</a></p>
<pre><code class="language-solidity">struct RewardTokenData {
    address token;
    address tknManager;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rewardfund"><a class="header" href="#rewardfund">RewardFund</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/interfaces/DataTypes.sol">Git Source</a></p>
<pre><code class="language-solidity">struct RewardFund {
    uint256 totalLiquidity;
    uint256[] rewardsPerSec;
    uint256[] accRewardPerShare;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="subscription"><a class="header" href="#subscription">Subscription</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/interfaces/DataTypes.sol">Git Source</a></p>
<pre><code class="language-solidity">struct Subscription {
    uint8 fundId;
    uint256[] rewardDebt;
    uint256[] rewardClaimed;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="deposit-1"><a class="header" href="#deposit-1">Deposit</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/interfaces/DataTypes.sol">Git Source</a></p>
<pre><code class="language-solidity">struct Deposit {
    address depositor;
    uint256 liquidity;
    uint256 expiryDate;
    uint256 cooldownPeriod;
    uint256 depositTs;
    uint256[] totalRewardsClaimed;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rewarddata"><a class="header" href="#rewarddata">RewardData</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/interfaces/DataTypes.sol">Git Source</a></p>
<pre><code class="language-solidity">struct RewardData {
    address tknManager;
    uint8 id;
    uint256 accRewardBal;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ifarm"><a class="header" href="#ifarm">IFarm</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/interfaces/IFarm.sol">Git Source</a></p>
<h2 id="functions-42"><a class="header" href="#functions-42">Functions</a></h2>
<h3 id="withdraw-2"><a class="header" href="#withdraw-2">withdraw</a></h3>
<p>Function to be called to withdraw deposit.</p>
<pre><code class="language-solidity">function withdraw(uint256 _depositId) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>The id of the deposit.</td></tr>
</tbody></table>
</div>
<h3 id="claimrewards"><a class="header" href="#claimrewards">claimRewards</a></h3>
<p>A function to be called by the depositor to claim rewards.</p>
<pre><code class="language-solidity">function claimRewards(uint256 _depositId) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>The id of the deposit.</td></tr>
</tbody></table>
</div>
<h3 id="initiatecooldown"><a class="header" href="#initiatecooldown">initiateCooldown</a></h3>
<p>Function to be called to initiate cooldown for a staked deposit.</p>
<p><em>_depositId is corresponding to the user's deposit.</em></p>
<pre><code class="language-solidity">function initiateCooldown(uint256 _depositId) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>The id of the deposit to be locked.</td></tr>
</tbody></table>
</div>
<h3 id="addrewards"><a class="header" href="#addrewards">addRewards</a></h3>
<p>Add rewards to the farm.</p>
<pre><code class="language-solidity">function addRewards(address _rwdToken, uint256 _amount) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_rwdToken</code></td><td><code>address</code></td><td>The reward token's address.</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>The amount of reward tokens to add.</td></tr>
</tbody></table>
</div>
<h3 id="updatecooldownperiod"><a class="header" href="#updatecooldownperiod">updateCooldownPeriod</a></h3>
<p>Update the cooldown period.</p>
<pre><code class="language-solidity">function updateCooldownPeriod(uint256 _newCooldownPeriod) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_newCooldownPeriod</code></td><td><code>uint256</code></td><td>The new cooldown period (in days). E.g: 7 means 7 days.</td></tr>
</tbody></table>
</div>
<h3 id="farmpauseswitch"><a class="header" href="#farmpauseswitch">farmPauseSwitch</a></h3>
<p>Pause / UnPause the farm.</p>
<pre><code class="language-solidity">function farmPauseSwitch(bool _isPaused) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_isPaused</code></td><td><code>bool</code></td><td>Desired state of the farm (true to pause the farm).</td></tr>
</tbody></table>
</div>
<h3 id="closefarm"><a class="header" href="#closefarm">closeFarm</a></h3>
<p>A function to explicitly close the farm.</p>
<p><em>Recovers remaining non accrued rewards.</em></p>
<p><em>Sets reward rate to 0 and shuts down the farm completely.</em></p>
<pre><code class="language-solidity">function closeFarm() external;
</code></pre>
<h3 id="recovererc20"><a class="header" href="#recovererc20">recoverERC20</a></h3>
<p>Recover erc20 tokens other than the reward tokens.</p>
<pre><code class="language-solidity">function recoverERC20(address _token) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_token</code></td><td><code>address</code></td><td>Address of token to be recovered.</td></tr>
</tbody></table>
</div>
<h3 id="recoverrewardfunds"><a class="header" href="#recoverrewardfunds">recoverRewardFunds</a></h3>
<p>Get the remaining reward balance out of the farm.</p>
<p><em>Function recovers minOf(_amount, rewardsLeft).</em></p>
<pre><code class="language-solidity">function recoverRewardFunds(address _rwdToken, uint256 _amount) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_rwdToken</code></td><td><code>address</code></td><td>The reward token's address.</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>The amount of the reward tokens to be withdrawn.</td></tr>
</tbody></table>
</div>
<h3 id="setrewardrate"><a class="header" href="#setrewardrate">setRewardRate</a></h3>
<p>Function to update reward params for a fund.</p>
<pre><code class="language-solidity">function setRewardRate(address _rwdToken, uint128[] memory _newRewardRates) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_rwdToken</code></td><td><code>address</code></td><td>The reward token's address.</td></tr>
<tr><td><code>_newRewardRates</code></td><td><code>uint128[]</code></td><td>The new reward rate for the fund (includes the precision).</td></tr>
</tbody></table>
</div>
<h3 id="updaterewarddata"><a class="header" href="#updaterewarddata">updateRewardData</a></h3>
<p>Transfer the tokenManagerRole to other user.</p>
<p><em>Only the existing tokenManager for a reward can call this function.</em></p>
<pre><code class="language-solidity">function updateRewardData(address _rwdToken, address _newTknManager) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_rwdToken</code></td><td><code>address</code></td><td>The reward token's address.</td></tr>
<tr><td><code>_newTknManager</code></td><td><code>address</code></td><td>Address of the new token manager.</td></tr>
</tbody></table>
</div>
<h3 id="updatefarmrewarddata"><a class="header" href="#updatefarmrewarddata">updateFarmRewardData</a></h3>
<p>Function to update the FarmRewardData for all funds.</p>
<pre><code class="language-solidity">function updateFarmRewardData() external;
</code></pre>
<h3 id="claimrewardsto"><a class="header" href="#claimrewardsto">claimRewardsTo</a></h3>
<p>Claim rewards and send it to another account.</p>
<p><em>Only the depositor can call this function.</em></p>
<pre><code class="language-solidity">function claimRewardsTo(address _account, uint256 _depositId) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_account</code></td><td><code>address</code></td><td>To receive the rewards.</td></tr>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>The id of the deposit.</td></tr>
</tbody></table>
</div>
<h3 id="updatefarmstarttime-5"><a class="header" href="#updatefarmstarttime-5">updateFarmStartTime</a></h3>
<p>Update the farm start time.</p>
<p><em>Can be updated only before the farm start.
New start time should be in future.</em></p>
<pre><code class="language-solidity">function updateFarmStartTime(uint256 _newStartTime) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_newStartTime</code></td><td><code>uint256</code></td><td>The new farm start time.</td></tr>
</tbody></table>
</div>
<h3 id="computerewards"><a class="header" href="#computerewards">computeRewards</a></h3>
<p>Function to compute the total accrued rewards for a deposit for each subscription.</p>
<pre><code class="language-solidity">function computeRewards(address _account, uint256 _depositId) external view returns (uint256[][] memory rewards);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_account</code></td><td><code>address</code></td><td>The user's address.</td></tr>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>The id of the deposit.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>rewards</code></td><td><code>uint256[][]</code></td><td>The total accrued rewards for the deposit for each subscription (uint256[][]).</td></tr>
</tbody></table>
</div>
<h3 id="getdepositinfo"><a class="header" href="#getdepositinfo">getDepositInfo</a></h3>
<p>Get deposit info for a deposit id.</p>
<pre><code class="language-solidity">function getDepositInfo(uint256 _depositId) external view returns (Deposit memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>The id of the deposit.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>Deposit</code></td><td>The deposit info (Deposit).</td></tr>
</tbody></table>
</div>
<h3 id="getnumsubscriptions"><a class="header" href="#getnumsubscriptions">getNumSubscriptions</a></h3>
<p>Get number of subscriptions for an account.</p>
<pre><code class="language-solidity">function getNumSubscriptions(uint256 _depositId) external view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>The deposit id.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The number of subscriptions for the deposit.</td></tr>
</tbody></table>
</div>
<h3 id="getsubscriptioninfo"><a class="header" href="#getsubscriptioninfo">getSubscriptionInfo</a></h3>
<p>Get subscription stats for a deposit.</p>
<pre><code class="language-solidity">function getSubscriptionInfo(uint256 _depositId, uint256 _subscriptionId) external view returns (Subscription memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>The deposit id.</td></tr>
<tr><td><code>_subscriptionId</code></td><td><code>uint256</code></td><td>The subscription's id.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>Subscription</code></td><td>The subscription info (Subscription).</td></tr>
</tbody></table>
</div>
<h3 id="getrewardrates"><a class="header" href="#getrewardrates">getRewardRates</a></h3>
<p>Get reward rates for a rewardToken.</p>
<pre><code class="language-solidity">function getRewardRates(address _rwdToken) external view returns (uint256[] memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_rwdToken</code></td><td><code>address</code></td><td>The reward token's address.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256[]</code></td><td>The reward rates for the reward token (uint256[]).</td></tr>
</tbody></table>
</div>
<h3 id="getrewardfundinfo"><a class="header" href="#getrewardfundinfo">getRewardFundInfo</a></h3>
<p>Get farm reward fund info.</p>
<pre><code class="language-solidity">function getRewardFundInfo(uint8 _fundId) external view returns (RewardFund memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_fundId</code></td><td><code>uint8</code></td><td>The fund's id.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>RewardFund</code></td><td>The reward fund info (RewardFund).</td></tr>
</tbody></table>
</div>
<h3 id="getrewardtokens"><a class="header" href="#getrewardtokens">getRewardTokens</a></h3>
<p>Function to get the reward tokens added in the farm.</p>
<pre><code class="language-solidity">function getRewardTokens() external view returns (address[] memory);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address[]</code></td><td>The reward tokens added in the farm.</td></tr>
</tbody></table>
</div>
<h3 id="gettokenamounts-5"><a class="header" href="#gettokenamounts-5">getTokenAmounts</a></h3>
<p>Function to be called by Demeter Rewarder to get tokens and amounts associated with the farm's liquidity.</p>
<p><em>This function should be overridden to add the respective logic.</em></p>
<pre><code class="language-solidity">function getTokenAmounts() external view returns (address[] memory, uint256[] memory);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address[]</code></td><td>Tokens associated with the farm's pool.</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256[]</code></td><td>Amounts associated with the farm's liquidity.</td></tr>
</tbody></table>
</div>
<h3 id="isfarmopen-5"><a class="header" href="#isfarmopen-5">isFarmOpen</a></h3>
<p>Returns if farm is open.
Farm is open if it is not closed.</p>
<p><em>This function can be overridden to add any new/additional logic.</em></p>
<pre><code class="language-solidity">function isFarmOpen() external view returns (bool);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>bool True if farm is open.</td></tr>
</tbody></table>
</div>
<h3 id="isfarmactive-1"><a class="header" href="#isfarmactive-1">isFarmActive</a></h3>
<p>Returns if farm is active.
Farm is active if it is not paused and not closed.</p>
<p><em>This function can be overridden to add any new/additional logic.</em></p>
<pre><code class="language-solidity">function isFarmActive() external view returns (bool);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>bool True if farm is active.</td></tr>
</tbody></table>
</div>
<h3 id="getrewardbalance"><a class="header" href="#getrewardbalance">getRewardBalance</a></h3>
<p>Get the reward balance for specified reward token.</p>
<p><em>This function calculates the available reward balance by considering the accrued rewards and the token supply.</em></p>
<pre><code class="language-solidity">function getRewardBalance(address _rwdToken) external view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_rwdToken</code></td><td><code>address</code></td><td>The address of the reward token.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The available reward balance for the specified reward token.</td></tr>
</tbody></table>
</div>
<h3 id="getrewardfunds"><a class="header" href="#getrewardfunds">getRewardFunds</a></h3>
<p>Get the reward fund details.</p>
<pre><code class="language-solidity">function getRewardFunds() external view returns (RewardFund[] memory);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>RewardFund[]</code></td><td>The available reward funds' details for all the reward funds.</td></tr>
</tbody></table>
</div>
<h3 id="getrewarddata"><a class="header" href="#getrewarddata">getRewardData</a></h3>
<p>Get the reward details for specified reward token.</p>
<pre><code class="language-solidity">function getRewardData(address _rwdToken) external view returns (RewardData memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_rwdToken</code></td><td><code>address</code></td><td>The address of the reward token.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>RewardData</code></td><td>The available reward details for the specified reward token.</td></tr>
</tbody></table>
</div>
<h3 id="common_fund_id"><a class="header" href="#common_fund_id">COMMON_FUND_ID</a></h3>
<pre><code class="language-solidity">function COMMON_FUND_ID() external view returns (uint8);
</code></pre>
<h3 id="lockup_fund_id"><a class="header" href="#lockup_fund_id">LOCKUP_FUND_ID</a></h3>
<pre><code class="language-solidity">function LOCKUP_FUND_ID() external view returns (uint8);
</code></pre>
<h3 id="precision"><a class="header" href="#precision">PRECISION</a></h3>
<pre><code class="language-solidity">function PRECISION() external view returns (uint256);
</code></pre>
<h3 id="max_cooldown_period"><a class="header" href="#max_cooldown_period">MAX_COOLDOWN_PERIOD</a></h3>
<pre><code class="language-solidity">function MAX_COOLDOWN_PERIOD() external view returns (uint256);
</code></pre>
<h3 id="max_num_rewards"><a class="header" href="#max_num_rewards">MAX_NUM_REWARDS</a></h3>
<pre><code class="language-solidity">function MAX_NUM_REWARDS() external view returns (uint256);
</code></pre>
<h3 id="farmid"><a class="header" href="#farmid">farmId</a></h3>
<pre><code class="language-solidity">function farmId() external view returns (string memory);
</code></pre>
<h3 id="cooldownperiod"><a class="header" href="#cooldownperiod">cooldownPeriod</a></h3>
<pre><code class="language-solidity">function cooldownPeriod() external view returns (uint256);
</code></pre>
<h3 id="lastfundupdatetime"><a class="header" href="#lastfundupdatetime">lastFundUpdateTime</a></h3>
<pre><code class="language-solidity">function lastFundUpdateTime() external view returns (uint256);
</code></pre>
<h3 id="farmstarttime"><a class="header" href="#farmstarttime">farmStartTime</a></h3>
<pre><code class="language-solidity">function farmStartTime() external view returns (uint256);
</code></pre>
<h3 id="totaldeposits"><a class="header" href="#totaldeposits">totalDeposits</a></h3>
<pre><code class="language-solidity">function totalDeposits() external view returns (uint256);
</code></pre>
<h2 id="events-6"><a class="header" href="#events-6">Events</a></h2>
<h3 id="deposited"><a class="header" href="#deposited">Deposited</a></h3>
<pre><code class="language-solidity">event Deposited(uint256 indexed depositId, address indexed account, bool locked, uint256 liquidity);
</code></pre>
<h3 id="cooldowninitiated"><a class="header" href="#cooldowninitiated">CooldownInitiated</a></h3>
<pre><code class="language-solidity">event CooldownInitiated(uint256 indexed depositId, uint256 expiryDate);
</code></pre>
<h3 id="depositwithdrawn"><a class="header" href="#depositwithdrawn">DepositWithdrawn</a></h3>
<pre><code class="language-solidity">event DepositWithdrawn(uint256 indexed depositId);
</code></pre>
<h3 id="rewardsclaimed"><a class="header" href="#rewardsclaimed">RewardsClaimed</a></h3>
<pre><code class="language-solidity">event RewardsClaimed(uint256 indexed depositId, uint256[][] rewardsForEachSubs);
</code></pre>
<h3 id="poolunsubscribed"><a class="header" href="#poolunsubscribed">PoolUnsubscribed</a></h3>
<pre><code class="language-solidity">event PoolUnsubscribed(uint256 indexed depositId, uint8 fundId, uint256[] totalRewardsClaimed);
</code></pre>
<h3 id="poolsubscribed"><a class="header" href="#poolsubscribed">PoolSubscribed</a></h3>
<pre><code class="language-solidity">event PoolSubscribed(uint256 indexed depositId, uint8 fundId);
</code></pre>
<h3 id="farmstarttimeupdated"><a class="header" href="#farmstarttimeupdated">FarmStartTimeUpdated</a></h3>
<pre><code class="language-solidity">event FarmStartTimeUpdated(uint256 newStartTime);
</code></pre>
<h3 id="cooldownperiodupdated"><a class="header" href="#cooldownperiodupdated">CooldownPeriodUpdated</a></h3>
<pre><code class="language-solidity">event CooldownPeriodUpdated(uint256 newCooldownPeriod);
</code></pre>
<h3 id="rewardrateupdated"><a class="header" href="#rewardrateupdated">RewardRateUpdated</a></h3>
<pre><code class="language-solidity">event RewardRateUpdated(address indexed rwdToken, uint128[] newRewardRate);
</code></pre>
<h3 id="rewardadded"><a class="header" href="#rewardadded">RewardAdded</a></h3>
<pre><code class="language-solidity">event RewardAdded(address indexed rwdToken, uint256 amount);
</code></pre>
<h3 id="farmclosed"><a class="header" href="#farmclosed">FarmClosed</a></h3>
<pre><code class="language-solidity">event FarmClosed();
</code></pre>
<h3 id="recoverederc20"><a class="header" href="#recoverederc20">RecoveredERC20</a></h3>
<pre><code class="language-solidity">event RecoveredERC20(address indexed token, uint256 amount);
</code></pre>
<h3 id="fundsrecovered"><a class="header" href="#fundsrecovered">FundsRecovered</a></h3>
<pre><code class="language-solidity">event FundsRecovered(address indexed account, address indexed rwdToken, uint256 amount);
</code></pre>
<h3 id="rewarddataupdated"><a class="header" href="#rewarddataupdated">RewardDataUpdated</a></h3>
<pre><code class="language-solidity">event RewardDataUpdated(address indexed rwdToken, address indexed newTokenManager);
</code></pre>
<h3 id="rewardtokenadded"><a class="header" href="#rewardtokenadded">RewardTokenAdded</a></h3>
<pre><code class="language-solidity">event RewardTokenAdded(address indexed rwdToken, address indexed rwdTokenManager);
</code></pre>
<h3 id="farmpaused"><a class="header" href="#farmpaused">FarmPaused</a></h3>
<pre><code class="language-solidity">event FarmPaused(bool paused);
</code></pre>
<h2 id="errors-9"><a class="header" href="#errors-9">Errors</a></h2>
<h3 id="invalidrewardtoken"><a class="header" href="#invalidrewardtoken">InvalidRewardToken</a></h3>
<pre><code class="language-solidity">error InvalidRewardToken();
</code></pre>
<h3 id="farmdoesnotsupportlockup"><a class="header" href="#farmdoesnotsupportlockup">FarmDoesNotSupportLockup</a></h3>
<pre><code class="language-solidity">error FarmDoesNotSupportLockup();
</code></pre>
<h3 id="farmalreadystarted"><a class="header" href="#farmalreadystarted">FarmAlreadyStarted</a></h3>
<pre><code class="language-solidity">error FarmAlreadyStarted();
</code></pre>
<h3 id="invalidtime"><a class="header" href="#invalidtime">InvalidTime</a></h3>
<pre><code class="language-solidity">error InvalidTime();
</code></pre>
<h3 id="farmalreadyinrequiredstate"><a class="header" href="#farmalreadyinrequiredstate">FarmAlreadyInRequiredState</a></h3>
<pre><code class="language-solidity">error FarmAlreadyInRequiredState();
</code></pre>
<h3 id="cannotwithdrawrewardtoken"><a class="header" href="#cannotwithdrawrewardtoken">CannotWithdrawRewardToken</a></h3>
<pre><code class="language-solidity">error CannotWithdrawRewardToken();
</code></pre>
<h3 id="cannotwithdrawzeroamount"><a class="header" href="#cannotwithdrawzeroamount">CannotWithdrawZeroAmount</a></h3>
<pre><code class="language-solidity">error CannotWithdrawZeroAmount();
</code></pre>
<h3 id="subscriptiondoesnotexist"><a class="header" href="#subscriptiondoesnotexist">SubscriptionDoesNotExist</a></h3>
<pre><code class="language-solidity">error SubscriptionDoesNotExist();
</code></pre>
<h3 id="rewardfunddoesnotexist"><a class="header" href="#rewardfunddoesnotexist">RewardFundDoesNotExist</a></h3>
<pre><code class="language-solidity">error RewardFundDoesNotExist();
</code></pre>
<h3 id="lockupfunctionalityisdisabled"><a class="header" href="#lockupfunctionalityisdisabled">LockupFunctionalityIsDisabled</a></h3>
<pre><code class="language-solidity">error LockupFunctionalityIsDisabled();
</code></pre>
<h3 id="noliquidityinposition"><a class="header" href="#noliquidityinposition">NoLiquidityInPosition</a></h3>
<pre><code class="language-solidity">error NoLiquidityInPosition();
</code></pre>
<h3 id="cannotinitiatecooldown"><a class="header" href="#cannotinitiatecooldown">CannotInitiateCooldown</a></h3>
<pre><code class="language-solidity">error CannotInitiateCooldown();
</code></pre>
<h3 id="pleaseinitiatecooldown"><a class="header" href="#pleaseinitiatecooldown">PleaseInitiateCooldown</a></h3>
<pre><code class="language-solidity">error PleaseInitiateCooldown();
</code></pre>
<h3 id="depositisincooldown"><a class="header" href="#depositisincooldown">DepositIsInCooldown</a></h3>
<pre><code class="language-solidity">error DepositIsInCooldown();
</code></pre>
<h3 id="invalidrewardrateslength"><a class="header" href="#invalidrewardrateslength">InvalidRewardRatesLength</a></h3>
<pre><code class="language-solidity">error InvalidRewardRatesLength();
</code></pre>
<h3 id="invalidfundid"><a class="header" href="#invalidfundid">InvalidFundId</a></h3>
<pre><code class="language-solidity">error InvalidFundId();
</code></pre>
<h3 id="invalidfarmstarttime"><a class="header" href="#invalidfarmstarttime">InvalidFarmStartTime</a></h3>
<pre><code class="language-solidity">error InvalidFarmStartTime();
</code></pre>
<h3 id="invalidrewarddata"><a class="header" href="#invalidrewarddata">InvalidRewardData</a></h3>
<pre><code class="language-solidity">error InvalidRewardData();
</code></pre>
<h3 id="rewardtokenalreadyadded"><a class="header" href="#rewardtokenalreadyadded">RewardTokenAlreadyAdded</a></h3>
<pre><code class="language-solidity">error RewardTokenAlreadyAdded();
</code></pre>
<h3 id="depositdoesnotexist"><a class="header" href="#depositdoesnotexist">DepositDoesNotExist</a></h3>
<pre><code class="language-solidity">error DepositDoesNotExist();
</code></pre>
<h3 id="farmisclosed"><a class="header" href="#farmisclosed">FarmIsClosed</a></h3>
<pre><code class="language-solidity">error FarmIsClosed();
</code></pre>
<h3 id="farmisinactive"><a class="header" href="#farmisinactive">FarmIsInactive</a></h3>
<pre><code class="language-solidity">error FarmIsInactive();
</code></pre>
<h3 id="notthetokenmanager"><a class="header" href="#notthetokenmanager">NotTheTokenManager</a></h3>
<pre><code class="language-solidity">error NotTheTokenManager();
</code></pre>
<h3 id="invalidaddress"><a class="header" href="#invalidaddress">InvalidAddress</a></h3>
<pre><code class="language-solidity">error InvalidAddress();
</code></pre>
<h3 id="zeroamount"><a class="header" href="#zeroamount">ZeroAmount</a></h3>
<pre><code class="language-solidity">error ZeroAmount();
</code></pre>
<h3 id="invalidcooldownperiod"><a class="header" href="#invalidcooldownperiod">InvalidCooldownPeriod</a></h3>
<pre><code class="language-solidity">error InvalidCooldownPeriod();
</code></pre>
<h3 id="withdrawtoosoon"><a class="header" href="#withdrawtoosoon">WithdrawTooSoon</a></h3>
<pre><code class="language-solidity">error WithdrawTooSoon();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ifarmregistry"><a class="header" href="#ifarmregistry">IFarmRegistry</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/interfaces/IFarmRegistry.sol">Git Source</a></p>
<h2 id="functions-43"><a class="header" href="#functions-43">Functions</a></h2>
<h3 id="initialize-5"><a class="header" href="#initialize-5">initialize</a></h3>
<p>constructor</p>
<pre><code class="language-solidity">function initialize(address _feeReceiver, address _feeToken, uint256 _feeAmount, uint256 _extensionFeePerDay)
    external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_feeReceiver</code></td><td><code>address</code></td><td>Receiver of the fees.</td></tr>
<tr><td><code>_feeToken</code></td><td><code>address</code></td><td>The fee token for farm creation.</td></tr>
<tr><td><code>_feeAmount</code></td><td><code>uint256</code></td><td>The fee amount to be paid by the creator.</td></tr>
<tr><td><code>_extensionFeePerDay</code></td><td><code>uint256</code></td><td>Extension fee per day.</td></tr>
</tbody></table>
</div>
<h3 id="registerfarm"><a class="header" href="#registerfarm">registerFarm</a></h3>
<p>Register a farm created by registered Deployer.</p>
<p><em>Only registered deployer can register a farm.</em></p>
<pre><code class="language-solidity">function registerFarm(address _farm, address _creator) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farm</code></td><td><code>address</code></td><td>Address of the created farm contract</td></tr>
<tr><td><code>_creator</code></td><td><code>address</code></td><td>Address of the farm creator.</td></tr>
</tbody></table>
</div>
<h3 id="registerfarmdeployer"><a class="header" href="#registerfarmdeployer">registerFarmDeployer</a></h3>
<p>Register a new farm deployer.</p>
<p><em>Only owner can call this function.</em></p>
<pre><code class="language-solidity">function registerFarmDeployer(address _deployer) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_deployer</code></td><td><code>address</code></td><td>Address of deployer to be registered.</td></tr>
</tbody></table>
</div>
<h3 id="removedeployer"><a class="header" href="#removedeployer">removeDeployer</a></h3>
<p>Remove an existing deployer from registry.</p>
<p><em>Only owner can call this function.</em></p>
<pre><code class="language-solidity">function removeDeployer(uint16 _id) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_id</code></td><td><code>uint16</code></td><td>ID of the deployer to be removed (0 index based).</td></tr>
</tbody></table>
</div>
<h3 id="updateprivilege"><a class="header" href="#updateprivilege">updatePrivilege</a></h3>
<p>Function to add/remove privileged User.</p>
<p><em>Only callable by the owner.</em></p>
<pre><code class="language-solidity">function updatePrivilege(address _user, bool _privilege) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_user</code></td><td><code>address</code></td><td>User Address for which privilege is to be updated.</td></tr>
<tr><td><code>_privilege</code></td><td><code>bool</code></td><td>Privilege(bool) whether true or false.</td></tr>
</tbody></table>
</div>
<h3 id="updatefeeparams"><a class="header" href="#updatefeeparams">updateFeeParams</a></h3>
<p>Update the fee params for registry.</p>
<pre><code class="language-solidity">function updateFeeParams(address _receiver, address _feeToken, uint256 _amount, uint256 _extensionFeePerDay) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_receiver</code></td><td><code>address</code></td><td>FeeReceiver address.</td></tr>
<tr><td><code>_feeToken</code></td><td><code>address</code></td><td>Token address for fee.</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>Amount of token to be collected.</td></tr>
<tr><td><code>_extensionFeePerDay</code></td><td><code>uint256</code></td><td>Extension fee per day.</td></tr>
</tbody></table>
</div>
<h3 id="getfarmdeployerlist"><a class="header" href="#getfarmdeployerlist">getFarmDeployerList</a></h3>
<p>Get list of registered deployer.</p>
<pre><code class="language-solidity">function getFarmDeployerList() external view returns (address[] memory);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address[]</code></td><td>Returns array of registered deployer addresses.</td></tr>
</tbody></table>
</div>
<h3 id="getfarmlist"><a class="header" href="#getfarmlist">getFarmList</a></h3>
<p>Get list of farms created via registered deployer.</p>
<pre><code class="language-solidity">function getFarmList() external view returns (address[] memory);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address[]</code></td><td>Returns array of farm addresses.</td></tr>
</tbody></table>
</div>
<h3 id="getfeeparams"><a class="header" href="#getfeeparams">getFeeParams</a></h3>
<p>Get all the fee parameters for creating farm.</p>
<p><em>It returns fee amount and extension fee as 0 if _user is privileged.</em></p>
<pre><code class="language-solidity">function getFeeParams(address _user) external view returns (address, address, uint256, uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_user</code></td><td><code>address</code></td><td>The account creating the farm.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td>Receiver of the fees.</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td>Token in which fee is to be paid.</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>Amount of fees to be paid for creation of farm.</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>Extension fee per day in case of extending a farm.</td></tr>
</tbody></table>
</div>
<h3 id="feereceiver"><a class="header" href="#feereceiver">feeReceiver</a></h3>
<pre><code class="language-solidity">function feeReceiver() external view returns (address);
</code></pre>
<h3 id="feetoken"><a class="header" href="#feetoken">feeToken</a></h3>
<pre><code class="language-solidity">function feeToken() external view returns (address);
</code></pre>
<h3 id="feeamount"><a class="header" href="#feeamount">feeAmount</a></h3>
<pre><code class="language-solidity">function feeAmount() external view returns (uint256);
</code></pre>
<h3 id="extensionfeeperday"><a class="header" href="#extensionfeeperday">extensionFeePerDay</a></h3>
<pre><code class="language-solidity">function extensionFeePerDay() external view returns (uint256);
</code></pre>
<h3 id="farmregistered"><a class="header" href="#farmregistered">farmRegistered</a></h3>
<pre><code class="language-solidity">function farmRegistered(address) external view returns (bool);
</code></pre>
<h3 id="deployerregistered"><a class="header" href="#deployerregistered">deployerRegistered</a></h3>
<pre><code class="language-solidity">function deployerRegistered(address) external view returns (bool);
</code></pre>
<h3 id="isprivilegeduser"><a class="header" href="#isprivilegeduser">isPrivilegedUser</a></h3>
<pre><code class="language-solidity">function isPrivilegedUser(address) external view returns (bool);
</code></pre>
<h2 id="events-7"><a class="header" href="#events-7">Events</a></h2>
<h3 id="farmregistered-1"><a class="header" href="#farmregistered-1">FarmRegistered</a></h3>
<pre><code class="language-solidity">event FarmRegistered(address indexed farm, address indexed creator, address indexed deployer);
</code></pre>
<h3 id="farmdeployerupdated"><a class="header" href="#farmdeployerupdated">FarmDeployerUpdated</a></h3>
<pre><code class="language-solidity">event FarmDeployerUpdated(address indexed deployer, bool registered);
</code></pre>
<h3 id="feeparamsupdated"><a class="header" href="#feeparamsupdated">FeeParamsUpdated</a></h3>
<pre><code class="language-solidity">event FeeParamsUpdated(address indexed receiver, address indexed token, uint256 amount, uint256 extensionFeePerDay);
</code></pre>
<h3 id="privilegeupdated"><a class="header" href="#privilegeupdated">PrivilegeUpdated</a></h3>
<pre><code class="language-solidity">event PrivilegeUpdated(address indexed deployer, bool privilege);
</code></pre>
<h2 id="errors-10"><a class="header" href="#errors-10">Errors</a></h2>
<h3 id="deployernotregistered"><a class="header" href="#deployernotregistered">DeployerNotRegistered</a></h3>
<pre><code class="language-solidity">error DeployerNotRegistered();
</code></pre>
<h3 id="farmalreadyregistered"><a class="header" href="#farmalreadyregistered">FarmAlreadyRegistered</a></h3>
<pre><code class="language-solidity">error FarmAlreadyRegistered();
</code></pre>
<h3 id="deployeralreadyregistered"><a class="header" href="#deployeralreadyregistered">DeployerAlreadyRegistered</a></h3>
<pre><code class="language-solidity">error DeployerAlreadyRegistered();
</code></pre>
<h3 id="invaliddeployerid"><a class="header" href="#invaliddeployerid">InvalidDeployerId</a></h3>
<pre><code class="language-solidity">error InvalidDeployerId();
</code></pre>
<h3 id="privilegesameasdesired"><a class="header" href="#privilegesameasdesired">PrivilegeSameAsDesired</a></h3>
<pre><code class="language-solidity">error PrivilegeSameAsDesired();
</code></pre>
<h3 id="invalidaddress-1"><a class="header" href="#invalidaddress-1">InvalidAddress</a></h3>
<pre><code class="language-solidity">error InvalidAddress();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ioracle"><a class="header" href="#ioracle">IOracle</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/interfaces/IOracle.sol">Git Source</a></p>
<h2 id="functions-44"><a class="header" href="#functions-44">Functions</a></h2>
<h3 id="pricefeedexists"><a class="header" href="#pricefeedexists">priceFeedExists</a></h3>
<p>Validates if price feed exists for a <code>_token</code></p>
<p><em>Function reverts if price feed not set.</em></p>
<pre><code class="language-solidity">function priceFeedExists(address _token) external view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_token</code></td><td><code>address</code></td><td>address of the desired token.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>bool True if price feed exists.</td></tr>
</tbody></table>
</div>
<h3 id="getprice"><a class="header" href="#getprice">getPrice</a></h3>
<p>Gets the price feed for <code>_token</code>.</p>
<p><em>Function reverts if the price feed does not exists.</em></p>
<pre><code class="language-solidity">function getPrice(address _token) external view returns (PriceData memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_token</code></td><td><code>address</code></td><td>address of the desired token.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>PriceData</code></td><td>(uint256 price, uint256 precision).</td></tr>
</tbody></table>
</div>
<h2 id="structs-9"><a class="header" href="#structs-9">Structs</a></h2>
<h3 id="pricedata"><a class="header" href="#pricedata">PriceData</a></h3>
<pre><code class="language-solidity">struct PriceData {
    uint256 price;
    uint256 precision;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="irewarder"><a class="header" href="#irewarder">IRewarder</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/interfaces/IRewarder.sol">Git Source</a></p>
<h2 id="functions-45"><a class="header" href="#functions-45">Functions</a></h2>
<h3 id="initialize-6"><a class="header" href="#initialize-6">initialize</a></h3>
<p>Initializer function of this contract.</p>
<pre><code class="language-solidity">function initialize(address _rwdToken, address _oracle, address _admin) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_rwdToken</code></td><td><code>address</code></td><td>Address of the reward token.</td></tr>
<tr><td><code>_oracle</code></td><td><code>address</code></td><td>Address of the USDs Master Price Oracle.</td></tr>
<tr><td><code>_admin</code></td><td><code>address</code></td><td>Admin/ deployer of this contract.</td></tr>
</tbody></table>
</div>
<h3 id="calibratereward"><a class="header" href="#calibratereward">calibrateReward</a></h3>
<p>Function to calibrate rewards for this rewarder's reward token for a farm.</p>
<p><em>Calculates based on APR, caps based on maxRewardPerSec or balance rewards, sends and sets the rewardRate in the farm.</em></p>
<pre><code class="language-solidity">function calibrateReward(address _farm) external returns (uint256 rewardsToSend);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farm</code></td><td><code>address</code></td><td>Address of the farm for which the rewards are to be calibrated.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>rewardsToSend</code></td><td><code>uint256</code></td><td>Rewards which are sent to the farm.</td></tr>
</tbody></table>
</div>
<h3 id="updatetokenmanageroffarm"><a class="header" href="#updatetokenmanageroffarm">updateTokenManagerOfFarm</a></h3>
<p>Function to update the token manager's address in the farm.</p>
<pre><code class="language-solidity">function updateTokenManagerOfFarm(address _farm, address _newManager) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farm</code></td><td><code>address</code></td><td>Farm's address in which the token manager is to be updated.</td></tr>
<tr><td><code>_newManager</code></td><td><code>address</code></td><td>Address of the new token manager.</td></tr>
</tbody></table>
</div>
<h3 id="recoverrewardfundsoffarm"><a class="header" href="#recoverrewardfundsoffarm">recoverRewardFundsOfFarm</a></h3>
<p>Function to recover reward funds from the farm.</p>
<pre><code class="language-solidity">function recoverRewardFundsOfFarm(address _farm, uint256 _amount) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farm</code></td><td><code>address</code></td><td>Farm's address from which reward funds is to be recovered.</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>Amount which is to be recovered.</td></tr>
</tbody></table>
</div>
<h3 id="updateapr"><a class="header" href="#updateapr">updateAPR</a></h3>
<p>Function to update APR.</p>
<pre><code class="language-solidity">function updateAPR(address _farm, uint256 _apr) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farm</code></td><td><code>address</code></td><td>Address of the farm.</td></tr>
<tr><td><code>_apr</code></td><td><code>uint256</code></td><td>APR in 1e8 precision.</td></tr>
</tbody></table>
</div>
<h3 id="togglecalibrationrestriction"><a class="header" href="#togglecalibrationrestriction">toggleCalibrationRestriction</a></h3>
<p>Function to toggle calibration restriction.</p>
<pre><code class="language-solidity">function toggleCalibrationRestriction(address _farm) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farm</code></td><td><code>address</code></td><td>Address of farm for which calibration restriction is to be toggled.</td></tr>
</tbody></table>
</div>
<h3 id="recovererc20-1"><a class="header" href="#recovererc20-1">recoverERC20</a></h3>
<p>Function to recover ERC20 tokens from this contract.</p>
<pre><code class="language-solidity">function recoverERC20(address _token, uint256 _amount) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_token</code></td><td><code>address</code></td><td>Address of the token.</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>Amount of the tokens.</td></tr>
</tbody></table>
</div>
<h3 id="updaterewardconfig"><a class="header" href="#updaterewardconfig">updateRewardConfig</a></h3>
<p>Function to update the REWARD_TOKEN configuration.
This function calibrates reward so token manager must be updated to address of this contract in the farm.</p>
<pre><code class="language-solidity">function updateRewardConfig(address _farm, FarmRewardConfigInput memory _rewardConfig) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farm</code></td><td><code>address</code></td><td>Address of the farm for which the config is to be updated.</td></tr>
<tr><td><code>_rewardConfig</code></td><td><code>FarmRewardConfigInput</code></td><td>The config which is to be set.</td></tr>
</tbody></table>
</div>
<h3 id="gettokenamounts-6"><a class="header" href="#gettokenamounts-6">getTokenAmounts</a></h3>
<p>Function to get token amounts value of underlying pool of the farm.</p>
<pre><code class="language-solidity">function getTokenAmounts(address _farm) external view returns (address[] memory, uint256[] memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farm</code></td><td><code>address</code></td><td>Address of the farm.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address[]</code></td><td>Array of token addresses.</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256[]</code></td><td>Array of token amounts.</td></tr>
</tbody></table>
</div>
<h3 id="getfarmrewardconfig"><a class="header" href="#getfarmrewardconfig">getFarmRewardConfig</a></h3>
<p>Function to get reward config for a farm.</p>
<pre><code class="language-solidity">function getFarmRewardConfig(address _farm) external view returns (FarmRewardConfig memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farm</code></td><td><code>address</code></td><td>Address of the farm.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>FarmRewardConfig</code></td><td>FarmRewardConfig Farm reward config.</td></tr>
</tbody></table>
</div>
<h3 id="rewardsendtime"><a class="header" href="#rewardsendtime">rewardsEndTime</a></h3>
<p>Function to calculate the time till which rewards are there for an LP.</p>
<pre><code class="language-solidity">function rewardsEndTime(address _farm) external view returns (uint256 rewardsEndingOn);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farm</code></td><td><code>address</code></td><td>Address of the farm for which the end time is to be calculated.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>rewardsEndingOn</code></td><td><code>uint256</code></td><td>Timestamp in seconds till which the rewards are there in farm and in rewarder.</td></tr>
</tbody></table>
</div>
<h3 id="max_percentage"><a class="header" href="#max_percentage">MAX_PERCENTAGE</a></h3>
<pre><code class="language-solidity">function MAX_PERCENTAGE() external view returns (uint256);
</code></pre>
<h3 id="apr_precision"><a class="header" href="#apr_precision">APR_PRECISION</a></h3>
<pre><code class="language-solidity">function APR_PRECISION() external view returns (uint256);
</code></pre>
<h3 id="reward_period"><a class="header" href="#reward_period">REWARD_PERIOD</a></h3>
<pre><code class="language-solidity">function REWARD_PERIOD() external view returns (uint256);
</code></pre>
<h3 id="denominator"><a class="header" href="#denominator">DENOMINATOR</a></h3>
<pre><code class="language-solidity">function DENOMINATOR() external view returns (uint256);
</code></pre>
<h3 id="one_year"><a class="header" href="#one_year">ONE_YEAR</a></h3>
<pre><code class="language-solidity">function ONE_YEAR() external view returns (uint256);
</code></pre>
<h3 id="reward_token"><a class="header" href="#reward_token">REWARD_TOKEN</a></h3>
<pre><code class="language-solidity">function REWARD_TOKEN() external view returns (address);
</code></pre>
<h3 id="reward_token_decimals"><a class="header" href="#reward_token_decimals">REWARD_TOKEN_DECIMALS</a></h3>
<pre><code class="language-solidity">function REWARD_TOKEN_DECIMALS() external view returns (uint8);
</code></pre>
<h3 id="totalrewardrate"><a class="header" href="#totalrewardrate">totalRewardRate</a></h3>
<pre><code class="language-solidity">function totalRewardRate() external view returns (uint256);
</code></pre>
<h3 id="rewarderfactory"><a class="header" href="#rewarderfactory">rewarderFactory</a></h3>
<pre><code class="language-solidity">function rewarderFactory() external view returns (address);
</code></pre>
<h2 id="events-8"><a class="header" href="#events-8">Events</a></h2>
<h3 id="rewardconfigupdated"><a class="header" href="#rewardconfigupdated">RewardConfigUpdated</a></h3>
<pre><code class="language-solidity">event RewardConfigUpdated(address indexed farm, FarmRewardConfigInput rewardConfig);
</code></pre>
<h3 id="aprupdated"><a class="header" href="#aprupdated">APRUpdated</a></h3>
<pre><code class="language-solidity">event APRUpdated(address indexed farm, uint256 apr);
</code></pre>
<h3 id="rewardcalibrated"><a class="header" href="#rewardcalibrated">RewardCalibrated</a></h3>
<pre><code class="language-solidity">event RewardCalibrated(address indexed farm, uint256 rewardsSent, uint256 rewardRate);
</code></pre>
<h3 id="calibrationrestrictiontoggled"><a class="header" href="#calibrationrestrictiontoggled">CalibrationRestrictionToggled</a></h3>
<pre><code class="language-solidity">event CalibrationRestrictionToggled(address indexed farm);
</code></pre>
<h2 id="errors-11"><a class="header" href="#errors-11">Errors</a></h2>
<h3 id="invalidaddress-2"><a class="header" href="#invalidaddress-2">InvalidAddress</a></h3>
<pre><code class="language-solidity">error InvalidAddress();
</code></pre>
<h3 id="invalidfarm"><a class="header" href="#invalidfarm">InvalidFarm</a></h3>
<pre><code class="language-solidity">error InvalidFarm();
</code></pre>
<h3 id="farmnotconfigured"><a class="header" href="#farmnotconfigured">FarmNotConfigured</a></h3>
<pre><code class="language-solidity">error FarmNotConfigured(address farm);
</code></pre>
<h3 id="zeroamount-1"><a class="header" href="#zeroamount-1">ZeroAmount</a></h3>
<pre><code class="language-solidity">error ZeroAmount();
</code></pre>
<h3 id="pricefeeddoesnotexist"><a class="header" href="#pricefeeddoesnotexist">PriceFeedDoesNotExist</a></h3>
<pre><code class="language-solidity">error PriceFeedDoesNotExist(address token);
</code></pre>
<h3 id="invalidrewardpercentage"><a class="header" href="#invalidrewardpercentage">InvalidRewardPercentage</a></h3>
<pre><code class="language-solidity">error InvalidRewardPercentage(uint256 percentage);
</code></pre>
<h3 id="calibrationrestricted"><a class="header" href="#calibrationrestricted">CalibrationRestricted</a></h3>
<pre><code class="language-solidity">error CalibrationRestricted(address farm);
</code></pre>
<h2 id="structs-10"><a class="header" href="#structs-10">Structs</a></h2>
<h3 id="farmrewardconfig"><a class="header" href="#farmrewardconfig">FarmRewardConfig</a></h3>
<pre><code class="language-solidity">struct FarmRewardConfig {
    uint256 apr;
    uint128 rewardRate;
    uint128 maxRewardRate;
    uint256[] baseAssetIndexes;
    uint256 nonLockupRewardPer;
}
</code></pre>
<h3 id="farmrewardconfiginput"><a class="header" href="#farmrewardconfiginput">FarmRewardConfigInput</a></h3>
<pre><code class="language-solidity">struct FarmRewardConfigInput {
    uint256 apr;
    uint128 maxRewardRate;
    address[] baseTokens;
    uint256 nonLockupRewardPer;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="irewarderfactory"><a class="header" href="#irewarderfactory">IRewarderFactory</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/interfaces/IRewarderFactory.sol">Git Source</a></p>
<h2 id="functions-46"><a class="header" href="#functions-46">Functions</a></h2>
<h3 id="deployrewarder"><a class="header" href="#deployrewarder">deployRewarder</a></h3>
<p>Function to deploy new rewarder.</p>
<pre><code class="language-solidity">function deployRewarder(address _rwdToken) external returns (address rewarder);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_rwdToken</code></td><td><code>address</code></td><td>Address of the reward token for which the rewarder is to be deployed.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>rewarder</code></td><td><code>address</code></td><td>Rewarder's address.</td></tr>
</tbody></table>
</div>
<h3 id="updaterewarderimplementation"><a class="header" href="#updaterewarderimplementation">updateRewarderImplementation</a></h3>
<p>Update rewarder implementation's address</p>
<pre><code class="language-solidity">function updateRewarderImplementation(address _newRewarderImplementation) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_newRewarderImplementation</code></td><td><code>address</code></td><td>New Rewarder Implementation</td></tr>
</tbody></table>
</div>
<h3 id="updateoracle"><a class="header" href="#updateoracle">updateOracle</a></h3>
<p>Function to update the oracle's address.</p>
<pre><code class="language-solidity">function updateOracle(address _newOracle) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_newOracle</code></td><td><code>address</code></td><td>Address of the new oracle.</td></tr>
</tbody></table>
</div>
<h3 id="oracle"><a class="header" href="#oracle">oracle</a></h3>
<pre><code class="language-solidity">function oracle() external view returns (address);
</code></pre>
<h3 id="rewarderimplementation"><a class="header" href="#rewarderimplementation">rewarderImplementation</a></h3>
<pre><code class="language-solidity">function rewarderImplementation() external view returns (address);
</code></pre>
<h2 id="events-9"><a class="header" href="#events-9">Events</a></h2>
<h3 id="oracleupdated"><a class="header" href="#oracleupdated">OracleUpdated</a></h3>
<pre><code class="language-solidity">event OracleUpdated(address indexed newOracle);
</code></pre>
<h3 id="rewarderdeployed"><a class="header" href="#rewarderdeployed">RewarderDeployed</a></h3>
<pre><code class="language-solidity">event RewarderDeployed(address indexed token, address indexed manager, address indexed rewarder);
</code></pre>
<h3 id="rewarderimplementationupdated"><a class="header" href="#rewarderimplementationupdated">RewarderImplementationUpdated</a></h3>
<pre><code class="language-solidity">event RewarderImplementationUpdated(address indexed _newRewarderImplementation);
</code></pre>
<h2 id="errors-12"><a class="header" href="#errors-12">Errors</a></h2>
<h3 id="invalidaddress-3"><a class="header" href="#invalidaddress-3">InvalidAddress</a></h3>
<pre><code class="language-solidity">error InvalidAddress();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-15"><a class="header" href="#contents-15">Contents</a></h1>
<ul>
<li><a href="contracts/rewarder/Rewarder.sol/contract.Rewarder.html">Rewarder</a></li>
<li><a href="contracts/rewarder/RewarderFactory.sol/contract.RewarderFactory.html">RewarderFactory</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rewarder"><a class="header" href="#rewarder">Rewarder</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/rewarder/Rewarder.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/rewarder/Rewarder.sol//contracts/interfaces/IRewarder.sol/interface.IRewarder.html">IRewarder</a>, OwnableUpgradeable, ReentrancyGuardUpgradeable</p>
<p><strong>Author:</strong>
Sperax Foundation.</p>
<p>This contract tracks farms, their APR and other data for a specific reward token.</p>
<p><em>Farms for UniV3 pools using Rewarder contract must have a minimum observationCardinality of 20.
It can be updated by calling increaseObservationCardinalityNext function on the pool.</em></p>
<h2 id="state-variables-14"><a class="header" href="#state-variables-14">State Variables</a></h2>
<h3 id="max_percentage-1"><a class="header" href="#max_percentage-1">MAX_PERCENTAGE</a></h3>
<pre><code class="language-solidity">uint256 public constant MAX_PERCENTAGE = 1e4;
</code></pre>
<h3 id="apr_precision-1"><a class="header" href="#apr_precision-1">APR_PRECISION</a></h3>
<pre><code class="language-solidity">uint256 public constant APR_PRECISION = 1e8;
</code></pre>
<h3 id="reward_period-1"><a class="header" href="#reward_period-1">REWARD_PERIOD</a></h3>
<pre><code class="language-solidity">uint256 public constant REWARD_PERIOD = 1 weeks;
</code></pre>
<h3 id="denominator-1"><a class="header" href="#denominator-1">DENOMINATOR</a></h3>
<pre><code class="language-solidity">uint256 public constant DENOMINATOR = 100;
</code></pre>
<h3 id="one_year-1"><a class="header" href="#one_year-1">ONE_YEAR</a></h3>
<pre><code class="language-solidity">uint256 public constant ONE_YEAR = 365 days;
</code></pre>
<h3 id="reward_token-1"><a class="header" href="#reward_token-1">REWARD_TOKEN</a></h3>
<pre><code class="language-solidity">address public REWARD_TOKEN;
</code></pre>
<h3 id="reward_token_decimals-1"><a class="header" href="#reward_token_decimals-1">REWARD_TOKEN_DECIMALS</a></h3>
<pre><code class="language-solidity">uint8 public REWARD_TOKEN_DECIMALS;
</code></pre>
<h3 id="totalrewardrate-1"><a class="header" href="#totalrewardrate-1">totalRewardRate</a></h3>
<pre><code class="language-solidity">uint256 public totalRewardRate;
</code></pre>
<h3 id="rewarderfactory-1"><a class="header" href="#rewarderfactory-1">rewarderFactory</a></h3>
<pre><code class="language-solidity">address public rewarderFactory;
</code></pre>
<h3 id="calibrationrestricted-1"><a class="header" href="#calibrationrestricted-1">calibrationRestricted</a></h3>
<pre><code class="language-solidity">mapping(address =&gt; bool) public calibrationRestricted;
</code></pre>
<h3 id="farmrewardconfigs"><a class="header" href="#farmrewardconfigs">farmRewardConfigs</a></h3>
<pre><code class="language-solidity">mapping(address =&gt; FarmRewardConfig) internal farmRewardConfigs;
</code></pre>
<h3 id="_decimals"><a class="header" href="#_decimals">_decimals</a></h3>
<pre><code class="language-solidity">mapping(address =&gt; uint8) private _decimals;
</code></pre>
<h2 id="functions-47"><a class="header" href="#functions-47">Functions</a></h2>
<h3 id="constructor-7"><a class="header" href="#constructor-7">constructor</a></h3>
<pre><code class="language-solidity">constructor();
</code></pre>
<h3 id="initialize-7"><a class="header" href="#initialize-7">initialize</a></h3>
<p>Initializer function of this contract.</p>
<pre><code class="language-solidity">function initialize(address _rwdToken, address _oracle, address _admin) external initializer;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_rwdToken</code></td><td><code>address</code></td><td>Address of the reward token.</td></tr>
<tr><td><code>_oracle</code></td><td><code>address</code></td><td>Address of the USDs Master Price Oracle.</td></tr>
<tr><td><code>_admin</code></td><td><code>address</code></td><td>Admin/ deployer of this contract.</td></tr>
</tbody></table>
</div>
<h3 id="calibratereward-1"><a class="header" href="#calibratereward-1">calibrateReward</a></h3>
<p>Function to calibrate rewards for this rewarder's reward token for a farm.</p>
<p><em>Calculates based on APR, caps based on maxRewardPerSec or balance rewards, sends and sets the rewardRate in the farm.</em></p>
<pre><code class="language-solidity">function calibrateReward(address _farm) external nonReentrant returns (uint256 rewardsToSend);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farm</code></td><td><code>address</code></td><td>Address of the farm for which the rewards are to be calibrated.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>rewardsToSend</code></td><td><code>uint256</code></td><td>Rewards which are sent to the farm.</td></tr>
</tbody></table>
</div>
<h3 id="updatetokenmanageroffarm-1"><a class="header" href="#updatetokenmanageroffarm-1">updateTokenManagerOfFarm</a></h3>
<p>Function to update the token manager's address in the farm.</p>
<pre><code class="language-solidity">function updateTokenManagerOfFarm(address _farm, address _newManager) external onlyOwner;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farm</code></td><td><code>address</code></td><td>Farm's address in which the token manager is to be updated.</td></tr>
<tr><td><code>_newManager</code></td><td><code>address</code></td><td>Address of the new token manager.</td></tr>
</tbody></table>
</div>
<h3 id="recoverrewardfundsoffarm-1"><a class="header" href="#recoverrewardfundsoffarm-1">recoverRewardFundsOfFarm</a></h3>
<p>Function to recover reward funds from the farm.</p>
<pre><code class="language-solidity">function recoverRewardFundsOfFarm(address _farm, uint256 _amount) external onlyOwner;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farm</code></td><td><code>address</code></td><td>Farm's address from which reward funds is to be recovered.</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>Amount which is to be recovered.</td></tr>
</tbody></table>
</div>
<h3 id="updateapr-1"><a class="header" href="#updateapr-1">updateAPR</a></h3>
<p>Function to update APR.</p>
<pre><code class="language-solidity">function updateAPR(address _farm, uint256 _apr) external onlyOwner nonReentrant;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farm</code></td><td><code>address</code></td><td>Address of the farm.</td></tr>
<tr><td><code>_apr</code></td><td><code>uint256</code></td><td>APR in 1e8 precision.</td></tr>
</tbody></table>
</div>
<h3 id="togglecalibrationrestriction-1"><a class="header" href="#togglecalibrationrestriction-1">toggleCalibrationRestriction</a></h3>
<p>Function to toggle calibration restriction.</p>
<pre><code class="language-solidity">function toggleCalibrationRestriction(address _farm) external onlyOwner;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farm</code></td><td><code>address</code></td><td>Address of farm for which calibration restriction is to be toggled.</td></tr>
</tbody></table>
</div>
<h3 id="recovererc20-2"><a class="header" href="#recovererc20-2">recoverERC20</a></h3>
<p>Function to recover ERC20 tokens from this contract.</p>
<pre><code class="language-solidity">function recoverERC20(address _token, uint256 _amount) external onlyOwner;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_token</code></td><td><code>address</code></td><td>Address of the token.</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>Amount of the tokens.</td></tr>
</tbody></table>
</div>
<h3 id="gettokenamounts-7"><a class="header" href="#gettokenamounts-7">getTokenAmounts</a></h3>
<p>Function to get token amounts value of underlying pool of the farm.</p>
<pre><code class="language-solidity">function getTokenAmounts(address _farm) external view returns (address[] memory, uint256[] memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farm</code></td><td><code>address</code></td><td>Address of the farm.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address[]</code></td><td>Array of token addresses.</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256[]</code></td><td></td></tr>
</tbody></table>
</div>
<h3 id="getfarmrewardconfig-1"><a class="header" href="#getfarmrewardconfig-1">getFarmRewardConfig</a></h3>
<p>Function to get reward config for a farm.</p>
<pre><code class="language-solidity">function getFarmRewardConfig(address _farm) external view returns (FarmRewardConfig memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farm</code></td><td><code>address</code></td><td>Address of the farm.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>FarmRewardConfig</code></td><td>FarmRewardConfig Farm reward config.</td></tr>
</tbody></table>
</div>
<h3 id="rewardsendtime-1"><a class="header" href="#rewardsendtime-1">rewardsEndTime</a></h3>
<p>Function to calculate the time till which rewards are there for an LP.</p>
<pre><code class="language-solidity">function rewardsEndTime(address _farm) external view returns (uint256 rewardsEndingOn);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farm</code></td><td><code>address</code></td><td>Address of the farm for which the end time is to be calculated.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>rewardsEndingOn</code></td><td><code>uint256</code></td><td>Timestamp in seconds till which the rewards are there in farm and in rewarder.</td></tr>
</tbody></table>
</div>
<h3 id="updaterewardconfig-1"><a class="header" href="#updaterewardconfig-1">updateRewardConfig</a></h3>
<p>Function to update the REWARD_TOKEN configuration.
This function calibrates reward so token manager must be updated to address of this contract in the farm.</p>
<pre><code class="language-solidity">function updateRewardConfig(address _farm, FarmRewardConfigInput memory _rewardConfig) public onlyOwner nonReentrant;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farm</code></td><td><code>address</code></td><td>Address of the farm for which the config is to be updated.</td></tr>
<tr><td><code>_rewardConfig</code></td><td><code>FarmRewardConfigInput</code></td><td>The config which is to be set.</td></tr>
</tbody></table>
</div>
<h3 id="_initialize-1"><a class="header" href="#_initialize-1">_initialize</a></h3>
<p>Internal initialize function.</p>
<pre><code class="language-solidity">function _initialize(address _rwdToken, address _oracle, address _admin, address _rewarderFactory) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_rwdToken</code></td><td><code>address</code></td><td>Address of the reward token.</td></tr>
<tr><td><code>_oracle</code></td><td><code>address</code></td><td>Address of the USDs Master Price Oracle.</td></tr>
<tr><td><code>_admin</code></td><td><code>address</code></td><td>Admin/ deployer of this contract.</td></tr>
<tr><td><code>_rewarderFactory</code></td><td><code>address</code></td><td>Address of Rewarder factory contract.</td></tr>
</tbody></table>
</div>
<h3 id="_isconfigured"><a class="header" href="#_isconfigured">_isConfigured</a></h3>
<p>Function to check if the farm's reward is configured.</p>
<pre><code class="language-solidity">function _isConfigured(address _farm) internal view;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farm</code></td><td><code>address</code></td><td>Address of the farm.</td></tr>
</tbody></table>
</div>
<h3 id="_gettokenamounts"><a class="header" href="#_gettokenamounts">_getTokenAmounts</a></h3>
<p>An internal function to get token amounts for the farm.</p>
<pre><code class="language-solidity">function _getTokenAmounts(address _farm) internal view virtual returns (address[] memory, uint256[] memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farm</code></td><td><code>address</code></td><td>Address of the farm.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address[]</code></td><td>Array of token addresses.</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256[]</code></td><td>Array of token amounts.</td></tr>
</tbody></table>
</div>
<h3 id="_hasrewardtoken"><a class="header" href="#_hasrewardtoken">_hasRewardToken</a></h3>
<p>Function to check if the reward token of this contract is one of farm's reward token.</p>
<pre><code class="language-solidity">function _hasRewardToken(address _farm) internal view virtual returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farm</code></td><td><code>address</code></td><td>Address of the farm.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>If farm has one of the reward token as reward token of this contract.</td></tr>
</tbody></table>
</div>
<h3 id="_validatenonzeroaddr"><a class="header" href="#_validatenonzeroaddr">_validateNonZeroAddr</a></h3>
<p>Validate address.</p>
<pre><code class="language-solidity">function _validateNonZeroAddr(address _addr) internal pure;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_addr</code></td><td><code>address</code></td><td>Address to be validated.</td></tr>
</tbody></table>
</div>
<h3 id="_calibratereward"><a class="header" href="#_calibratereward">_calibrateReward</a></h3>
<pre><code class="language-solidity">function _calibrateReward(address _farm) private returns (uint256 rewardsToSend);
</code></pre>
<h3 id="_setrewardrate"><a class="header" href="#_setrewardrate">_setRewardRate</a></h3>
<p>Function to set reward rate in the farm.</p>
<pre><code class="language-solidity">function _setRewardRate(address _farm, uint128 _rwdRate, uint256 _nonLockupRewardPer) private;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farm</code></td><td><code>address</code></td><td>Address of the farm.</td></tr>
<tr><td><code>_rwdRate</code></td><td><code>uint128</code></td><td>Reward per second to be emitted.</td></tr>
<tr><td><code>_nonLockupRewardPer</code></td><td><code>uint256</code></td><td>Reward percentage to be allocated to no lockup fund.</td></tr>
</tbody></table>
</div>
<h3 id="_adjustglobalrewardrate"><a class="header" href="#_adjustglobalrewardrate">_adjustGlobalRewardRate</a></h3>
<p>Function to adjust global rewards per second emitted for a reward token.</p>
<pre><code class="language-solidity">function _adjustGlobalRewardRate(uint256 _oldRewardRate, uint256 _newRewardRate) private;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_oldRewardRate</code></td><td><code>uint256</code></td><td>Old emission rate.</td></tr>
<tr><td><code>_newRewardRate</code></td><td><code>uint256</code></td><td>New emission rate.</td></tr>
</tbody></table>
</div>
<h3 id="_isvalidfarm"><a class="header" href="#_isvalidfarm">_isValidFarm</a></h3>
<p>Function to validate farm.</p>
<p><em>It checks that the farm should implement getTokenAmounts and have REWARD_TOKEN.
as one of the reward tokens.</em></p>
<pre><code class="language-solidity">function _isValidFarm(address _farm, address[] memory _baseTokens) private returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farm</code></td><td><code>address</code></td><td>Address of the farm to be validated.</td></tr>
<tr><td><code>_baseTokens</code></td><td><code>address[]</code></td><td>Array of base tokens.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>bool True if farm is valid.</td></tr>
</tbody></table>
</div>
<h3 id="_hasbasetokens"><a class="header" href="#_hasbasetokens">_hasBaseTokens</a></h3>
<p>Function to check whether the base tokens are a subset of farm's assets.</p>
<p><em>It handles repeated base tokens as well and pushes indexed in farmRewardConfigs.</em></p>
<pre><code class="language-solidity">function _hasBaseTokens(address _farm, address[] memory _baseTokens) private returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farm</code></td><td><code>address</code></td><td>Address of the farm.</td></tr>
<tr><td><code>_baseTokens</code></td><td><code>address[]</code></td><td>Array of base token addresses to be considered for value calculation.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>hasBaseTokens True if baseTokens are non redundant and are a subset of assets.</td></tr>
</tbody></table>
</div>
<h3 id="_normalizeamount"><a class="header" href="#_normalizeamount">_normalizeAmount</a></h3>
<p>Function to normalize asset amounts to be of precision REWARD_TOKEN_DECIMALS.</p>
<pre><code class="language-solidity">function _normalizeAmount(address _token, uint256 _amount) private view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_token</code></td><td><code>address</code></td><td>Address of the asset token.</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>Amount of the token.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>Normalized amount of the token in _desiredPrecision.</td></tr>
</tbody></table>
</div>
<h3 id="_getprice"><a class="header" href="#_getprice">_getPrice</a></h3>
<p>Function to fetch and get the price of a token.</p>
<pre><code class="language-solidity">function _getPrice(address _token, address _oracle) private view returns (IOracle.PriceData memory priceData);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_token</code></td><td><code>address</code></td><td>Token for which the the price is to be fetched.</td></tr>
<tr><td><code>_oracle</code></td><td><code>address</code></td><td>Address of the oracle contract.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>priceData</code></td><td><code>IOracle.PriceData</code></td><td>Price data of the token.</td></tr>
</tbody></table>
</div>
<h3 id="_validatepricefeed"><a class="header" href="#_validatepricefeed">_validatePriceFeed</a></h3>
<p>Function to validate price feed.</p>
<pre><code class="language-solidity">function _validatePriceFeed(address _token, address _oracle) private view;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_token</code></td><td><code>address</code></td><td>Token to be validated.</td></tr>
<tr><td><code>_oracle</code></td><td><code>address</code></td><td>Address of the oracle.</td></tr>
</tbody></table>
</div>
<h3 id="_validaterewardper"><a class="header" href="#_validaterewardper">_validateRewardPer</a></h3>
<p>Function to validate the no lockup fund's reward percentage.</p>
<pre><code class="language-solidity">function _validateRewardPer(uint256 _percentage) private pure;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_percentage</code></td><td><code>uint256</code></td><td>No lockup fund's reward percentage to be validated.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="rewarderfactory-2"><a class="header" href="#rewarderfactory-2">RewarderFactory</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/rewarder/RewarderFactory.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/rewarder/RewarderFactory.sol//contracts/interfaces/IRewarderFactory.sol/interface.IRewarderFactory.html">IRewarderFactory</a>, Ownable</p>
<p><strong>Author:</strong>
Sperax Foundation.</p>
<p>This contract deploys new rewarders and keeps track of them.</p>
<h2 id="state-variables-15"><a class="header" href="#state-variables-15">State Variables</a></h2>
<h3 id="oracle-1"><a class="header" href="#oracle-1">oracle</a></h3>
<pre><code class="language-solidity">address public oracle;
</code></pre>
<h3 id="rewarderimplementation-1"><a class="header" href="#rewarderimplementation-1">rewarderImplementation</a></h3>
<pre><code class="language-solidity">address public rewarderImplementation;
</code></pre>
<h2 id="functions-48"><a class="header" href="#functions-48">Functions</a></h2>
<h3 id="constructor-8"><a class="header" href="#constructor-8">constructor</a></h3>
<p>Constructor.</p>
<pre><code class="language-solidity">constructor(address _oracle) Ownable(msg.sender);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_oracle</code></td><td><code>address</code></td><td>Address of the master price oracle of USDs.</td></tr>
</tbody></table>
</div>
<h3 id="deployrewarder-1"><a class="header" href="#deployrewarder-1">deployRewarder</a></h3>
<p>Function to deploy new rewarder.</p>
<pre><code class="language-solidity">function deployRewarder(address _rwdToken) external returns (address rewarder);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_rwdToken</code></td><td><code>address</code></td><td>Address of the reward token for which the rewarder is to be deployed.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>rewarder</code></td><td><code>address</code></td><td>Rewarder's address.</td></tr>
</tbody></table>
</div>
<h3 id="updaterewarderimplementation-1"><a class="header" href="#updaterewarderimplementation-1">updateRewarderImplementation</a></h3>
<p>Update rewarder implementation's address</p>
<pre><code class="language-solidity">function updateRewarderImplementation(address _newRewarderImplementation) external onlyOwner;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_newRewarderImplementation</code></td><td><code>address</code></td><td>New Rewarder Implementation</td></tr>
</tbody></table>
</div>
<h3 id="updateoracle-1"><a class="header" href="#updateoracle-1">updateOracle</a></h3>
<p>Function to update the oracle's address.</p>
<pre><code class="language-solidity">function updateOracle(address _newOracle) public onlyOwner;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_newOracle</code></td><td><code>address</code></td><td>Address of the new oracle.</td></tr>
</tbody></table>
</div>
<h3 id="_validatenonzeroaddr-1"><a class="header" href="#_validatenonzeroaddr-1">_validateNonZeroAddr</a></h3>
<p>Validate address.</p>
<pre><code class="language-solidity">function _validateNonZeroAddr(address _addr) private pure;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_addr</code></td><td><code>address</code></td><td>Address to be validated.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="contents-16"><a class="header" href="#contents-16">Contents</a></h1>
<ul>
<li><a href="contracts/utils/TokenUtils.sol/library.TokenUtils.html">TokenUtils</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tokenutils"><a class="header" href="#tokenutils">TokenUtils</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/utils/TokenUtils.sol">Git Source</a></p>
<p><strong>Author:</strong>
Sperax Foundation.</p>
<p>This library provides utility functions to calculate token amounts for different farms based on the farm's liquidity.</p>
<h2 id="state-variables-16"><a class="header" href="#state-variables-16">State Variables</a></h2>
<h3 id="ma_period"><a class="header" href="#ma_period">MA_PERIOD</a></h3>
<pre><code class="language-solidity">uint32 private constant MA_PERIOD = 10 minutes;
</code></pre>
<h2 id="functions-49"><a class="header" href="#functions-49">Functions</a></h2>
<h3 id="getuniv2tokenamounts"><a class="header" href="#getuniv2tokenamounts">getUniV2TokenAmounts</a></h3>
<p>Get token amounts for Uniswap V2 farm based on the farm's liquidity.</p>
<pre><code class="language-solidity">function getUniV2TokenAmounts(address _nftContract, uint256 _farmLiquidity)
    internal
    view
    returns (address[] memory tokens, uint256[] memory amounts);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_nftContract</code></td><td><code>address</code></td><td>pool address.</td></tr>
<tr><td><code>_farmLiquidity</code></td><td><code>uint256</code></td><td>The farm's liquidity.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>tokens</code></td><td><code>address[]</code></td><td>An array of token addresses.</td></tr>
<tr><td><code>amounts</code></td><td><code>uint256[]</code></td><td>An array of token amounts.</td></tr>
</tbody></table>
</div>
<h3 id="getuniv3tokenamounts"><a class="header" href="#getuniv3tokenamounts">getUniV3TokenAmounts</a></h3>
<p>Get token amounts for Uniswap V3 farm based on the farm's liquidity.</p>
<pre><code class="language-solidity">function getUniV3TokenAmounts(
    address _uniPool,
    address _uniUtils,
    int24 _tickLower,
    int24 _tickUpper,
    uint256 _liquidity
) internal view returns (address[] memory tokens, uint256[] memory amounts);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_uniPool</code></td><td><code>address</code></td><td>The Uniswap V3 pool address.</td></tr>
<tr><td><code>_uniUtils</code></td><td><code>address</code></td><td>The Uniswap V3 utils address.</td></tr>
<tr><td><code>_tickLower</code></td><td><code>int24</code></td><td>The lower tick.</td></tr>
<tr><td><code>_tickUpper</code></td><td><code>int24</code></td><td>The upper tick.</td></tr>
<tr><td><code>_liquidity</code></td><td><code>uint256</code></td><td>The farm's liquidity.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>tokens</code></td><td><code>address[]</code></td><td>An array of token addresses.</td></tr>
<tr><td><code>amounts</code></td><td><code>uint256[]</code></td><td>An array of token amounts.</td></tr>
</tbody></table>
</div>
<h3 id="getcamelotv3tokenamounts"><a class="header" href="#getcamelotv3tokenamounts">getCamelotV3TokenAmounts</a></h3>
<p>Get token amounts for Camelot V3 farm based on the farm's liquidity.</p>
<pre><code class="language-solidity">function getCamelotV3TokenAmounts(
    address _camelotPool,
    address _camelotUtils,
    int24 _tickLower,
    int24 _tickUpper,
    uint256 _liquidity
) internal view returns (address[] memory tokens, uint256[] memory amounts);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_camelotPool</code></td><td><code>address</code></td><td>The Camelot V3 pool address.</td></tr>
<tr><td><code>_camelotUtils</code></td><td><code>address</code></td><td>The Camelot V3 utils address.</td></tr>
<tr><td><code>_tickLower</code></td><td><code>int24</code></td><td>The lower tick.</td></tr>
<tr><td><code>_tickUpper</code></td><td><code>int24</code></td><td>The upper tick.</td></tr>
<tr><td><code>_liquidity</code></td><td><code>uint256</code></td><td>The farm's liquidity.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>tokens</code></td><td><code>address[]</code></td><td>An array of token addresses.</td></tr>
<tr><td><code>amounts</code></td><td><code>uint256[]</code></td><td>An array of token amounts.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="farm"><a class="header" href="#farm">Farm</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/Farm.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/Farm.sol//contracts/FarmStorage.sol/abstract.FarmStorage.html">FarmStorage</a>, OwnableUpgradeable, ReentrancyGuardUpgradeable, MulticallUpgradeable</p>
<p><strong>Author:</strong>
Sperax Foundation.</p>
<p>This contract contains the core logic for the Demeter farms.</p>
<h2 id="functions-50"><a class="header" href="#functions-50">Functions</a></h2>
<h3 id="constructor-9"><a class="header" href="#constructor-9">constructor</a></h3>
<pre><code class="language-solidity">constructor();
</code></pre>
<h3 id="withdraw-3"><a class="header" href="#withdraw-3">withdraw</a></h3>
<p>Function to be called to withdraw deposit.</p>
<pre><code class="language-solidity">function withdraw(uint256 _depositId) external virtual;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>The id of the deposit.</td></tr>
</tbody></table>
</div>
<h3 id="claimrewards-1"><a class="header" href="#claimrewards-1">claimRewards</a></h3>
<p>A function to be called by the depositor to claim rewards.</p>
<pre><code class="language-solidity">function claimRewards(uint256 _depositId) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>The id of the deposit.</td></tr>
</tbody></table>
</div>
<h3 id="initiatecooldown-1"><a class="header" href="#initiatecooldown-1">initiateCooldown</a></h3>
<p>Function to be called to initiate cooldown for a staked deposit.</p>
<p><em>_depositId is corresponding to the user's deposit.</em></p>
<pre><code class="language-solidity">function initiateCooldown(uint256 _depositId) external nonReentrant;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>The id of the deposit to be locked.</td></tr>
</tbody></table>
</div>
<h3 id="addrewards-1"><a class="header" href="#addrewards-1">addRewards</a></h3>
<p>Add rewards to the farm.</p>
<pre><code class="language-solidity">function addRewards(address _rwdToken, uint256 _amount) external nonReentrant;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_rwdToken</code></td><td><code>address</code></td><td>The reward token's address.</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>The amount of reward tokens to add.</td></tr>
</tbody></table>
</div>
<h3 id="updatecooldownperiod-1"><a class="header" href="#updatecooldownperiod-1">updateCooldownPeriod</a></h3>
<p>Update the cooldown period.</p>
<pre><code class="language-solidity">function updateCooldownPeriod(uint256 _newCooldownPeriod) external onlyOwner;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_newCooldownPeriod</code></td><td><code>uint256</code></td><td>The new cooldown period (in days). E.g: 7 means 7 days.</td></tr>
</tbody></table>
</div>
<h3 id="farmpauseswitch-1"><a class="header" href="#farmpauseswitch-1">farmPauseSwitch</a></h3>
<p>Pause / UnPause the farm.</p>
<pre><code class="language-solidity">function farmPauseSwitch(bool _isPaused) external onlyOwner;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_isPaused</code></td><td><code>bool</code></td><td>Desired state of the farm (true to pause the farm).</td></tr>
</tbody></table>
</div>
<h3 id="closefarm-1"><a class="header" href="#closefarm-1">closeFarm</a></h3>
<p>A function to explicitly close the farm.</p>
<p><em>Recovers remaining non accrued rewards.</em></p>
<pre><code class="language-solidity">function closeFarm() external onlyOwner nonReentrant;
</code></pre>
<h3 id="recovererc20-3"><a class="header" href="#recovererc20-3">recoverERC20</a></h3>
<p>Recover erc20 tokens other than the reward tokens.</p>
<pre><code class="language-solidity">function recoverERC20(address _token) external onlyOwner nonReentrant;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_token</code></td><td><code>address</code></td><td>Address of token to be recovered.</td></tr>
</tbody></table>
</div>
<h3 id="recoverrewardfunds-1"><a class="header" href="#recoverrewardfunds-1">recoverRewardFunds</a></h3>
<p>Get the remaining reward balance out of the farm.</p>
<p><em>Function recovers minOf(_amount, rewardsLeft).</em></p>
<pre><code class="language-solidity">function recoverRewardFunds(address _rwdToken, uint256 _amount) external nonReentrant;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_rwdToken</code></td><td><code>address</code></td><td>The reward token's address.</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>The amount of the reward tokens to be withdrawn.</td></tr>
</tbody></table>
</div>
<h3 id="setrewardrate-1"><a class="header" href="#setrewardrate-1">setRewardRate</a></h3>
<p>Function to update reward params for a fund.</p>
<pre><code class="language-solidity">function setRewardRate(address _rwdToken, uint128[] memory _newRewardRates) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_rwdToken</code></td><td><code>address</code></td><td>The reward token's address.</td></tr>
<tr><td><code>_newRewardRates</code></td><td><code>uint128[]</code></td><td>The new reward rate for the fund (includes the precision).</td></tr>
</tbody></table>
</div>
<h3 id="updaterewarddata-1"><a class="header" href="#updaterewarddata-1">updateRewardData</a></h3>
<p>Transfer the tokenManagerRole to other user.</p>
<p><em>Only the existing tokenManager for a reward can call this function.</em></p>
<pre><code class="language-solidity">function updateRewardData(address _rwdToken, address _newTknManager) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_rwdToken</code></td><td><code>address</code></td><td>The reward token's address.</td></tr>
<tr><td><code>_newTknManager</code></td><td><code>address</code></td><td>Address of the new token manager.</td></tr>
</tbody></table>
</div>
<h3 id="computerewards-1"><a class="header" href="#computerewards-1">computeRewards</a></h3>
<p>Function to compute the total accrued rewards for a deposit for each subscription.</p>
<pre><code class="language-solidity">function computeRewards(address _account, uint256 _depositId)
    external
    view
    virtual
    returns (uint256[][] memory rewards);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_account</code></td><td><code>address</code></td><td>The user's address.</td></tr>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>The id of the deposit.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>rewards</code></td><td><code>uint256[][]</code></td><td>The total accrued rewards for the deposit for each subscription (uint256[][]).</td></tr>
</tbody></table>
</div>
<h3 id="getrewardfunds-1"><a class="header" href="#getrewardfunds-1">getRewardFunds</a></h3>
<p>Get the reward fund details.</p>
<pre><code class="language-solidity">function getRewardFunds() external view returns (RewardFund[] memory);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>RewardFund[]</code></td><td>The available reward funds' details for all the reward funds.</td></tr>
</tbody></table>
</div>
<h3 id="getrewarddata-1"><a class="header" href="#getrewarddata-1">getRewardData</a></h3>
<p>Get the reward details for specified reward token.</p>
<pre><code class="language-solidity">function getRewardData(address _rwdToken) external view returns (RewardData memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_rwdToken</code></td><td><code>address</code></td><td>The address of the reward token.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>RewardData</code></td><td>The available reward details for the specified reward token.</td></tr>
</tbody></table>
</div>
<h3 id="getdepositinfo-1"><a class="header" href="#getdepositinfo-1">getDepositInfo</a></h3>
<p>Get deposit info for a deposit id.</p>
<pre><code class="language-solidity">function getDepositInfo(uint256 _depositId) external view returns (Deposit memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>The id of the deposit.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>Deposit</code></td><td>The deposit info (Deposit).</td></tr>
</tbody></table>
</div>
<h3 id="getnumsubscriptions-1"><a class="header" href="#getnumsubscriptions-1">getNumSubscriptions</a></h3>
<p>Get number of subscriptions for an account.</p>
<pre><code class="language-solidity">function getNumSubscriptions(uint256 _depositId) external view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>The deposit id.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The number of subscriptions for the deposit.</td></tr>
</tbody></table>
</div>
<h3 id="getsubscriptioninfo-1"><a class="header" href="#getsubscriptioninfo-1">getSubscriptionInfo</a></h3>
<p>Get subscription stats for a deposit.</p>
<pre><code class="language-solidity">function getSubscriptionInfo(uint256 _depositId, uint256 _subscriptionId) external view returns (Subscription memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>The deposit id.</td></tr>
<tr><td><code>_subscriptionId</code></td><td><code>uint256</code></td><td>The subscription's id.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>Subscription</code></td><td>The subscription info (Subscription).</td></tr>
</tbody></table>
</div>
<h3 id="getrewardrates-1"><a class="header" href="#getrewardrates-1">getRewardRates</a></h3>
<p>Get reward rates for a rewardToken.</p>
<pre><code class="language-solidity">function getRewardRates(address _rwdToken) external view returns (uint256[] memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_rwdToken</code></td><td><code>address</code></td><td>The reward token's address.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256[]</code></td><td>The reward rates for the reward token (uint256[]).</td></tr>
</tbody></table>
</div>
<h3 id="getrewardfundinfo-1"><a class="header" href="#getrewardfundinfo-1">getRewardFundInfo</a></h3>
<p>Get farm reward fund info.</p>
<pre><code class="language-solidity">function getRewardFundInfo(uint8 _fundId) external view returns (RewardFund memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_fundId</code></td><td><code>uint8</code></td><td>The fund's id.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>RewardFund</code></td><td>The reward fund info (RewardFund).</td></tr>
</tbody></table>
</div>
<h3 id="getrewardtokens-1"><a class="header" href="#getrewardtokens-1">getRewardTokens</a></h3>
<p>Function to get the reward tokens added in the farm.</p>
<pre><code class="language-solidity">function getRewardTokens() external view returns (address[] memory);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address[]</code></td><td>The reward tokens added in the farm.</td></tr>
</tbody></table>
</div>
<h3 id="gettokenamounts-8"><a class="header" href="#gettokenamounts-8">getTokenAmounts</a></h3>
<p>Function to be called by Demeter Rewarder to get tokens and amounts associated with the farm's liquidity.</p>
<p><em>This function should be overridden to add the respective logic.</em></p>
<pre><code class="language-solidity">function getTokenAmounts() external view virtual returns (address[] memory, uint256[] memory);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address[]</code></td><td>Tokens associated with the farm's pool.</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256[]</code></td><td>Amounts associated with the farm's liquidity.</td></tr>
</tbody></table>
</div>
<h3 id="updatefarmrewarddata-1"><a class="header" href="#updatefarmrewarddata-1">updateFarmRewardData</a></h3>
<p>Function to update the FarmRewardData for all funds.</p>
<pre><code class="language-solidity">function updateFarmRewardData() public virtual;
</code></pre>
<h3 id="claimrewardsto-1"><a class="header" href="#claimrewardsto-1">claimRewardsTo</a></h3>
<p>Claim rewards and send it to another account.</p>
<p><em>Only the depositor can call this function.</em></p>
<pre><code class="language-solidity">function claimRewardsTo(address _account, uint256 _depositId) public nonReentrant;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_account</code></td><td><code>address</code></td><td>To receive the rewards.</td></tr>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>The id of the deposit.</td></tr>
</tbody></table>
</div>
<h3 id="updatefarmstarttime-6"><a class="header" href="#updatefarmstarttime-6">updateFarmStartTime</a></h3>
<p>Update the farm start time.</p>
<p><em>Can be updated only before the farm start.
New start time should be in future.</em></p>
<pre><code class="language-solidity">function updateFarmStartTime(uint256 _newStartTime) public virtual onlyOwner;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_newStartTime</code></td><td><code>uint256</code></td><td>The new farm start time.</td></tr>
</tbody></table>
</div>
<h3 id="isfarmopen-6"><a class="header" href="#isfarmopen-6">isFarmOpen</a></h3>
<p>Returns if farm is open.
Farm is open if it is not closed.</p>
<p><em>This function can be overridden to add any new/additional logic.</em></p>
<pre><code class="language-solidity">function isFarmOpen() public view virtual returns (bool);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>bool True if farm is open.</td></tr>
</tbody></table>
</div>
<h3 id="isfarmactive-2"><a class="header" href="#isfarmactive-2">isFarmActive</a></h3>
<p>Returns if farm is active.
Farm is active if it is not paused and not closed.</p>
<p><em>This function can be overridden to add any new/additional logic.</em></p>
<pre><code class="language-solidity">function isFarmActive() public view virtual returns (bool);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>bool True if farm is active.</td></tr>
</tbody></table>
</div>
<h3 id="getrewardbalance-1"><a class="header" href="#getrewardbalance-1">getRewardBalance</a></h3>
<p>Get the reward balance for specified reward token.</p>
<p><em>This function calculates the available reward balance by considering the accrued rewards and the token supply.</em></p>
<pre><code class="language-solidity">function getRewardBalance(address _rwdToken) public view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_rwdToken</code></td><td><code>address</code></td><td>The address of the reward token.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The available reward balance for the specified reward token.</td></tr>
</tbody></table>
</div>
<h3 id="_recovererc20-3"><a class="header" href="#_recovererc20-3">_recoverERC20</a></h3>
<pre><code class="language-solidity">function _recoverERC20(address _token) internal virtual;
</code></pre>
<h3 id="_deposit"><a class="header" href="#_deposit">_deposit</a></h3>
<p>Common logic for deposit in the demeter farm.</p>
<pre><code class="language-solidity">function _deposit(address _account, bool _lockup, uint256 _liquidity) internal returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_account</code></td><td><code>address</code></td><td>Address of the depositor.</td></tr>
<tr><td><code>_lockup</code></td><td><code>bool</code></td><td>Lockup option for the deposit.</td></tr>
<tr><td><code>_liquidity</code></td><td><code>uint256</code></td><td>Liquidity amount to be added to the pool.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The deposit id.</td></tr>
</tbody></table>
</div>
<h3 id="_initiatecooldown"><a class="header" href="#_initiatecooldown">_initiateCooldown</a></h3>
<p>Common logic for initiating cooldown.</p>
<pre><code class="language-solidity">function _initiateCooldown(uint256 _depositId) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>User's deposit Id.</td></tr>
</tbody></table>
</div>
<h3 id="_withdraw"><a class="header" href="#_withdraw">_withdraw</a></h3>
<p>Common logic for withdraw.</p>
<pre><code class="language-solidity">function _withdraw(uint256 _depositId) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>User's deposit id.</td></tr>
</tbody></table>
</div>
<h3 id="_updateandclaimfarmrewards"><a class="header" href="#_updateandclaimfarmrewards">_updateAndClaimFarmRewards</a></h3>
<p>Claim rewards for the user.</p>
<p><em>NOTE: any function calling this private
function should be marked as non-reentrant.</em></p>
<pre><code class="language-solidity">function _updateAndClaimFarmRewards(uint256 _depositId) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>The id of the deposit.</td></tr>
</tbody></table>
</div>
<h3 id="_updateandclaimfarmrewardsto"><a class="header" href="#_updateandclaimfarmrewardsto">_updateAndClaimFarmRewardsTo</a></h3>
<p>Claim rewards for the user and send it to another account.</p>
<p><em>NOTE: any function calling this private
function should be marked as non-reentrant.</em></p>
<pre><code class="language-solidity">function _updateAndClaimFarmRewardsTo(uint256 _depositId, address _receiver) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>The id of the deposit.</td></tr>
<tr><td><code>_receiver</code></td><td><code>address</code></td><td>The receiver of the rewards (Could be different from depositor)</td></tr>
</tbody></table>
</div>
<h3 id="_recoverrewardfunds"><a class="header" href="#_recoverrewardfunds">_recoverRewardFunds</a></h3>
<p>Get the remaining reward balance out of the farm.</p>
<p><em>Function recovers minOf(_amount, rewardsLeft).</em></p>
<p><em>In case of partial withdraw of funds, the reward rate has to be set manually again.</em></p>
<pre><code class="language-solidity">function _recoverRewardFunds(address _rwdToken, uint256 _amount) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_rwdToken</code></td><td><code>address</code></td><td>The reward token's address.</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>The amount of the reward token to be withdrawn.</td></tr>
</tbody></table>
</div>
<h3 id="_setrewardrate-1"><a class="header" href="#_setrewardrate-1">_setRewardRate</a></h3>
<p>Function to update reward params for a fund.</p>
<pre><code class="language-solidity">function _setRewardRate(address _rwdToken, uint128[] memory _newRewardRates) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_rwdToken</code></td><td><code>address</code></td><td>The reward token's address.</td></tr>
<tr><td><code>_newRewardRates</code></td><td><code>uint128[]</code></td><td>The new reward rate for the fund (includes the precision).</td></tr>
</tbody></table>
</div>
<h3 id="_setupfarm"><a class="header" href="#_setupfarm">_setupFarm</a></h3>
<p>Function to setup the reward funds and initialize the farm global params during construction.</p>
<pre><code class="language-solidity">function _setupFarm(
    string calldata _farmId,
    uint256 _farmStartTime,
    uint256 _cooldownPeriod,
    RewardTokenData[] memory _rwdTokenData
) internal initializer;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farmId</code></td><td><code>string</code></td><td>ID of the farm. E.g: <code>Demeter_Camelot_V2</code>.</td></tr>
<tr><td><code>_farmStartTime</code></td><td><code>uint256</code></td><td>- Farm start time.</td></tr>
<tr><td><code>_cooldownPeriod</code></td><td><code>uint256</code></td><td>- Cooldown period in days for locked deposits. E.g: 7 means 7 days.</td></tr>
<tr><td><code>_rwdTokenData</code></td><td><code>RewardTokenData[]</code></td><td>- Reward data for each reward token.</td></tr>
</tbody></table>
</div>
<h3 id="_addrewarddata"><a class="header" href="#_addrewarddata">_addRewardData</a></h3>
<p>Adds new reward token to the farm.</p>
<pre><code class="language-solidity">function _addRewardData(address _token, address _tknManager) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_token</code></td><td><code>address</code></td><td>Address of the reward token to be added.</td></tr>
<tr><td><code>_tknManager</code></td><td><code>address</code></td><td>Address of the reward token Manager.</td></tr>
</tbody></table>
</div>
<h3 id="_updatelastrewardaccrualtime-1"><a class="header" href="#_updatelastrewardaccrualtime-1">_updateLastRewardAccrualTime</a></h3>
<p>Update the last reward accrual time.</p>
<pre><code class="language-solidity">function _updateLastRewardAccrualTime() internal virtual;
</code></pre>
<h3 id="_getaccrewards"><a class="header" href="#_getaccrewards">_getAccRewards</a></h3>
<p>Computes the accrued reward for a given fund id and time interval.</p>
<p><em><code>_alreadyAccRewardBal</code> is useful when this function called from <code>computeRewards</code> function.
As <code>computeReward</code> is a view function and it doesn't update the <code>accRewardBal</code> in the <code>rewardData</code>.</em></p>
<pre><code class="language-solidity">function _getAccRewards(uint8 _rwdId, uint8 _fundId, uint256 _time, uint256 _alreadyAccRewardBal)
    internal
    view
    returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_rwdId</code></td><td><code>uint8</code></td><td>Id of the reward token.</td></tr>
<tr><td><code>_fundId</code></td><td><code>uint8</code></td><td>Id of the reward fund.</td></tr>
<tr><td><code>_time</code></td><td><code>uint256</code></td><td>Time interval for the reward computation.</td></tr>
<tr><td><code>_alreadyAccRewardBal</code></td><td><code>uint256</code></td><td>Already accrued reward balance.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>accRewards Accrued rewards for the given <code>_rwdId</code>, <code>_fundId</code> and <code>_time</code>.</td></tr>
</tbody></table>
</div>
<h3 id="_validatedeposit"><a class="header" href="#_validatedeposit">_validateDeposit</a></h3>
<p>Validate the deposit for account.</p>
<pre><code class="language-solidity">function _validateDeposit(address _account, uint256 _depositId) internal view;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_account</code></td><td><code>address</code></td><td>Address of the caller to be checked against depositor.</td></tr>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>Id of the deposit.</td></tr>
</tbody></table>
</div>
<h3 id="_validatenotrecentdeposit"><a class="header" href="#_validatenotrecentdeposit">_validateNotRecentDeposit</a></h3>
<p>A function to validate deposit ts to prevent flash loan vulnerabilities</p>
<p><em>Reverts when deposit made in the same transaction.</em></p>
<pre><code class="language-solidity">function _validateNotRecentDeposit(uint256 _depositTs) internal view;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_depositTs</code></td><td><code>uint256</code></td><td>depositTs of user's deposit. (It represents deposit ts or increaseDeposit ts)</td></tr>
</tbody></table>
</div>
<h3 id="_validatefarmopen"><a class="header" href="#_validatefarmopen">_validateFarmOpen</a></h3>
<p>Validate if farm is open. Revert otherwise.</p>
<p><em>This function can be overridden to add any new/additional logic.</em></p>
<pre><code class="language-solidity">function _validateFarmOpen() internal view;
</code></pre>
<h3 id="_validatefarmactive"><a class="header" href="#_validatefarmactive">_validateFarmActive</a></h3>
<p>Validate if farm is active. Revert otherwise.
Farm is active if it is not paused and not closed.</p>
<p><em>This function can be overridden to add any new/additional logic.</em></p>
<pre><code class="language-solidity">function _validateFarmActive() internal view;
</code></pre>
<h3 id="_validatetokenmanager"><a class="header" href="#_validatetokenmanager">_validateTokenManager</a></h3>
<p>Validate the caller is the token Manager. Revert otherwise.</p>
<pre><code class="language-solidity">function _validateTokenManager(address _rwdToken) internal view;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_rwdToken</code></td><td><code>address</code></td><td>Address of reward token.</td></tr>
</tbody></table>
</div>
<h3 id="_validaterewardtoken"><a class="header" href="#_validaterewardtoken">_validateRewardToken</a></h3>
<p>Validate the reward token is valid.</p>
<pre><code class="language-solidity">function _validateRewardToken(address _rwdToken) internal view;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_rwdToken</code></td><td><code>address</code></td><td>Address of reward token.</td></tr>
</tbody></table>
</div>
<h3 id="_getrewardaccrualtimeelapsed-1"><a class="header" href="#_getrewardaccrualtimeelapsed-1">_getRewardAccrualTimeElapsed</a></h3>
<p>Get the time elapsed since the last reward accrual.</p>
<pre><code class="language-solidity">function _getRewardAccrualTimeElapsed() internal view virtual returns (uint256);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>time The time elapsed since the last reward accrual.</td></tr>
</tbody></table>
</div>
<h3 id="_validatecooldownperiod"><a class="header" href="#_validatecooldownperiod">_validateCooldownPeriod</a></h3>
<p>An internal function to validate cooldown period.</p>
<pre><code class="language-solidity">function _validateCooldownPeriod(uint256 _cooldownPeriod) internal pure;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_cooldownPeriod</code></td><td><code>uint256</code></td><td>Period to be validated.</td></tr>
</tbody></table>
</div>
<h3 id="_validatenonzeroaddr-2"><a class="header" href="#_validatenonzeroaddr-2">_validateNonZeroAddr</a></h3>
<p>Validate address.</p>
<pre><code class="language-solidity">function _validateNonZeroAddr(address _addr) internal pure;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_addr</code></td><td><code>address</code></td><td>Address to be validated.</td></tr>
</tbody></table>
</div>
<h3 id="_subscriberewardfund"><a class="header" href="#_subscriberewardfund">_subscribeRewardFund</a></h3>
<p>Add subscription to the reward fund for a deposit.</p>
<pre><code class="language-solidity">function _subscribeRewardFund(uint8 _fundId, uint256 _depositId, uint256 _liquidity) private;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_fundId</code></td><td><code>uint8</code></td><td>The reward fund id.</td></tr>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>The unique ID of the deposit.</td></tr>
<tr><td><code>_liquidity</code></td><td><code>uint256</code></td><td>The liquidity of the deposit.</td></tr>
</tbody></table>
</div>
<h3 id="_unsubscriberewardfund"><a class="header" href="#_unsubscriberewardfund">_unsubscribeRewardFund</a></h3>
<p>Unsubscribe a reward fund from a deposit.</p>
<p><em>The rewards claimed from the reward fund is persisted in the event.</em></p>
<pre><code class="language-solidity">function _unsubscribeRewardFund(uint8 _fundId, uint256 _depositId) private;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_fundId</code></td><td><code>uint8</code></td><td>The reward fund id.</td></tr>
<tr><td><code>_depositId</code></td><td><code>uint256</code></td><td>The deposit id corresponding to the user.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="farmdeployer"><a class="header" href="#farmdeployer">FarmDeployer</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/FarmDeployer.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
Ownable, ReentrancyGuard</p>
<p><strong>Author:</strong>
Sperax Foundation.</p>
<p>Exposes base functionalities which will be useful in every deployer.</p>
<h2 id="state-variables-17"><a class="header" href="#state-variables-17">State Variables</a></h2>
<h3 id="farm_registry"><a class="header" href="#farm_registry">FARM_REGISTRY</a></h3>
<pre><code class="language-solidity">address public immutable FARM_REGISTRY;
</code></pre>
<h3 id="farmimplementation"><a class="header" href="#farmimplementation">farmImplementation</a></h3>
<pre><code class="language-solidity">address public farmImplementation;
</code></pre>
<h3 id="farmid-1"><a class="header" href="#farmid-1">farmId</a></h3>
<pre><code class="language-solidity">string public farmId;
</code></pre>
<h2 id="functions-51"><a class="header" href="#functions-51">Functions</a></h2>
<h3 id="constructor-10"><a class="header" href="#constructor-10">constructor</a></h3>
<p>Constructor.</p>
<pre><code class="language-solidity">constructor(address _farmRegistry, string memory _farmId) Ownable(msg.sender);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farmRegistry</code></td><td><code>address</code></td><td>Address of the Demeter Farm Registry.</td></tr>
<tr><td><code>_farmId</code></td><td><code>string</code></td><td>Id of the farm.</td></tr>
</tbody></table>
</div>
<h3 id="updatefarmimplementation"><a class="header" href="#updatefarmimplementation">updateFarmImplementation</a></h3>
<p>Update farm implementation's address.</p>
<p><em>Only callable by the owner.</em></p>
<p><em>Ensure that <code>_newFarmId</code> is correct for the new farm implementation.</em></p>
<pre><code class="language-solidity">function updateFarmImplementation(address _newFarmImplementation, string calldata _newFarmId) external onlyOwner;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_newFarmImplementation</code></td><td><code>address</code></td><td>New farm implementation's address.</td></tr>
<tr><td><code>_newFarmId</code></td><td><code>string</code></td><td>ID of the new farm.</td></tr>
</tbody></table>
</div>
<h3 id="_collectfee"><a class="header" href="#_collectfee">_collectFee</a></h3>
<p>Collect fee and transfer it to feeReceiver.</p>
<p><em>Function fetches all the fee params from farmRegistry.</em></p>
<pre><code class="language-solidity">function _collectFee() internal virtual;
</code></pre>
<h3 id="_validatenonzeroaddr-3"><a class="header" href="#_validatenonzeroaddr-3">_validateNonZeroAddr</a></h3>
<p>Validate address.</p>
<pre><code class="language-solidity">function _validateNonZeroAddr(address _addr) internal pure;
</code></pre>
<h2 id="events-10"><a class="header" href="#events-10">Events</a></h2>
<h3 id="farmcreated"><a class="header" href="#farmcreated">FarmCreated</a></h3>
<pre><code class="language-solidity">event FarmCreated(address indexed farm, address indexed creator, address indexed admin);
</code></pre>
<h3 id="feecollected"><a class="header" href="#feecollected">FeeCollected</a></h3>
<pre><code class="language-solidity">event FeeCollected(address indexed creator, address indexed token, uint256 amount);
</code></pre>
<h3 id="farmimplementationupdated"><a class="header" href="#farmimplementationupdated">FarmImplementationUpdated</a></h3>
<pre><code class="language-solidity">event FarmImplementationUpdated(address indexed newFarmImplementation, string newFarmId);
</code></pre>
<h2 id="errors-13"><a class="header" href="#errors-13">Errors</a></h2>
<h3 id="invalidaddress-4"><a class="header" href="#invalidaddress-4">InvalidAddress</a></h3>
<pre><code class="language-solidity">error InvalidAddress();
</code></pre>
<h3 id="newfarmimplementationsameasold"><a class="header" href="#newfarmimplementationsameasold">NewFarmImplementationSameAsOld</a></h3>
<pre><code class="language-solidity">error NewFarmImplementationSameAsOld();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="farmregistry-1"><a class="header" href="#farmregistry-1">FarmRegistry</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/FarmRegistry.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/FarmRegistry.sol//contracts/interfaces/IFarmRegistry.sol/interface.IFarmRegistry.html">IFarmRegistry</a>, OwnableUpgradeable</p>
<p><strong>Author:</strong>
Sperax Foundation.</p>
<p>This contract tracks fee details, privileged users, deployed farms and farm deployers.</p>
<h2 id="state-variables-18"><a class="header" href="#state-variables-18">State Variables</a></h2>
<h3 id="farms"><a class="header" href="#farms">farms</a></h3>
<pre><code class="language-solidity">address[] internal farms;
</code></pre>
<h3 id="deployerlist"><a class="header" href="#deployerlist">deployerList</a></h3>
<pre><code class="language-solidity">address[] internal deployerList;
</code></pre>
<h3 id="feereceiver-1"><a class="header" href="#feereceiver-1">feeReceiver</a></h3>
<pre><code class="language-solidity">address public feeReceiver;
</code></pre>
<h3 id="feetoken-1"><a class="header" href="#feetoken-1">feeToken</a></h3>
<pre><code class="language-solidity">address public feeToken;
</code></pre>
<h3 id="feeamount-1"><a class="header" href="#feeamount-1">feeAmount</a></h3>
<pre><code class="language-solidity">uint256 public feeAmount;
</code></pre>
<h3 id="extensionfeeperday-1"><a class="header" href="#extensionfeeperday-1">extensionFeePerDay</a></h3>
<pre><code class="language-solidity">uint256 public extensionFeePerDay;
</code></pre>
<h3 id="farmregistered-2"><a class="header" href="#farmregistered-2">farmRegistered</a></h3>
<pre><code class="language-solidity">mapping(address =&gt; bool) public farmRegistered;
</code></pre>
<h3 id="deployerregistered-1"><a class="header" href="#deployerregistered-1">deployerRegistered</a></h3>
<pre><code class="language-solidity">mapping(address =&gt; bool) public deployerRegistered;
</code></pre>
<h3 id="isprivilegeduser-1"><a class="header" href="#isprivilegeduser-1">isPrivilegedUser</a></h3>
<pre><code class="language-solidity">mapping(address =&gt; bool) public isPrivilegedUser;
</code></pre>
<h2 id="functions-52"><a class="header" href="#functions-52">Functions</a></h2>
<h3 id="constructor-11"><a class="header" href="#constructor-11">constructor</a></h3>
<pre><code class="language-solidity">constructor();
</code></pre>
<h3 id="initialize-8"><a class="header" href="#initialize-8">initialize</a></h3>
<p>constructor</p>
<pre><code class="language-solidity">function initialize(address _feeReceiver, address _feeToken, uint256 _feeAmount, uint256 _extensionFeePerDay)
    external
    initializer;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_feeReceiver</code></td><td><code>address</code></td><td>Receiver of the fees.</td></tr>
<tr><td><code>_feeToken</code></td><td><code>address</code></td><td>The fee token for farm creation.</td></tr>
<tr><td><code>_feeAmount</code></td><td><code>uint256</code></td><td>The fee amount to be paid by the creator.</td></tr>
<tr><td><code>_extensionFeePerDay</code></td><td><code>uint256</code></td><td>Extension fee per day.</td></tr>
</tbody></table>
</div>
<h3 id="registerfarm-1"><a class="header" href="#registerfarm-1">registerFarm</a></h3>
<p>Register a farm created by registered Deployer.</p>
<p><em>Only registered deployer can register a farm.</em></p>
<pre><code class="language-solidity">function registerFarm(address _farm, address _creator) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_farm</code></td><td><code>address</code></td><td>Address of the created farm contract</td></tr>
<tr><td><code>_creator</code></td><td><code>address</code></td><td>Address of the farm creator.</td></tr>
</tbody></table>
</div>
<h3 id="registerfarmdeployer-1"><a class="header" href="#registerfarmdeployer-1">registerFarmDeployer</a></h3>
<p>Register a new farm deployer.</p>
<p><em>Only owner can call this function.</em></p>
<pre><code class="language-solidity">function registerFarmDeployer(address _deployer) external onlyOwner;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_deployer</code></td><td><code>address</code></td><td>Address of deployer to be registered.</td></tr>
</tbody></table>
</div>
<h3 id="removedeployer-1"><a class="header" href="#removedeployer-1">removeDeployer</a></h3>
<p>Remove an existing deployer from registry.</p>
<p><em>Only owner can call this function.</em></p>
<pre><code class="language-solidity">function removeDeployer(uint16 _id) external onlyOwner;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_id</code></td><td><code>uint16</code></td><td>ID of the deployer to be removed (0 index based).</td></tr>
</tbody></table>
</div>
<h3 id="updateprivilege-1"><a class="header" href="#updateprivilege-1">updatePrivilege</a></h3>
<p>Function to add/remove privileged User.</p>
<p><em>Only callable by the owner.</em></p>
<pre><code class="language-solidity">function updatePrivilege(address _user, bool _privilege) external onlyOwner;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_user</code></td><td><code>address</code></td><td>User Address for which privilege is to be updated.</td></tr>
<tr><td><code>_privilege</code></td><td><code>bool</code></td><td>Privilege(bool) whether true or false.</td></tr>
</tbody></table>
</div>
<h3 id="getfarmdeployerlist-1"><a class="header" href="#getfarmdeployerlist-1">getFarmDeployerList</a></h3>
<p>Get list of registered deployer.</p>
<pre><code class="language-solidity">function getFarmDeployerList() external view returns (address[] memory);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address[]</code></td><td>Returns array of registered deployer addresses.</td></tr>
</tbody></table>
</div>
<h3 id="getfarmlist-1"><a class="header" href="#getfarmlist-1">getFarmList</a></h3>
<p>Get list of farms created via registered deployer.</p>
<pre><code class="language-solidity">function getFarmList() external view returns (address[] memory);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address[]</code></td><td>Returns array of farm addresses.</td></tr>
</tbody></table>
</div>
<h3 id="getfeeparams-1"><a class="header" href="#getfeeparams-1">getFeeParams</a></h3>
<p>Get all the fee parameters for creating farm.</p>
<p><em>It returns fee amount and extension fee as 0 if _user is privileged.</em></p>
<pre><code class="language-solidity">function getFeeParams(address _user) external view returns (address, address, uint256, uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_user</code></td><td><code>address</code></td><td>The account creating the farm.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td>Receiver of the fees.</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td>Token in which fee is to be paid.</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>Amount of fees to be paid for creation of farm.</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>Extension fee per day in case of extending a farm.</td></tr>
</tbody></table>
</div>
<h3 id="updatefeeparams-1"><a class="header" href="#updatefeeparams-1">updateFeeParams</a></h3>
<p>Update the fee params for registry.</p>
<pre><code class="language-solidity">function updateFeeParams(address _receiver, address _feeToken, uint256 _amount, uint256 _extensionFeePerDay)
    public
    onlyOwner;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_receiver</code></td><td><code>address</code></td><td>FeeReceiver address.</td></tr>
<tr><td><code>_feeToken</code></td><td><code>address</code></td><td>Token address for fee.</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>Amount of token to be collected.</td></tr>
<tr><td><code>_extensionFeePerDay</code></td><td><code>uint256</code></td><td>Extension fee per day.</td></tr>
</tbody></table>
</div>
<h3 id="_validatenonzeroaddr-4"><a class="header" href="#_validatenonzeroaddr-4">_validateNonZeroAddr</a></h3>
<p>Validate address.</p>
<pre><code class="language-solidity">function _validateNonZeroAddr(address _addr) private pure;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="farmstorage"><a class="header" href="#farmstorage">FarmStorage</a></h1>
<p><a href="https://github.com/Sperax/Demeter-Protocol/blob/7ad036e3d8a0c588fbb688512cb73a5a583d2608/contracts/FarmStorage.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/FarmStorage.sol//contracts/interfaces/IFarm.sol/interface.IFarm.html">IFarm</a></p>
<p><strong>Author:</strong>
Sperax Foundation.</p>
<p>This contract contains the base storage variables for farms.</p>
<h2 id="state-variables-19"><a class="header" href="#state-variables-19">State Variables</a></h2>
<h3 id="common_fund_id-1"><a class="header" href="#common_fund_id-1">COMMON_FUND_ID</a></h3>
<pre><code class="language-solidity">uint8 public constant COMMON_FUND_ID = 0;
</code></pre>
<h3 id="lockup_fund_id-1"><a class="header" href="#lockup_fund_id-1">LOCKUP_FUND_ID</a></h3>
<pre><code class="language-solidity">uint8 public constant LOCKUP_FUND_ID = 1;
</code></pre>
<h3 id="precision-1"><a class="header" href="#precision-1">PRECISION</a></h3>
<pre><code class="language-solidity">uint256 public constant PRECISION = 1e18;
</code></pre>
<h3 id="max_cooldown_period-1"><a class="header" href="#max_cooldown_period-1">MAX_COOLDOWN_PERIOD</a></h3>
<pre><code class="language-solidity">uint256 public constant MAX_COOLDOWN_PERIOD = 30;
</code></pre>
<h3 id="max_num_rewards-1"><a class="header" href="#max_num_rewards-1">MAX_NUM_REWARDS</a></h3>
<pre><code class="language-solidity">uint256 public constant MAX_NUM_REWARDS = 4;
</code></pre>
<h3 id="farmid-2"><a class="header" href="#farmid-2">farmId</a></h3>
<pre><code class="language-solidity">string public farmId;
</code></pre>
<h3 id="ispaused"><a class="header" href="#ispaused">isPaused</a></h3>
<pre><code class="language-solidity">bool internal isPaused;
</code></pre>
<h3 id="isclosed"><a class="header" href="#isclosed">isClosed</a></h3>
<pre><code class="language-solidity">bool internal isClosed;
</code></pre>
<h3 id="cooldownperiod-1"><a class="header" href="#cooldownperiod-1">cooldownPeriod</a></h3>
<pre><code class="language-solidity">uint256 public cooldownPeriod;
</code></pre>
<h3 id="lastfundupdatetime-1"><a class="header" href="#lastfundupdatetime-1">lastFundUpdateTime</a></h3>
<pre><code class="language-solidity">uint256 public lastFundUpdateTime;
</code></pre>
<h3 id="farmstarttime-1"><a class="header" href="#farmstarttime-1">farmStartTime</a></h3>
<pre><code class="language-solidity">uint256 public farmStartTime;
</code></pre>
<h3 id="totaldeposits-1"><a class="header" href="#totaldeposits-1">totalDeposits</a></h3>
<pre><code class="language-solidity">uint256 public totalDeposits;
</code></pre>
<h3 id="rewardfunds"><a class="header" href="#rewardfunds">rewardFunds</a></h3>
<pre><code class="language-solidity">RewardFund[] internal rewardFunds;
</code></pre>
<h3 id="rewardtokens"><a class="header" href="#rewardtokens">rewardTokens</a></h3>
<pre><code class="language-solidity">address[] internal rewardTokens;
</code></pre>
<h3 id="rewarddata-1"><a class="header" href="#rewarddata-1">rewardData</a></h3>
<pre><code class="language-solidity">mapping(address =&gt; RewardData) internal rewardData;
</code></pre>
<h3 id="deposits"><a class="header" href="#deposits">deposits</a></h3>
<pre><code class="language-solidity">mapping(uint256 =&gt; Deposit) internal deposits;
</code></pre>
<h3 id="subscriptions"><a class="header" href="#subscriptions">subscriptions</a></h3>
<pre><code class="language-solidity">mapping(uint256 =&gt; Subscription[]) internal subscriptions;
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="solidity.min.js"></script>

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
